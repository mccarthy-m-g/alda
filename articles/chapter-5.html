<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5: Treating time more flexibly • alda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 5: Treating time more flexibly">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">alda</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tips-tricks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tips &amp; Tricks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tips-tricks">
<li><a class="dropdown-item" href="../articles/longitudinal-data-organization.html">Longitudinal data organization</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-textbook-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Textbook examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-textbook-examples">
<li><h6 class="dropdown-header" data-toc-skip>Longitudinal mixed effects modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-2.html">Chapter 2</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-3.html">Chapter 3</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-4.html">Chapter 4</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-5.html">Chapter 5</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-6.html">Chapter 6</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-7.html">Chapter 7</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Longitudinal structural equation modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-8.html">Chapter 8</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Survival analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-9.html">Chapter 9</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-10.html">Chapter 10</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-11.html">Chapter 11</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-12.html">Chapter 12</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-13.html">Chapter 13</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-14.html">Chapter 14</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-15.html">Chapter 15</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mccarthy-m-g/alda/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 5: Treating time more flexibly</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mccarthy-m-g/alda/blob/main/vignettes/articles/chapter-5.Rmd" class="external-link"><code>vignettes/articles/chapter-5.Rmd</code></a></small>
      <div class="d-none name"><code>chapter-5.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mccarthy-m-g.github.io/alda/">alda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed" class="external-link">broom.mixed</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/" class="external-link">modelbased</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modelsummary.com" class="external-link">modelsummary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="variably-spaced-measurement-occasions">5.1 Variably spaced measurement occasions<a class="anchor" aria-label="anchor" href="#variably-spaced-measurement-occasions"></a>
</h2>
<p>In Section 5.1 Singer and Willett (2003) demonstrate how you can fit
the multilevel model for change for data with <strong>variably spaced
measurement occasions</strong> using a subset of data from the Children
of the National Longitudinal Study of Youth (US Bureau of Labor and
Statistics), which measured changes in the reading subtest of the
Peabody Individual Achievement Test (PIAT) in a sample of 89
African-American children across three waves around the ages of 6, 8,
and 10.</p>
<p>For this example we use the <code>reading_scores</code> data set, a
person-period data frame with 267 rows and 5 columns:</p>
<ul>
<li>
<code>id</code>: Child ID.</li>
<li>
<code>wave</code>: Wave of measurement.</li>
<li>
<code>age_group</code>: Expected age on each measurement
occasion.</li>
<li>
<code>age</code>: Age in years at time of measurement.</li>
<li>
<code>reading_score</code>: Reading score on the reading subtest of
the Peabody Individual Achievement Test (PIAT).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 5.1, page 141:</span></span>
<span><span class="va">reading_scores</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 267 × 5</span></span></span>
<span><span class="co">#&gt;    id     wave age_group   age reading_score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1       6.5  6               18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         2       8.5  8.33            35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         3      10.5 10.3             59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2         1       6.5  6               18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2         2       8.5  8.5             25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2         3      10.5 10.6             28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3         1       6.5  6.08            18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3         2       8.5  8.42            23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3         3      10.5 10.4             32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4         1       6.5  6               18</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 257 more rows</span></span></span></code></pre></div>
<p>Note that the structure of the <code>reading_scores</code> data is
identical to the person-period data sets shown in previous chapters,
except that it has three time-indicator variables:</p>
<ul>
<li>The values of <code>wave</code> reflect the study’s design; they are
time-structured across children, but have little substantive
meaning.</li>
<li>The values of <code>age_group</code> reflect the child’s expected
age on each measurement occasion; they are time-structured across
children and have substantive meaning.</li>
<li>The values of <code>age</code> reflect the child’s actual age on
each measurement occasion; they are variably spaced across children and
have substantive meaning.</li>
</ul>
<p>This demonstrates a distinctive feature of
<strong>time-unstructured</strong> data sets—the possibility to have
multiple representations of time. Thus, from the perspective of the
<code>age_group</code> variable, the <code>reading_scores</code> data
appears to be time-structured:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">reading_scores</span>, <span class="va">id</span>, <span class="va">age_group</span>, <span class="va">reading_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 267 × 3</span></span></span>
<span><span class="co">#&gt;    id    age_group reading_score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1           6.5            18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1           8.5            35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1          10.5            59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2           6.5            18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2           8.5            25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2          10.5            28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3           6.5            18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3           8.5            23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3          10.5            32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4           6.5            18</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 257 more rows</span></span></span></code></pre></div>
<p>Whereas from the perspective of the <code>age</code> variable, the
<code>reading_scores</code> data appears to be variably spaced:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">reading_scores</span>, <span class="va">id</span>, <span class="va">age</span>, <span class="va">reading_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 267 × 3</span></span></span>
<span><span class="co">#&gt;    id      age reading_score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1      6               18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1      8.33            35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1     10.3             59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2      6               18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2      8.5             25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2     10.6             28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3      6.08            18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3      8.42            23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3     10.4             32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4      6               18</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 257 more rows</span></span></span></code></pre></div>
<p>However, as Singer and Willett (2003) discuss, the specification,
estimation, and interpretation of the multilevel model for change
proceeds in the exact same way regardless of which temporal
representation we use; thus, it is generally preferable to use the most
accurate unstructured temporal representation rather forcing the data
into a time-structured design.</p>
<p>Here we will fit an unconditional growth model using both the
structured and unstructured temporal representations to demonstrate why
the latter is generally preferable. As usual, we begin by inspecting
empirical growth plots to help select the functional form for the
level-1 submodel.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 5.1, page 143:</span></span>
<span><span class="va">reading_scores</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">27</span>, <span class="fl">31</span>, <span class="fl">33</span>, <span class="fl">41</span>, <span class="fl">49</span>, <span class="fl">69</span>, <span class="fl">77</span>, <span class="fl">87</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"time_indicator"</span>, values_to <span class="op">=</span> <span class="st">"age"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">reading_score</span>, colour <span class="op">=</span> <span class="va">time_indicator</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, linewidth <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">12</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-5_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>A linear change individual growth model seems most parsimonious for
both temporal representations. Following Singer and Willett (2003), we
will centre both <code>age_group</code> and <code>age</code> on age 6.5
(the average child’s age at wave 1) so that the parameters of both
models have identical interpretations, and label time in each model with
a generic <code>time</code> variable.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reading_scores_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age_group <span class="op">=</span> <span class="st">"age_group"</span>, age <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>      <span class="va">reading_score</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="fl">6.5</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="fl">6.5</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">reading_scores</span>, time <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">.time</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>modelsummary_get <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 5.2, page 145:</span></span>
<span><span class="va">reading_scores_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"I(time - 6.5)"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__I(time - 6.5)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="age_group">age_group</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="age">age</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  age_group" class="gt_row gt_center">21.163</td>
<td headers="Fixed Effects  age" class="gt_row gt_center">21.061</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  age_group" class="gt_row gt_center">(0.614)</td>
<td headers="Fixed Effects  age" class="gt_row gt_center">(0.559)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(time - 6.5)</td>
<td headers="Fixed Effects  age_group" class="gt_row gt_center">5.031</td>
<td headers="Fixed Effects  age" class="gt_row gt_center">4.540</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  age_group" class="gt_row gt_center">(0.296)</td>
<td headers="Fixed Effects  age" class="gt_row gt_center">(0.261)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  age_group" class="gt_row gt_center">27.043</td>
<td headers="Variance Components  age" class="gt_row gt_center">27.447</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  age_group" class="gt_row gt_center">11.046</td>
<td headers="Variance Components  age" class="gt_row gt_center">5.107</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__I(time - 6.5)</td>
<td headers="Variance Components  age_group" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">4.397</td>
<td headers="Variance Components  age" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">3.301</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  age_group" class="gt_row gt_center">1819.9</td>
<td headers="Goodness-of-Fit  age" class="gt_row gt_center">1803.9</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  age_group" class="gt_row gt_center">1831.9</td>
<td headers="Goodness-of-Fit  age" class="gt_row gt_center">1815.9</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  age_group" class="gt_row gt_center">1853.5</td>
<td headers="Goodness-of-Fit  age" class="gt_row gt_center">1837.4</td>
</tr>
</tbody>
</table>
</div>
<p>Comparing these models, we see that the <code>age</code> model fits
the data better than the <code>age_group</code> model—with less
unexplained variation in initial status and rates of change, and smaller
AIC and BIC statistics.</p>
</div>
<div class="section level2">
<h2 id="varying-numbers-of-measurement-occasions">5.2 Varying numbers of measurement occasions<a class="anchor" aria-label="anchor" href="#varying-numbers-of-measurement-occasions"></a>
</h2>
<p>In Section 5.2 Singer and Willett (2003) demonstrate how you can fit
the multilevel model for change for data with <strong>varying numbers of
measurement occasions</strong> (i.e., unbalanced data) using a subset of
data from the National Longitudinal Study of Youth tracking the labour
market experiences of male high school dropouts (Murnane, Boudett, &amp;
Willett, 1999).</p>
<p>For this example we use the <code>dropout_wages</code> data set, a
person-period data frame with 6402 rows and 9 columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>log_wages</code>: Natural logarithm of wages.</li>
<li>
<code>experience</code>: Labour force experience in years, tracked
from dropouts’ first day of work.</li>
<li>
<code>ged</code>: Binary indicator for whether the dropout obtained
a GED.</li>
<li>
<code>postsecondary_education</code>: Binary indicator for whether
the dropout obtained post-secondary education.</li>
<li>
<code>black</code>: Binary indicator for whether the dropout is
black.</li>
<li>
<code>hispanic</code>: Binary indicator for whether the dropout is
hispanic.</li>
<li>
<code>highest_grade</code>: Highest grade completed.</li>
<li>
<code>unemployment_rate</code>: Unemployment rate in the local
geographic area.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,402 × 9</span></span></span>
<span><span class="co">#&gt;    id    log_wages experience   ged postsecondary_education black hispanic</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 31         1.49      0.015     1                   0.015     0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 31         1.43      0.715     1                   0.715     0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 31         1.47      1.73      1                   1.73      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 31         1.75      2.77      1                   2.77      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 31         1.93      3.93      1                   3.93      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 31         1.71      4.95      1                   4.95      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 31         2.09      5.96      1                   5.96      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 31         2.13      6.98      1                   6.98      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 36         1.98      0.315     1                   0.315     0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 36         1.80      0.983     1                   0.983     0        0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6,392 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: highest_grade &lt;dbl&gt;, unemployment_rate &lt;dbl&gt;</span></span></span></code></pre></div>
<p>In the <code>dropout_wages</code> data, the number of measurement
occasions varies widely across individuals, from 1 to 13 waves.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>waves <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">waves</span>, name <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">#&gt;    waves count</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1    38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2    39</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3    47</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4    35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5    74</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6    92</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7   103</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8   123</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9   127</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10   113</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    11    65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    12    26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>    13     6</span></span></code></pre></div>
<p>Indeed, examining the data from a subset of individuals, we can see
that the <code>dropout_wages</code> data varies in both the number
<em>and</em> spacing of measurement occasions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 5.3, page 147:</span></span>
<span><span class="va">dropout_wages</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">206</span>, <span class="fl">332</span>, <span class="fl">1028</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">experience</span>, <span class="va">log_wages</span>, <span class="va">black</span>, <span class="va">highest_grade</span>, <span class="va">unemployment_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 6</span></span></span>
<span><span class="co">#&gt;    id    experience log_wages black highest_grade unemployment_rate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 206        1.87      2.03      0            10              9.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 206        2.81      2.30      0            10             11   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 206        4.31      2.48      0            10              6.30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 332        0.125     1.63      0             8              7.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 332        1.62      1.48      0             8              9.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 332        2.41      1.80      0             8              7.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 332        3.39      1.44      0             8              6.20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 332        4.47      1.75      0             8              5.60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 332        5.18      1.53      0             8              4.60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 332        6.08      2.04      0             8              4.30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 332        7.04      2.18      0             8              3.40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 332        8.20      2.19      0             8              4.39</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 332        9.09      4.04      0             8              6.70</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1028       0.004     0.872     1             8              9.3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 1028       0.035     0.903     1             8              7.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 1028       0.515     1.39      1             8              7.3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 1028       1.48      2.32      1             8              7.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 1028       2.14      1.48      1             8              6.30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 1028       3.16      1.70      1             8              5.90</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 1028       4.10      2.34      1             8              6.9</span></span></code></pre></div>
<p>Yet, as Singer and Willett (2003) discuss, a major advantage of the
multilevel model for change is that it can easily fit to unbalanced data
like this—as long as the person-period data set includes enough people
with enough waves of data for the model converge, the analyses can
proceed as usual.</p>
<p>Here we will fit three models to the <code>dropout_wages</code> data:
an unconditional growth model (Model A), and two models that include
predictors for race and the highest grade completed (Models B and
C).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">dropout_wages_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">log_wages</span> <span class="op">~</span> <span class="va">experience</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dropout_wages</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">highest_grade</span> <span class="op">-</span> <span class="fl">9</span><span class="op">)</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">*</span> <span class="va">black</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The model fails to converge with the default optimizer (although the estimates</span></span>
<span><span class="co"># are fine). Changing the optimizer achieves convergence.</span></span>
<span><span class="va">dropout_wages_fit_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_B</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">experience</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">highest_grade</span> <span class="op">-</span> <span class="fl">9</span><span class="op">)</span> <span class="op">-</span> <span class="va">black</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A` <span class="op">=</span> <span class="va">dropout_wages_fit_A</span>,</span>
<span>  `Model B` <span class="op">=</span> <span class="va">dropout_wages_fit_B</span>,</span>
<span>  `Model C` <span class="op">=</span> <span class="va">dropout_wages_fit_C</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Table 5.4, page 149:</span></span>
<span><span class="va">dropout_wages_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"black"</span>,</span>
<span>      <span class="st">"experience"</span>,</span>
<span>      <span class="st">"experience:I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"experience:black"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__experience"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="eexombwkke" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eexombwkke table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eexombwkke thead, #eexombwkke tbody, #eexombwkke tfoot, #eexombwkke tr, #eexombwkke td, #eexombwkke th {
  border-style: none;
}

#eexombwkke p {
  margin: 0;
  padding: 0;
}

#eexombwkke .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eexombwkke .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eexombwkke .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eexombwkke .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eexombwkke .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eexombwkke .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eexombwkke .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eexombwkke .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eexombwkke .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eexombwkke .gt_spanner_row {
  border-bottom-style: hidden;
}

#eexombwkke .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eexombwkke .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eexombwkke .gt_from_md > :first-child {
  margin-top: 0;
}

#eexombwkke .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eexombwkke .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eexombwkke .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eexombwkke .gt_row_group_first td {
  border-top-width: 2px;
}

#eexombwkke .gt_row_group_first th {
  border-top-width: 2px;
}

#eexombwkke .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eexombwkke .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eexombwkke .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_left {
  text-align: left;
}

#eexombwkke .gt_center {
  text-align: center;
}

#eexombwkke .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eexombwkke .gt_font_normal {
  font-weight: normal;
}

#eexombwkke .gt_font_bold {
  font-weight: bold;
}

#eexombwkke .gt_font_italic {
  font-style: italic;
}

#eexombwkke .gt_super {
  font-size: 65%;
}

#eexombwkke .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eexombwkke .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eexombwkke .gt_indent_1 {
  text-indent: 5px;
}

#eexombwkke .gt_indent_2 {
  text-indent: 10px;
}

#eexombwkke .gt_indent_3 {
  text-indent: 15px;
}

#eexombwkke .gt_indent_4 {
  text-indent: 20px;
}

#eexombwkke .gt_indent_5 {
  text-indent: 25px;
}

#eexombwkke .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eexombwkke div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">1.716</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">1.717</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">1.721</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.011)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.013)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.011)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(highest_grade - 9)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.035</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.038</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.008)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.006)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">black</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.015</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.024)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.046</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.049</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.049</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.003)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:I(highest_grade - 9)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.001</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:black</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">-0.018</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-0.016</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.005)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.005)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.095</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.054</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.052</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.052</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__experience</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.002</td>
<td headers="Variance Components  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.002</td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.002</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">4921.4</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">4873.8</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">4874.7</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">4933.4</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">4893.8</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">4890.7</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">4974.0</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">4961.4</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">4944.8</td>
</tr>
</tbody>
</table>
</div>
<p>Likewise, even for data with varying numbers of measurement
occasions, prototypical change trajectories can be derived from the
model as usual.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_dropout_wages</span> <span class="op">&lt;-</span> <span class="va">dropout_wages_fit_C</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>      experience <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>      highest_grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fl">9</span>,</span>
<span>      black <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>log_wages <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>highest_grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">highest_grade</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 5.2, page 150:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_dropout_wages</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">experience</span>, y <span class="op">=</span> <span class="va">log_wages</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">highest_grade</span>, linetype <span class="op">=</span>  <span class="va">black</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.6</span>, <span class="fl">2.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-5_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="section level3">
<h3 id="practical-problems-that-may-arise-when-analyzing-unbalanced-data-sets">5.2.2 Practical problems that may arise when analyzing unbalanced
data sets<a class="anchor" aria-label="anchor" href="#practical-problems-that-may-arise-when-analyzing-unbalanced-data-sets"></a>
</h3>
<p>The multilevel model may fail to converge or be unable to estimate
one or more variance components for data sets that are severely
unbalanced, or if too few people have enough waves of data. In Section
5.2.2 Singer and Willett (2003) discuss two strategies for addressing
these problems:</p>
<ul>
<li>
<strong>Removing boundary constraints</strong>, where the software
is permitted to obtain negative variance components.</li>
<li>
<strong>Fixing rates of change</strong>, where the model is
simplified by removing the varying slope change.</li>
</ul>
<p>For this example we use a subset of the <code>dropout_wages</code>
data purposefully constructed to be severely unbalanced.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages_subset</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 257 × 5</span></span></span>
<span><span class="co">#&gt;    id    log_wages experience black highest_grade</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 206        2.03      1.87      0            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 206        2.30      2.81      0            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 206        2.48      4.31      0            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 266        1.81      0.322     0             9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 304        1.84      0.58      0             8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 329        1.42      0.016     0             8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 329        1.31      0.716     0             8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 329        1.88      1.76      0             8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 336        1.89      1.91      1             8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 336        1.28      2.51      1             8</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 247 more rows</span></span></span></code></pre></div>
<p>First we will refit Model C to the <code>dropout_wages_subset</code>
data. Note that the estimated variance component for
<code>experience</code> is practically zero and the model summary has
the following message at the bottom: “boundary (singular) fit: see
help(‘isSingular’)”.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages_fit_A_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_C</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dropout_wages_subset</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dropout_wages_fit_A_subset</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: log_wages ~ experience + (1 + experience | id) + I(highest_grade -  </span></span>
<span><span class="co">#&gt;     9) + experience:black</span></span>
<span><span class="co">#&gt;    Data: dropout_wages_subset</span></span>
<span><span class="co">#&gt; Control: lmerControl(optimizer = "bobyqa")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    299.9    328.3   -141.9    283.9      249 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.4109 -0.4754 -0.0290  0.4243  4.2842 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance  Std.Dev. Corr</span></span>
<span><span class="co">#&gt;  id       (Intercept) 8.215e-02 0.286615     </span></span>
<span><span class="co">#&gt;           experience  3.526e-06 0.001878 1.00</span></span>
<span><span class="co">#&gt;  Residual             1.150e-01 0.339068     </span></span>
<span><span class="co">#&gt; Number of obs: 257, groups:  id, 124</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                      Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)           1.73734    0.04760  36.499</span></span>
<span><span class="co">#&gt; experience            0.05161    0.02108   2.449</span></span>
<span><span class="co">#&gt; I(highest_grade - 9)  0.04610    0.02447   1.884</span></span>
<span><span class="co">#&gt; experience:black     -0.05968    0.03477  -1.716</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) exprnc I(_-9)</span></span>
<span><span class="co">#&gt; experience  -0.612              </span></span>
<span><span class="co">#&gt; I(hghst_-9)  0.051 -0.133       </span></span>
<span><span class="co">#&gt; exprnc:blck -0.129 -0.297  0.023</span></span>
<span><span class="co">#&gt; optimizer (bobyqa) convergence code: 0 (OK)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span></code></pre></div>
<p>The first strategy Singer and Willett (2003) suggest is to remove the
boundary constraints of the software, however, the <strong>lme4</strong>
package does not support the removal of boundary constraints to allow
for negative variance components, so this strategy cannot be replicated
(Model B).</p>
<p>The second strategy is to simplify the model by fixing rates of
change, which we do by removing the varying slope for experience. Here
the model fits without issue.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages_fit_C_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A_subset</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dropout_wages_fit_C_subset</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: </span></span>
<span><span class="co">#&gt; log_wages ~ experience + I(highest_grade - 9) + (1 | id) + experience:black</span></span>
<span><span class="co">#&gt;    Data: dropout_wages_subset</span></span>
<span><span class="co">#&gt; Control: lmerControl(optimizer = "bobyqa")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    295.9    317.2   -141.9    283.9      251 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.4202 -0.4722 -0.0290  0.4197  4.2439 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.08425  0.2903  </span></span>
<span><span class="co">#&gt;  Residual             0.11480  0.3388  </span></span>
<span><span class="co">#&gt; Number of obs: 257, groups:  id, 124</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                      Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)           1.73734    0.04775  36.383</span></span>
<span><span class="co">#&gt; experience            0.05178    0.02093   2.474</span></span>
<span><span class="co">#&gt; I(highest_grade - 9)  0.04576    0.02450   1.868</span></span>
<span><span class="co">#&gt; experience:black     -0.06007    0.03458  -1.737</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) exprnc I(_-9)</span></span>
<span><span class="co">#&gt; experience  -0.614              </span></span>
<span><span class="co">#&gt; I(hghst_-9)  0.051 -0.135       </span></span>
<span><span class="co">#&gt; exprnc:blck -0.130 -0.294  0.024</span></span></code></pre></div>
<p>Comparing Models A and C, note that their deviance statistics are
identical, and that the AIC and BIC statistics are smaller in Model C,
suggesting that: (1) Model C is an improvement over Model A; and (2) we
cannot effectively model systematic interindividual differences in rates
of change with this data set.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages_fits_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A` <span class="op">=</span> <span class="va">dropout_wages_fit_A_subset</span>,</span>
<span>  `Model C` <span class="op">=</span> <span class="va">dropout_wages_fit_C_subset</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 5.5, page 154:</span></span>
<span><span class="va">dropout_wages_fits_subset</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"black"</span>,</span>
<span>      <span class="st">"experience"</span>,</span>
<span>      <span class="st">"experience:I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"experience:black"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__experience"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">14</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="ulbfdpbcyv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ulbfdpbcyv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ulbfdpbcyv thead, #ulbfdpbcyv tbody, #ulbfdpbcyv tfoot, #ulbfdpbcyv tr, #ulbfdpbcyv td, #ulbfdpbcyv th {
  border-style: none;
}

#ulbfdpbcyv p {
  margin: 0;
  padding: 0;
}

#ulbfdpbcyv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ulbfdpbcyv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ulbfdpbcyv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ulbfdpbcyv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ulbfdpbcyv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ulbfdpbcyv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ulbfdpbcyv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ulbfdpbcyv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ulbfdpbcyv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ulbfdpbcyv .gt_spanner_row {
  border-bottom-style: hidden;
}

#ulbfdpbcyv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ulbfdpbcyv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ulbfdpbcyv .gt_from_md > :first-child {
  margin-top: 0;
}

#ulbfdpbcyv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ulbfdpbcyv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ulbfdpbcyv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ulbfdpbcyv .gt_row_group_first td {
  border-top-width: 2px;
}

#ulbfdpbcyv .gt_row_group_first th {
  border-top-width: 2px;
}

#ulbfdpbcyv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ulbfdpbcyv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ulbfdpbcyv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ulbfdpbcyv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ulbfdpbcyv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_left {
  text-align: left;
}

#ulbfdpbcyv .gt_center {
  text-align: center;
}

#ulbfdpbcyv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ulbfdpbcyv .gt_font_normal {
  font-weight: normal;
}

#ulbfdpbcyv .gt_font_bold {
  font-weight: bold;
}

#ulbfdpbcyv .gt_font_italic {
  font-style: italic;
}

#ulbfdpbcyv .gt_super {
  font-size: 65%;
}

#ulbfdpbcyv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ulbfdpbcyv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ulbfdpbcyv .gt_indent_1 {
  text-indent: 5px;
}

#ulbfdpbcyv .gt_indent_2 {
  text-indent: 10px;
}

#ulbfdpbcyv .gt_indent_3 {
  text-indent: 15px;
}

#ulbfdpbcyv .gt_indent_4 {
  text-indent: 20px;
}

#ulbfdpbcyv .gt_indent_5 {
  text-indent: 25px;
}

#ulbfdpbcyv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ulbfdpbcyv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">1.737</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">1.737</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.048)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.048)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(highest_grade - 9)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.046</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.046</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.024)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.024)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.052</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.052</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.021)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.021)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:black</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">-0.060</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-0.060</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.035)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.035)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.115</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.115</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.082</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.084</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__experience</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.000</td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">283.9</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">283.9</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">299.9</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">295.9</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">328.3</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">317.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="time-varying-predictors">5.3 Time-varying predictors<a class="anchor" aria-label="anchor" href="#time-varying-predictors"></a>
</h2>
<p>In Section 5.3 Singer and Willett (2003) demonstrate how to fit the
multilevel model for change for data with <strong>time-varying
predictors</strong> using a subset of data from Ginexi, Howe, and Caplan
(2000), who measured changes in depressive symptoms after job loss in a
sample of 254 recently unemployed men and women. Interviews were
conducted in three waves at around 1, 5, and 12 months after job
loss.</p>
<p>For this example we use the <code>depression_unemployment</code> data
set, a person-period data frame with 674 rows and 5 columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>interview</code>: Time of interview. <code>months</code>:
Months since job loss.</li>
<li>
<code>depression</code>: Total score on the Center for Epidemiologic
Studies’ Depression (CES-D) scale (Radloff, 1977).</li>
<li>
<code>unemployed</code>: Binary indicator for whether the
participant was unemployed at time of interview. Note that all
participants were unemployed at the first interview, and changes in
unemployment status were gathered during the second and third
interviews.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_unemployment</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 674 × 5</span></span></span>
<span><span class="co">#&gt;    id    interview months depression unemployed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 103           1  1.15          25          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 103           2  5.95          16          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 103           3 12.9           33          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 641           1  0.789         27          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 641           2  4.86           7          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 641           3 11.8           25          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 741           1  1.05          40          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 846           1  0.624          2          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 846           2  4.93          22          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 846           3 11.8            0          0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 664 more rows</span></span></span></code></pre></div>
<p>In the <code>depression_unemployment</code> data, both the number and
spacing of measurement occasions varies across individuals.</p>
<p>A total of 193 participants (76%) had three interviews, 34
participants (13.4%) had two interviews, and 27 participants (10.6%) had
only one interview.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_unemployment</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>waves <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">waves</span>, name <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>proportion <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   waves count proportion</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1    27      0.106</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2    34      0.134</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3   193      0.760</span></span></code></pre></div>
<p>The average time between job loss and the first interview was 27.6
days (SD = 10.7; range = 2-61), 151 days for the second interview (SD =
18.3; range = 111-220), and 359 days for the third interview (SD = 19.1;
range = 319-458).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_unemployment</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">interview</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>days <span class="op">=</span> <span class="va">months</span> <span class="op">*</span> <span class="fl">30.4167</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>,</span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   interview  mean    sd    min   max</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1  27.6  10.7   2.00  61.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         2 151.   18.4 111.   220. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         3 359.   19.1 319.   458.</span></span></code></pre></div>
<p>Additionally, examining the data for a subset of individuals, we can
see that the <code>unemployed</code> variable is a time-varying
predictor with several unique patterns of change across participants.
<!-- (e.g., patterns 1-1-1, 1-0-1, 1-0-0; etc.) --></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 5.6, page 161:</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">depression_unemployment</span>, <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7589</span>, <span class="fl">55697</span>, <span class="fl">67641</span>, <span class="fl">65441</span>, <span class="fl">53782</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 5</span></span></span>
<span><span class="co">#&gt;    id    interview months depression unemployed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 7589          1  1.31          36          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 7589          2  5.09          40          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7589          3 11.8           39          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 53782         1  0.427         22          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 53782         2  4.24          15          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 53782         3 11.1           21          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 55697         1  1.35           7          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 55697         2  5.78           4          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 65441         1  1.08          27          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 65441         2  4.70          15          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 65441         3 11.3            7          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 67641         1  0.329         32          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 67641         2  4.11           9          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 67641         3 10.9           10          0</span></span></code></pre></div>
<p>Considering only participants with complete data, 78 were unemployed
at every interview (pattern 1-1-1), 55 were always employed after the
first interview (pattern 1-0-0), 41 were still unemployed at the second
interview but employed at the third (pattern 1-1-0), and 19 were
employed at the second interview but unemployed at the third (pattern
1-0-1).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unemployed_patterns</span> <span class="op">&lt;-</span> <span class="va">depression_unemployment</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>unemployed_pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">unemployed</span>, collapse <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">unemployed_pattern</span>, name <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unemployed_patterns</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   unemployed_pattern count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1-0-0                 55</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1-0-1                 19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1-1-0                 41</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1-1-1                 78</span></span></code></pre></div>
<p>As with the previous examples, no special strategies are needed to
fit the multilevel model for change with time-varying predictors.
However, as Singer and Willett (2003) discuss, the inclusion of
time-varying predictors in a model implies the existence of multiple
<strong>continuous</strong> and <strong>discontinuous</strong> change
trajectories—one for each possible pattern of the time-varying
predictors.</p>
<p>Here we will fit four models to the
<code>depression_unemployment</code> data: an unconditional growth model
(Model A), a model that includes the main effect of a time-varying
predictor (Model B), a model that includes an interaction effect with a
time-varying predictor (Model C), and a model that allows a time-varying
predictor to have both fixed and random effects (Model D).</p>
<p>Note that for Model D, Singer and Willett (2003) fit this model using
SAS, which does not report any issues with the model given the data;
however, other programs (R, MPlus, SPSS, STATA) all have
convergence/singularity problems and it is not possible to get results
that match the textbook. Each of these programs react differently to
this situation, but it is reasonable to conclude the problem is not with
the software, but with this model being too complex, given the data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">depression_unemployment_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">depression</span> <span class="op">~</span> <span class="va">months</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">months</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">depression_unemployment</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The model fails to converge with the default optimizer (although the</span></span>
<span><span class="co"># estimates are fine). Changing the optimizer achieves convergence.</span></span>
<span><span class="va">depression_unemployment_fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">depression_unemployment_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">unemployed</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">depression_unemployment_fit_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">depression_unemployment_fit_B</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">months</span><span class="op">:</span><span class="va">unemployed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The number of observations is less than the number of random effects levels</span></span>
<span><span class="co"># for each term, which makes the random effects variances (probably)</span></span>
<span><span class="co"># unidentifiable in this model and throws an error. In order to fit the model</span></span>
<span><span class="co"># we need to ignore this check.</span></span>
<span><span class="va">depression_unemployment_fit_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">depression</span> <span class="op">~</span> </span>
<span>    <span class="va">unemployed</span> <span class="op">+</span> <span class="va">unemployed</span><span class="op">:</span><span class="va">months</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">unemployed</span> <span class="op">+</span> <span class="va">months</span><span class="op">:</span><span class="va">unemployed</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">depression_unemployment</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>check.nobs.vs.nRE <span class="op">=</span> <span class="st">"ignore"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">depression_unemployment_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A` <span class="op">=</span> <span class="va">depression_unemployment_fit_A</span>,</span>
<span>  `Model B` <span class="op">=</span> <span class="va">depression_unemployment_fit_B</span>,</span>
<span>  `Model C` <span class="op">=</span> <span class="va">depression_unemployment_fit_C</span>,</span>
<span>  `Model D` <span class="op">=</span> <span class="va">depression_unemployment_fit_D</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Table 5.7, page 163:</span></span>
<span><span class="va">depression_unemployment_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"months"</span> <span class="op">=</span> <span class="st">"months"</span>,</span>
<span>      <span class="st">"black"</span> <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      <span class="st">"unemployed"</span> <span class="op">=</span> <span class="st">"unemployed"</span>,</span>
<span>      <span class="st">"months:unemployed"</span> <span class="op">=</span> <span class="st">"months:unemployed"</span>,</span>
<span>      <span class="st">"unemployed:months"</span> <span class="op">=</span> <span class="st">"months:unemployed"</span>,</span>
<span>      <span class="st">"var__Observation"</span> <span class="op">=</span> <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span> <span class="op">=</span> <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__months"</span> <span class="op">=</span> <span class="st">"var__months"</span>,</span>
<span>      <span class="st">"var__unemployed"</span> <span class="op">=</span> <span class="st">"var__unemployed"</span>,</span>
<span>      <span class="st">"var__unemployed:months"</span> <span class="op">=</span> <span class="st">"var__unemployed:months"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">14</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="kgufivjubq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kgufivjubq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kgufivjubq thead, #kgufivjubq tbody, #kgufivjubq tfoot, #kgufivjubq tr, #kgufivjubq td, #kgufivjubq th {
  border-style: none;
}

#kgufivjubq p {
  margin: 0;
  padding: 0;
}

#kgufivjubq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kgufivjubq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kgufivjubq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kgufivjubq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kgufivjubq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kgufivjubq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgufivjubq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kgufivjubq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kgufivjubq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kgufivjubq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kgufivjubq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kgufivjubq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kgufivjubq .gt_spanner_row {
  border-bottom-style: hidden;
}

#kgufivjubq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kgufivjubq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kgufivjubq .gt_from_md > :first-child {
  margin-top: 0;
}

#kgufivjubq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kgufivjubq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kgufivjubq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kgufivjubq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kgufivjubq .gt_row_group_first td {
  border-top-width: 2px;
}

#kgufivjubq .gt_row_group_first th {
  border-top-width: 2px;
}

#kgufivjubq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgufivjubq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kgufivjubq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kgufivjubq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgufivjubq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgufivjubq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kgufivjubq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kgufivjubq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kgufivjubq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgufivjubq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kgufivjubq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgufivjubq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kgufivjubq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgufivjubq .gt_left {
  text-align: left;
}

#kgufivjubq .gt_center {
  text-align: center;
}

#kgufivjubq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kgufivjubq .gt_font_normal {
  font-weight: normal;
}

#kgufivjubq .gt_font_bold {
  font-weight: bold;
}

#kgufivjubq .gt_font_italic {
  font-style: italic;
}

#kgufivjubq .gt_super {
  font-size: 65%;
}

#kgufivjubq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kgufivjubq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kgufivjubq .gt_indent_1 {
  text-indent: 5px;
}

#kgufivjubq .gt_indent_2 {
  text-indent: 10px;
}

#kgufivjubq .gt_indent_3 {
  text-indent: 15px;
}

#kgufivjubq .gt_indent_4 {
  text-indent: 20px;
}

#kgufivjubq .gt_indent_5 {
  text-indent: 25px;
}

#kgufivjubq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kgufivjubq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model D">Model D</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">17.669</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">12.666</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">9.617</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">11.195</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.776)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(1.242)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(1.889)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.790)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">months</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">-0.422</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">-0.202</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.162</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.083)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.093)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.194)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">unemployed</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">5.111</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">8.529</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">6.927</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.989)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(1.878)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.930)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">months:unemployed</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-0.465</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.303</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.217)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.112)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">68.848</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">62.388</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">62.031</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">59.019</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">86.852</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">93.519</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">93.713</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">45.257</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__months</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.355</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.465</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.451</td>
<td headers="Variance Components  Model D" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__unemployed</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center">44.969</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__unemployed:months</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.753</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">5133.1</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">5107.6</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">5103.0</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">5095.3</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">5145.1</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">5121.6</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">5119.0</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">5115.3</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">5172.2</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">5153.2</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">5155.2</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">5160.4</td>
</tr>
</tbody>
</table>
</div>
<!-- TODO:
p. 229, 262

Moreover, 
>When you add a time-varying predictor, as either a main effect or an interaction, you change the meaning of the individual growth parameters because: • The intercept parameter, π0i, now refers to the value of the outcome when all level-1 predictors, not only TIME but also the time-varying predictor, are zero. • The slope parameter, π1i, is now a conditional rate of change, controlling for the effects of the time-varying predictor. Altering the population quantity that each parameter represents alters the meaning of the associated level-2 variance component. Hence, it makes no sense to compare the magnitude of these variance components across successive models. This means that you must rely on changes in the time-varying predictors fixed effects, and associated goodness-of-fit statistics, when deciding (p.171) whether to retain a timevarying predictor in your model.
-->
<div class="section level3">
<h3 id="plotting-discontinuous-change-trajectories">Plotting discontinuous change trajectories<a class="anchor" aria-label="anchor" href="#plotting-discontinuous-change-trajectories"></a>
</h3>
<p>Unlike previous examples, the addition of a time-varying predictor in
the model implies that a given change trajectory may be composed of
either <strong>one continuous segment</strong> or <strong>multiple
discontinuous segments</strong>. Because of this, new strategies are
required to construct a data set for prototypical individuals and plot
their fitted change trajectories, where each segment has its own start
and end times and predictions. This data set can be in either a wide or
long format, however: For wide formats, each segment must be plotted
using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment()</a></code> function from the
<strong>ggplot2</strong> package; whereas for long formats, each segment
must have its own grouping ID, but can otherwise be plotted using the
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> function as usual. We demonstrate both formats
here by constructing prototypical change trajectories for Model B.</p>
<p>A convenient way to construct a data set for prototypical individuals
in wide format is with the <code><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe()</a></code> function from the
<strong>dplyr</strong> package, which works similarly to the
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> function, but can return an arbitrary number of
rows per group. Here we use it to (1) expand each
<code>unemployed_pattern</code> string into a numeric vector using the
<code><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract_all()</a></code> function from the
<strong>stringr</strong> package; and (2) add start and stop times for
each segment. After this prediction proceeds as usual, except that we
use dplyr’s <code><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across()</a></code> function to avoid writing the same
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> code.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_depression_B</span> <span class="op">&lt;-</span> <span class="va">unemployed_patterns</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">count</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">unemployed_pattern</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    unemployed <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract_all</a></span><span class="op">(</span><span class="va">unemployed_pattern</span>, <span class="st">"[:digit:]"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    unemployed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">unemployed</span><span class="op">)</span>,</span>
<span>    months_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    months_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"months"</span><span class="op">)</span>,</span>
<span>      \<span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>          <span class="va">depression_unemployment_fit_B</span>,</span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">unemployed</span>, months <span class="op">=</span> <span class="va">.time</span><span class="op">)</span>,</span>
<span>          re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span>,</span>
<span>      .names <span class="op">=</span> <span class="st">"depression_{.col}"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    unemployed_pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">unemployed_pattern</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1-1-1"</span>, <span class="st">"1-0-0"</span>, <span class="st">"1-1-0"</span>, <span class="st">"1-0-1"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"months_"</span><span class="op">)</span>, .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"depression"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">prototypical_depression_B</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 6</span></span></span>
<span><span class="co">#&gt;    unemployed_pattern unemployed months_start months_end depression_start</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1-0-0                       1            0          5             17.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1-0-0                       0            5         10             11.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1-0-0                       0           10         15             10.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1-0-1                       1            0          5             17.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1-0-1                       0            5         10             11.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1-0-1                       1           10         15             15.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1-1-0                       1            0          5             17.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1-1-0                       1            5         10             16.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1-1-0                       0           10         15             10.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1-1-1                       1            0          5             17.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 1-1-1                       1            5         10             16.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 1-1-1                       1           10         15             15.8</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: depression_end &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Although we will plot the prototypical trajectories using the wide
format data, note here that a convenient way to create a grouping ID for
long format data is with the <code><a href="https://dplyr.tidyverse.org/reference/consecutive_id.html" class="external-link">consecutive_id()</a></code> function from
the dplyr package, which generates a unique identifier that increments
every time a variable changes. The resulting variable can then be passed
to ggplot2’s <code>group</code> aesthetic to ensure the correct cases
are connected together.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_depression_B</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"months"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"depression"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".value"</span><span class="op">)</span>,</span>
<span>    names_pattern <span class="op">=</span> <span class="st">"(^.*(?=_))"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">unemployed_pattern</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cid <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/consecutive_id.html" class="external-link">consecutive_id</a></span><span class="op">(</span><span class="va">unemployed</span><span class="op">)</span>, .after <span class="op">=</span> <span class="va">unemployed_pattern</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   unemployed_pattern [4]</span></span></span>
<span><span class="co">#&gt;    unemployed_pattern   cid unemployed months depression</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1-0-0                  1          1      0      17.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1-0-0                  1          1      5      16.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1-0-0                  2          0      5      11.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1-0-0                  2          0     10      10.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1-0-0                  2          0     10      10.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1-0-0                  2          0     15       9.64</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1-0-1                  1          1      0      17.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1-0-1                  1          1      5      16.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1-0-1                  2          0      5      11.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1-0-1                  2          0     10      10.6 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more rows</span></span></span></code></pre></div>
<p>Now we can plot the four trajectories.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 5.3:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_depression_B</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">months_start</span>, y <span class="op">=</span> <span class="va">depression_start</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="va">months_end</span>, yend <span class="op">=</span> <span class="va">depression_end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">unemployed_pattern</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"months"</span>, y <span class="op">=</span> <span class="st">"depression"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-5_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>An alternative strategy for plotting discontinuous change
trajectories suggested by Singer and Willett (2003) is to represent the
wide variety of transition times using just two continuous trajectories
that encompass the most extreme contrasts possible: Here, someone who is
consistently unemployed, and someone who is consistently employed. With
this approach, prototypical change trajectories can be predicted and
plotted using the same strategies we have used for models with
time-invariant predictors, while conveying the same (or more)
information as the set of discontinuous trajectories above.</p>
<p>We demonstrate this alternative strategy for Models B, C, and D.
Because of the <code>depression_unemployment</code> study’s design, we
start the fitted trajectory for a consistently employed individual at
3.5 months—the earliest time a participant could have their second
interview.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_depression</span> <span class="op">&lt;-</span> <span class="va">depression_unemployment_fits</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.fit</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span></span>
<span>          data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span>, <span class="fl">3.5</span>, <span class="fl">14</span><span class="op">)</span>, unemployed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>depression <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>unemployed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">unemployed</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 5.4, page 167:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_depression</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">months</span>, y <span class="op">=</span> <span class="va">depression</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">unemployed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-5_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>When examining plots like these, Singer and Willett (2003) suggest
thinking of the two extreme trajectories as an envelope representing the
complete set of prototypical individuals implied by each model:</p>
<ul>
<li>Because all participants were unemployed at the first interview (by
design), each individual starts on the unemployed trajectory.</li>
<li>For the second interview—regardless of the transition time—those who
become employed move to the employed trajectory, and those who don’t
stay on the unemployed trajectory.</li>
<li>For the third interview—regardless of the transition time—those who
become unemployed again move back to the unemployed trajectory, and
those who don’t stay on the employed trajectory.</li>
</ul>
</div>
<div class="section level3">
<h3 id="recentring-time-varying-predictors">5.3.3 Recentring time-varying predictors<a class="anchor" aria-label="anchor" href="#recentring-time-varying-predictors"></a>
</h3>
<p>In Section 5.3.3 Singer and Willett (2003) return to the
<code>dropout_wages</code> data to discuss three strategies for centring
time-varying predictors:</p>
<ul>
<li>
<strong>Constant centring</strong>: Centre around a single
substantively meaningful constant for all observations.</li>
<li>
<strong>Within-person centring</strong>: Decompose the time-varying
predictor into two constituent predictors where, for each individual,
the first predictor is their <em>within-person mean</em>; and the second
predictor is each measurement occasion’s <em>deviation from their
within-person mean</em>.</li>
<li>
<strong>Time-one centring</strong>: Decompose the time-varying
predictor into two constituent predictors where, for each individual,
the first predictor is the value of their <em>first measurement
occasion</em>; and the second predictor is each measurement occasion’s
<em>deviation from the first measurement occasion</em>.</li>
</ul>
<p>We demonstrate each of these strategies by updating Model C,
<code>dropout_wages_fit_C</code>, to include the main effect of the
time-varying predictor <code>unemployment_rate</code>, fitting a model
that uses constant centring (Model A2), within-person centring (Model
B2), and time-one centring (Model C2).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">dropout_wages_fit_A2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_C</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">unemployment_rate</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_B2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_C</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">unemployment_rate_mean</span> <span class="op">+</span> <span class="va">unemployment_rate_dev</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">dropout_wages</span>,</span>
<span>    unemployment_rate_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>    unemployment_rate_dev <span class="op">=</span> <span class="va">unemployment_rate</span> <span class="op">-</span> <span class="va">unemployment_rate_mean</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">id</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_C2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_C</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">unemployment_rate_first</span> <span class="op">+</span> <span class="va">unemployment_rate_dev</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">dropout_wages</span>,</span>
<span>    unemployment_rate_first <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>    unemployment_rate_dev <span class="op">=</span> <span class="va">unemployment_rate</span> <span class="op">-</span> <span class="va">unemployment_rate_first</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">id</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fits_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A2` <span class="op">=</span> <span class="va">dropout_wages_fit_A2</span>,</span>
<span>  `Model B2` <span class="op">=</span> <span class="va">dropout_wages_fit_B2</span>,</span>
<span>  `Model C2` <span class="op">=</span> <span class="va">dropout_wages_fit_C2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Table 5.8:</span></span>
<span><span class="va">dropout_wages_fits_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"I(highest_grade - 9)"</span> <span class="op">=</span> <span class="st">"I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"I(unemployment_rate - 7)"</span> <span class="op">=</span> <span class="st">"unemployment_rate"</span>,</span>
<span>      <span class="st">"unemployment_rate_mean"</span> <span class="op">=</span> <span class="st">"unemployment_rate"</span>,</span>
<span>      <span class="st">"unemployment_rate_first"</span> <span class="op">=</span> <span class="st">"unemployment_rate"</span>,</span>
<span>      <span class="st">"unemployment_rate_dev"</span> <span class="op">=</span> <span class="st">"unemployment_rate_dev"</span>,</span>
<span>      <span class="st">"black"</span> <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      <span class="st">"experience"</span> <span class="op">=</span> <span class="st">"experience"</span>,</span>
<span>      <span class="st">"experience:I(highest_grade - 9)"</span> <span class="op">=</span> <span class="st">"experience:I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"experience:black"</span> <span class="op">=</span> <span class="st">"experience:black"</span>,</span>
<span>      <span class="st">"var__Observation"</span> <span class="op">=</span> <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span> <span class="op">=</span> <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__experience"</span> <span class="op">=</span> <span class="st">"var__experience"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    fmt <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">16</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="txvafbsnay" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#txvafbsnay table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#txvafbsnay thead, #txvafbsnay tbody, #txvafbsnay tfoot, #txvafbsnay tr, #txvafbsnay td, #txvafbsnay th {
  border-style: none;
}

#txvafbsnay p {
  margin: 0;
  padding: 0;
}

#txvafbsnay .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#txvafbsnay .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#txvafbsnay .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#txvafbsnay .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#txvafbsnay .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#txvafbsnay .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#txvafbsnay .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#txvafbsnay .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#txvafbsnay .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#txvafbsnay .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#txvafbsnay .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#txvafbsnay .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#txvafbsnay .gt_spanner_row {
  border-bottom-style: hidden;
}

#txvafbsnay .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#txvafbsnay .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#txvafbsnay .gt_from_md > :first-child {
  margin-top: 0;
}

#txvafbsnay .gt_from_md > :last-child {
  margin-bottom: 0;
}

#txvafbsnay .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#txvafbsnay .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#txvafbsnay .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#txvafbsnay .gt_row_group_first td {
  border-top-width: 2px;
}

#txvafbsnay .gt_row_group_first th {
  border-top-width: 2px;
}

#txvafbsnay .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#txvafbsnay .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#txvafbsnay .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#txvafbsnay .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#txvafbsnay .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#txvafbsnay .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#txvafbsnay .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#txvafbsnay .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#txvafbsnay .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#txvafbsnay .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#txvafbsnay .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#txvafbsnay .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#txvafbsnay .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#txvafbsnay .gt_left {
  text-align: left;
}

#txvafbsnay .gt_center {
  text-align: center;
}

#txvafbsnay .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#txvafbsnay .gt_font_normal {
  font-weight: normal;
}

#txvafbsnay .gt_font_bold {
  font-weight: bold;
}

#txvafbsnay .gt_font_italic {
  font-style: italic;
}

#txvafbsnay .gt_super {
  font-size: 65%;
}

#txvafbsnay .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#txvafbsnay .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#txvafbsnay .gt_indent_1 {
  text-indent: 5px;
}

#txvafbsnay .gt_indent_2 {
  text-indent: 10px;
}

#txvafbsnay .gt_indent_3 {
  text-indent: 15px;
}

#txvafbsnay .gt_indent_4 {
  text-indent: 20px;
}

#txvafbsnay .gt_indent_5 {
  text-indent: 25px;
}

#txvafbsnay .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#txvafbsnay div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A2">Model A2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B2">Model B2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C2">Model C2</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">1.7490</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">1.8743</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">1.8693</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">(0.0114)</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">(0.0295)</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">(0.0260)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(highest_grade - 9)</td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">0.0400</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">0.0402</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">0.0399</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">(0.0064)</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">(0.0064)</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">(0.0063)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">unemployment_rate</td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">-0.0120</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">-0.0177</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">-0.0162</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">(0.0018)</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">(0.0035)</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">(0.0026)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">unemployment_rate_dev</td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">-0.0099</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">-0.0103</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">(0.0021)</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">(0.0019)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience</td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">0.0441</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">0.0451</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">0.0448</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">(0.0026)</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">(0.0026)</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">(0.0026)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:black</td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">-0.0182</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">-0.0189</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">-0.0183</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A2" class="gt_row gt_center">(0.0045)</td>
<td headers="Fixed Effects  Model B2" class="gt_row gt_center">(0.0045)</td>
<td headers="Fixed Effects  Model C2" class="gt_row gt_center">(0.0045)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A2" class="gt_row gt_center">0.0948</td>
<td headers="Variance Components  Model B2" class="gt_row gt_center">0.0948</td>
<td headers="Variance Components  Model C2" class="gt_row gt_center">0.0948</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A2" class="gt_row gt_center">0.0506</td>
<td headers="Variance Components  Model B2" class="gt_row gt_center">0.0510</td>
<td headers="Variance Components  Model C2" class="gt_row gt_center">0.0503</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__experience</td>
<td headers="Variance Components  Model A2" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.0016</td>
<td headers="Variance Components  Model B2" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.0016</td>
<td headers="Variance Components  Model C2" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.0016</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A2" class="gt_row gt_center">4830.5</td>
<td headers="Goodness-of-Fit  Model B2" class="gt_row gt_center">4827.0</td>
<td headers="Goodness-of-Fit  Model C2" class="gt_row gt_center">4825.8</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A2" class="gt_row gt_center">4848.5</td>
<td headers="Goodness-of-Fit  Model B2" class="gt_row gt_center">4847.0</td>
<td headers="Goodness-of-Fit  Model C2" class="gt_row gt_center">4845.8</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A2" class="gt_row gt_center">4909.4</td>
<td headers="Goodness-of-Fit  Model B2" class="gt_row gt_center">4914.6</td>
<td headers="Goodness-of-Fit  Model C2" class="gt_row gt_center">4913.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="recentring-the-effect-of-time">5.4 Recentring the effect of time<a class="anchor" aria-label="anchor" href="#recentring-the-effect-of-time"></a>
</h2>
<p>In Section 5.4 Singer and Willett (2003) discuss strategies for
centring time-indicator variables using a subset of data from Tomarken,
Shelton, Elkins, and Anderson (1997), who measured the relation between
changes in positive mood and supplemental antidepressant medication over
the course of a week in a sample of 73 men and women already receiving
nonpharmacological therapy for depression.</p>
<p>For this example we use the <code>antidepressants</code> data set, a
person-period data frame with 1242 rows and 8 columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>wave</code>: Wave of measurement.</li>
<li>
<code>day</code>: Day of measurement.</li>
<li>
<code>reading</code>: Time of day a reading was taken. <!--
- `time_of_day`: Time of day a reading was taken, expressed numerically (0 for morning readings; 0.33 for afternoon readings; 0.67 for evening readings).
- `time`: Time of measurement expressed as a combination of `day` and `time_of_day`.
-->
</li>
<li>
<code>positive_mood</code>: Positive mood score.</li>
<li>
<code>treatment</code>: Treatment condition (placebo pills = 0,
antidepressant pills = 1).</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">antidepressants</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,242 × 6</span></span></span>
<span><span class="co">#&gt;    id     wave   day reading positive_mood treatment</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1     0 8 AM             107.         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         2     0 3 PM             100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         3     0 10 PM            100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1         4     1 8 AM             100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1         5     1 3 PM             100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1         6     1 10 PM            100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1         7     2 8 AM             100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1         8     2 3 PM             100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1         9     2 10 PM            100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1        10     3 8 AM             107.         1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,232 more rows</span></span></span></code></pre></div>
<p>Note that the <code>antidepressants</code> data has three
time-indicator variables, each providing a different representation of
time:</p>
<ul>
<li>The values of <code>wave</code> reflect the study’s design, but have
little substantive meaning due to the conceptual difficulty of dividing
one week into 21 components.</li>
<li>The values of <code>day</code> reflect the study’s design in a
meaningful way, but fail to distinguish between morning, afternoon, and
evening readings.</li>
<li>The values of <code>reading</code> also reflect the study’s design
in a meaningful way—capturing the time of day each reading was taken—but
fail to distinguish between days, and are difficult to analyze due to
being a character vector.</li>
</ul>
<p>To facilitate model fitting, we can create new time-indicator
variables that are more meaningful and easier to analyze. Here we create
two new time-indicator variables:</p>
<ul>
<li>
<code>time_of_day</code>: Time of day a reading was taken, expressed
numerically (0 for morning readings; 0.33 for afternoon readings; 0.67
for evening readings).</li>
<li>
<code>time</code>: Time of measurement expressed as a combination of
<code>day</code> and <code>time_of_day</code>.</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">antidepressants</span> <span class="op">&lt;-</span> <span class="va">antidepressants</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    time_of_day <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">reading</span> <span class="op">==</span> <span class="st">"8 AM"</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>      <span class="va">reading</span> <span class="op">==</span> <span class="st">"3 PM"</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>      <span class="va">reading</span> <span class="op">==</span> <span class="st">"10 PM"</span> <span class="op">~</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span></span>
<span>    <span class="op">)</span>,</span>
<span>    time <span class="op">=</span> <span class="va">day</span> <span class="op">+</span> <span class="va">time_of_day</span>,</span>
<span>    .after <span class="op">=</span> <span class="va">reading</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">antidepressants</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,242 × 8</span></span></span>
<span><span class="co">#&gt;    id     wave   day reading time_of_day  time positive_mood treatment</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1     0 8 AM          0     0              107.         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         2     0 3 PM          0.333 0.333          100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         3     0 10 PM         0.667 0.667          100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1         4     1 8 AM          0     1              100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1         5     1 3 PM          0.333 1.33           100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1         6     1 10 PM         0.667 1.67           100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1         7     2 8 AM          0     2              100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1         8     2 3 PM          0.333 2.33           100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1         9     2 10 PM         0.667 2.67           100          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1        10     3 8 AM          0     3              107.         1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,232 more rows</span></span></span></code></pre></div>
<p>The advantage of the <code>time</code> variable is that it captures
both aspects of time in the <code>antidepressants</code> data in a
single variable, making it is easy to centre on different time points in
the study. Following Singer and Willett (2003), here we centre
<code>time</code> on three different points in the study:</p>
<ul>
<li>
<code>time</code>: centred on initial status.</li>
<li>
<code>time_3.33</code>: centred on the study’s midpoint.</li>
<li>
<code>time_6.67</code>: centred on the study’s final wave.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 5.9, page 182:</span></span>
<span><span class="va">antidepressants</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">positive_mood</span>, <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time_3.33 <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fl">3.33</span>, time_6.67 <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fl">6.67</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,242 × 7</span></span></span>
<span><span class="co">#&gt;     wave   day reading time_of_day  time time_3.33 time_6.67</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     0 8 AM          0     0        -<span style="color: #BB0000;">3.33</span>      -<span style="color: #BB0000;">6.67</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     0 3 PM          0.333 0.333    -<span style="color: #BB0000;">3.00</span>      -<span style="color: #BB0000;">6.34</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     0 10 PM         0.667 0.667    -<span style="color: #BB0000;">2.66</span>      -<span style="color: #BB0000;">6.00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4     1 8 AM          0     1        -<span style="color: #BB0000;">2.33</span>      -<span style="color: #BB0000;">5.67</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5     1 3 PM          0.333 1.33     -<span style="color: #BB0000;">2.00</span>      -<span style="color: #BB0000;">5.34</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6     1 10 PM         0.667 1.67     -<span style="color: #BB0000;">1.66</span>      -<span style="color: #BB0000;">5.00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7     2 8 AM          0     2        -<span style="color: #BB0000;">1.33</span>      -<span style="color: #BB0000;">4.67</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8     2 3 PM          0.333 2.33     -<span style="color: #BB0000;">0.997</span>     -<span style="color: #BB0000;">4.34</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9     2 10 PM         0.667 2.67     -<span style="color: #BB0000;">0.663</span>     -<span style="color: #BB0000;">4.00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10     3 8 AM          0     3        -<span style="color: #BB0000;">0.33</span>      -<span style="color: #BB0000;">3.67</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,232 more rows</span></span></span></code></pre></div>
<p>Here we will fit three models to the <code>antidepressants</code>
data to demonstrate how centring time affects parameter estimates and
interpretation: a model with time centred on initial status (Model A), a
model with time centred on the study’s midpoint (Model B), a model with
time centred on the study’s final wave (Model C).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">antidepressants_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">positive_mood</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">antidepressants</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">antidepressants_fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">antidepressants_fit_A</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">antidepressants</span>, time <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fl">3.33</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">antidepressants_fit_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">antidepressants_fit_A</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">antidepressants</span>, time <span class="op">=</span> <span class="va">time</span> <span class="op">-</span> <span class="fl">6.67</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">antidepressants_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A` <span class="op">=</span> <span class="va">antidepressants_fit_A</span>,</span>
<span>  `Model B` <span class="op">=</span> <span class="va">antidepressants_fit_B</span>,</span>
<span>  `Model C` <span class="op">=</span> <span class="va">antidepressants_fit_C</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Table 5.10, page 184:</span></span>
<span><span class="va">antidepressants_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"treatment"</span>,</span>
<span>      <span class="st">"time"</span>,</span>
<span>      <span class="st">"treatment:time"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__time"</span>,</span>
<span>      <span class="st">"cov__(Intercept).time"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="orehalspkz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#orehalspkz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#orehalspkz thead, #orehalspkz tbody, #orehalspkz tfoot, #orehalspkz tr, #orehalspkz td, #orehalspkz th {
  border-style: none;
}

#orehalspkz p {
  margin: 0;
  padding: 0;
}

#orehalspkz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#orehalspkz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#orehalspkz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#orehalspkz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#orehalspkz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#orehalspkz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#orehalspkz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#orehalspkz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#orehalspkz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#orehalspkz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#orehalspkz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#orehalspkz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#orehalspkz .gt_spanner_row {
  border-bottom-style: hidden;
}

#orehalspkz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#orehalspkz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#orehalspkz .gt_from_md > :first-child {
  margin-top: 0;
}

#orehalspkz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#orehalspkz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#orehalspkz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#orehalspkz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#orehalspkz .gt_row_group_first td {
  border-top-width: 2px;
}

#orehalspkz .gt_row_group_first th {
  border-top-width: 2px;
}

#orehalspkz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#orehalspkz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#orehalspkz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#orehalspkz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#orehalspkz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#orehalspkz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#orehalspkz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#orehalspkz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#orehalspkz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#orehalspkz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#orehalspkz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#orehalspkz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#orehalspkz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#orehalspkz .gt_left {
  text-align: left;
}

#orehalspkz .gt_center {
  text-align: center;
}

#orehalspkz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#orehalspkz .gt_font_normal {
  font-weight: normal;
}

#orehalspkz .gt_font_bold {
  font-weight: bold;
}

#orehalspkz .gt_font_italic {
  font-style: italic;
}

#orehalspkz .gt_super {
  font-size: 65%;
}

#orehalspkz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#orehalspkz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#orehalspkz .gt_indent_1 {
  text-indent: 5px;
}

#orehalspkz .gt_indent_2 {
  text-indent: 10px;
}

#orehalspkz .gt_indent_3 {
  text-indent: 15px;
}

#orehalspkz .gt_indent_4 {
  text-indent: 20px;
}

#orehalspkz .gt_indent_5 {
  text-indent: 25px;
}

#orehalspkz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#orehalspkz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">167.463</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">159.411</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">151.335</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(9.327)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(8.763)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(11.546)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">treatment</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">-3.109</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">15.328</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">33.821</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(12.333)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(11.543)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(15.163)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">time</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">-2.418</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">-2.418</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-2.418</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(1.731)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(1.731)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(1.731)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">treatment:time</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">5.537</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">5.537</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">5.537</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(2.278)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(2.278)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(2.278)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">1229.926</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">1229.930</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">1229.931</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">2111.536</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">2008.159</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">3324.498</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__time</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">63.736</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">63.736</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">63.735</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">cov__(Intercept).time</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-121.633</td>
<td headers="Variance Components  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">90.619</td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">303.494</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="4" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">12680.5</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">12680.5</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">12680.5</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">12696.5</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">12696.5</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">12696.5</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">12737.4</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">12737.4</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">12737.4</td>
</tr>
</tbody>
</table>
</div>
<p>Notice that the parameters related to the slope are identical between
Models A, B, and C, but the those related to the intercept are
different. As Singer and Willett (2003) explain, this is because
centring a time-indicator variable changes the location of the fitted
trajectory’s anchors around a given point in time.</p>
<p>We can visualize this anchoring effect by plotting prototypical
change trajectories for the models fit to the
<code>antidepressants</code> data: As the dashed vertical lines
highlight, centring a time-indicator variable changes the location of
the focal comparison between the control and treatment groups in the
model, causing the resultant estimates to describe the trajectories
behaviours at that specific point in time.</p>
<p>Note that because Models A, B, and C are structurally identical, it
does not matter which model is used here to make predictions—they all
have the same prototypical change trajectories.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">protoypical_mood</span> <span class="op">&lt;-</span> <span class="va">antidepressants_fit_A</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.33</span>, <span class="fl">6.67</span>, <span class="fl">0</span>, <span class="fl">3.33</span>, <span class="fl">6.67</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>positive_mood <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Figure 5.5, page 185:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">protoypical_mood</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">positive_mood</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">time</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">140</span>, <span class="fl">190</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-5_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael McCarthy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
