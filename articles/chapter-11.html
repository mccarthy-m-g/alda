<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="alda">
<title>Chapter 11: Fitting basic discrete-time hazard models • alda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 11: Fitting basic discrete-time hazard models">
<meta property="og:description" content="alda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">alda</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tips-amp-tricks">Tips &amp; Tricks</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tips-amp-tricks">
    <a class="dropdown-item" href="../articles/longitudinal-data-organization.html">Longitudinal data organization</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-textbook-examples">Textbook examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-textbook-examples">
    <h6 class="dropdown-header" data-toc-skip>Longitudinal mixed effects modelling</h6>
    <a class="dropdown-item" href="../articles/chapter-2.html">Chapter 2</a>
    <a class="dropdown-item" href="../articles/chapter-3.html">Chapter 3</a>
    <a class="dropdown-item" href="../articles/chapter-4.html">Chapter 4</a>
    <a class="dropdown-item" href="../articles/chapter-5.html">Chapter 5</a>
    <a class="dropdown-item" href="../articles/chapter-6.html">Chapter 6</a>
    <a class="dropdown-item" href="../articles/chapter-7.html">Chapter 7</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Longitudinal structural equation modelling</h6>
    <a class="dropdown-item" href="../articles/chapter-8.html">Chapter 8</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Survival analysis</h6>
    <a class="dropdown-item" href="../articles/chapter-9.html">Chapter 9</a>
    <a class="dropdown-item" href="../articles/chapter-10.html">Chapter 10</a>
    <a class="dropdown-item" href="../articles/chapter-11.html">Chapter 11</a>
    <a class="dropdown-item" href="../articles/chapter-12.html">Chapter 12</a>
    <a class="dropdown-item" href="../articles/chapter-13.html">Chapter 13</a>
    <a class="dropdown-item" href="../articles/chapter-14.html">Chapter 14</a>
    <a class="dropdown-item" href="../articles/chapter-15.html">Chapter 15</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mccarthy-m-g/alda/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Chapter 11: Fitting basic discrete-time hazard models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mccarthy-m-g/alda/blob/HEAD/vignettes/articles/chapter-11.Rmd" class="external-link"><code>vignettes/articles/chapter-11.Rmd</code></a></small>
      <div class="d-none name"><code>chapter-11.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mccarthy-m-g.github.io/alda/">alda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modelsummary.com" class="external-link">modelsummary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="toward-a-statistical-model-for-discrete-time-hazard">11.1 Toward a statistical model for discrete-time hazard<a class="anchor" aria-label="anchor" href="#toward-a-statistical-model-for-discrete-time-hazard"></a>
</h2>
<p>In Chapter 11 Singer and Willett (2003) develop and explain the
<strong>discrete-time hazard model</strong> using a subset of data from
Capaldi, Crosby, and Stoolmiller (1996), who measured the grade year of
first sexual intercourse in a sample of 180 at-risk heterosexual
adolescent males. Adolescent males were followed from Grade 7 up to
Grade 12 or until they reported having had sexual intercourse for the
first time.</p>
<p>For this example we return to the <code>first_sex</code> data set
introduced in Chapter 10, a person-level data frame with 180 rows and 5
columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>grade</code>: Grade year of first sexual intercourse.</li>
<li>
<code>censor</code>: Censoring status.</li>
<li>
<code>parental_transition</code>: Binary indicator for whether the
adolescent experienced a parental transition (where their parents
separated or repartnered).</li>
<li>
<code>parental_antisociality</code>: Composite score across four
indicators measuring parents’ level of antisocial behaviour during the
child’s formative years.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 180 × 5</span></span></span>
<span><span class="co">#&gt;    id    grade censor parental_transition parental_antisociality</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         9      0                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2        12      1                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3        12      1                   0                 -<span style="color: #BB0000;">1.40</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 5        12      0                   1                  0.974</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 6        11      0                   0                 -<span style="color: #BB0000;">0.636</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 7         9      0                   1                 -<span style="color: #BB0000;">0.243</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 9        12      1                   0                 -<span style="color: #BB0000;">0.869</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10       11      0                   0                  0.454</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 11       12      1                   1                  0.802</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 12       11      0                   1                 -<span style="color: #BB0000;">0.746</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 170 more rows</span></span></span></code></pre></div>
<p>To inform specification of the discrete-time hazard model we will fit
in subsequent sections, we begin with some basic exploration and
description of the <code>first_sex</code> data using the life table
methods introduced in Chapter 9.</p>
<div class="section level3">
<h3 id="plots-of-within-group-hazard-functions-and-survival-functions">Plots of within-group hazard functions and survival functions<a class="anchor" aria-label="anchor" href="#plots-of-within-group-hazard-functions-and-survival-functions"></a>
</h3>
<p>Here we will construct the life table “by hand”, thus, we first need
to convert the person-level <code>first_sex</code> data set to a
person-period data set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_pp</span> <span class="op">&lt;-</span> <span class="va">first_sex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>grades <span class="op">=</span> <span class="va">grade</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    grade <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">grades</span><span class="op">)</span>,</span>
<span>    event <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">grade</span> <span class="op">==</span> <span class="va">grades</span> <span class="op">&amp;</span> <span class="va">censor</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="va">parental_transition</span>,</span>
<span>    <span class="va">parental_antisociality</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_pp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 822 × 5</span></span></span>
<span><span class="co">#&gt;    id    grade event parental_transition parental_antisociality</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         7     0                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         8     0                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         9     1                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2         7     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2         8     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2         9     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2        10     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2        11     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2        12     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3         7     0                   0                 -<span style="color: #BB0000;">1.40</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 812 more rows</span></span></span></code></pre></div>
<p>As Singer and Willett (2003) discuss, our focus for this example
centres on modelling the relationship between hazard and the
time-invariant <code>parental_transition</code> predictor. Therefore, we
will create two life tables using the <code>first_sex_pp</code> data:
one summarizing the overall distribution of event occurrence, and
another summarizing distribution of event occurrence stratified by
values of <code>parental_transition</code>.</p>
<p>Note that when estimating the survival probabilities using the “by
hand” approach, we do so after the call to the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code>
function because estimates of the survivor probabilities are given by
the <em>cumulative product</em> of the complement of the estimated
hazard probabilities <em>across the current and all previous
intervals</em>—which we cannot compute correctly while the data frame is
grouped by time.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_lifetables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parental_transition"</span>, <span class="st">"grade"</span><span class="op">)</span>,</span>
<span>    overall <span class="op">=</span> <span class="st">"grade"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">first_sex_pp</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>        n.risk <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        n.event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">event</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        n.censor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">event</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        .groups <span class="op">=</span> <span class="st">"drop_last"</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="co"># We have to estimate survival after the summarise() call because it uses</span></span>
<span>      <span class="co"># cumprod() across years, which isn't possible while the df is grouped.</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        haz.estimate <span class="op">=</span> <span class="va">n.event</span> <span class="op">/</span> <span class="va">n.risk</span>,</span>
<span>        surv.estimate <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">haz.estimate</span>,</span>
<span>        surv.estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="va">surv.estimate</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 11.1, page 360:</span></span>
<span><span class="va">first_sex_lifetables</span></span>
<span><span class="co">#&gt; $parental_transition</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 7</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   parental_transition [2]</span></span></span>
<span><span class="co">#&gt;    parental_transition grade n.risk n.event n.censor haz.estimate surv.estimate</span></span>
<span><span class="co">#&gt;                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>                   0     7     72       2       70       0.027<span style="text-decoration: underline;">8</span>         0.972</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>                   0     8     70       2       68       0.028<span style="text-decoration: underline;">6</span>         0.944</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>                   0     9     68       8       60       0.118          0.833</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>                   0    10     60       8       52       0.133          0.722</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>                   0    11     52      10       42       0.192          0.583</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>                   0    12     42       8       34       0.190          0.472</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>                   1     7    108      13       95       0.120          0.880</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>                   1     8     95       5       90       0.052<span style="text-decoration: underline;">6</span>         0.833</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>                   1     9     90      16       74       0.178          0.685</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>                   1    10     74      21       53       0.284          0.491</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>                   1    11     53      15       38       0.283          0.352</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>                   1    12     38      18       20       0.474          0.185</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $overall</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   grade n.risk n.event n.censor haz.estimate surv.estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     7    180      15      165       0.083<span style="text-decoration: underline;">3</span>         0.917</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     8    165       7      158       0.042<span style="text-decoration: underline;">4</span>         0.878</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     9    158      24      134       0.152          0.744</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    10    134      29      105       0.216          0.583</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    11    105      25       80       0.238          0.444</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    12     80      26       54       0.325          0.3</span></span></code></pre></div>
<p>Similar to the task in growth modelling of selecting a common
functional form for the individual trajectories, a major task in
specifying a suitable discrete-time hazard model is to select a common
shape for the hazard function across groups.</p>
<p>To inform specification of the shape of the hazard function, we can
look at plots of sample hazard functions and survivor functions
estimated separately for groups distinguished by important values of
time-invariant predictors. For categorical predictors, each level of the
predictor can be used. For continuous predictors, the values can be
temporarily categorized for the purpose of display.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_haz</span> <span class="op">&lt;-</span> <span class="va">first_sex_lifetables</span><span class="op">$</span><span class="va">parental_transition</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, y <span class="op">=</span> <span class="va">haz.estimate</span>, colour <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_surv</span> <span class="op">&lt;-</span> <span class="va">first_sex_lifetables</span><span class="op">$</span><span class="va">parental_transition</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, grade <span class="op">=</span> <span class="fl">6</span>, surv.estimate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, y <span class="op">=</span> <span class="va">surv.estimate</span>, colour <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.25</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 11.1, page 359:</span></span>
<span><span class="va">first_sex_haz</span> <span class="op">/</span> <span class="va">first_sex_surv</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Singer and Willett (2003) identify two major questions that are
helpful to answer when examining plots like these to aid model
specification:</p>
<ul>
<li>
<strong>What is the shape of the hazard function for each
group?</strong>
<ul>
<li>When are the peaks and troughs?</li>
<li>Do the peaks and troughs occur at similar or different times for
each group?</li>
</ul>
</li>
<li>
<strong>Does the relative level of the hazard function differ across
groups?</strong>
<ul>
<li>Is the hazard function for one group consistently higher than for
the other(s)?</li>
<li>Is the relative magnitude of the differential in hazard between
groups consistent over time, or does it vary over time?</li>
</ul>
</li>
</ul>
<p>For the <code>first_sex</code> data, the shape of the hazard
functions are similar for each group—with both groups having a trough at
the “beginning of time”, a peak at the “end of time”, and smaller
period-by-period variations in between. Additionally, boys who
experienced a parenting transition had a consistently and substantially
higher conditional probability of first sexual intercourse than boys who
did not, although the relative magnitude of their differential varied
somewhat across periods.</p>
</div>
<div class="section level3">
<h3 id="what-kind-of-statistical-model-do-these-plots-suggest">What kind of statistical model do these plots suggest?<a class="anchor" aria-label="anchor" href="#what-kind-of-statistical-model-do-these-plots-suggest"></a>
</h3>
<p>In specifying a suitable statistical model to represent the
relationship between the population discrete-time hazard function and
predictors, there are two complications we must deal with:</p>
<ul>
<li>The model must respect the bounded nature of the hazard probability,
precluding impossible values outside the 0-1 range.</li>
<li>The model must describe the shape of the entire discrete-time hazard
function over time.</li>
</ul>
<p>As Singer and Willett (2003) discuss, different strategies are
required to address each of these constraints.</p>
<div class="section level4">
<h4 id="the-bounded-nature-of-hazard">The bounded nature of hazard<a class="anchor" aria-label="anchor" href="#the-bounded-nature-of-hazard"></a>
</h4>
<p>For the bounded values, we can either fit a linear model with
<strong>transformed hazard probabilities</strong> on the <strong>log
odds</strong> (aka <strong>logit</strong>) scale as the outcome
variable, or fit a <strong>logistic regression</strong> model with
<strong>logit-linked</strong> event status as the outcome variable. In
this section we proceed with the linear model approach, which serves to
motivate our final choice of logistic regression as the basis for
discrete-time hazard models. As Rönkkö, Aalto, Tenhunen, and
Aguirre-Urreta (2022) discuss, conceptually, these two approaches are
interchangeable; however, we prefer a generalized linear model over
manual transformation because the former has superior statistical
properties, as well as practical advantages when it comes to tasks such
as plotting predictions.</p>
<p>Here we will fit three linear models to the <code>first_sex</code>
parental transition life tables, which represent either hazard
<em>probability</em>, <em>odds</em>, or <em>log_odds</em> as a function
of the predictors <code>grade</code> and
<code>parental_transition</code>. After fitting these models, we will
plot each of their estimated within-group functions on the probability
scale to demonstrate that both the probability and odds representations
of the outcome can lead to impossible (i.e., negative) predicted
values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define transformation functions ---------------------------------------------</span></span>
<span><span class="va">odds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="va">odds_inv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_odds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log_odds_inv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">first_sex_fit_haz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">haz.estimate</span> <span class="op">~</span> <span class="va">grade</span> <span class="op">+</span> <span class="va">parental_transition</span>,</span>
<span>  data <span class="op">=</span> <span class="va">first_sex_lifetables</span><span class="op">$</span><span class="va">parental_transition</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fit_odds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">first_sex_fit_haz</span>,</span>
<span>  <span class="fu">odds</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fit_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">first_sex_fit_haz</span>,</span>
<span>  <span class="fu">log_odds</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fits_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  haz <span class="op">=</span> <span class="va">first_sex_fit_haz</span>,</span>
<span>  odds <span class="op">=</span> <span class="va">first_sex_fit_odds</span>,</span>
<span>  log_odds <span class="op">=</span> <span class="va">first_sex_fit_logit</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions ------------------------------------------------------------</span></span>
<span><span class="va">first_sex_preds_lm</span> <span class="op">&lt;-</span> <span class="va">first_sex_fits_lm</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">augment</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"outcome"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span>,</span>
<span>    outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">outcome</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"haz"</span>, <span class="st">"odds"</span>, <span class="st">"log_odds"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html" class="external-link">coalesce</a></span><span class="op">(</span></span>
<span>      <span class="va">haz.estimate</span>, <span class="va">`odds(haz.estimate)`</span>, <span class="va">`log_odds(haz.estimate)`</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">.fitted</span><span class="op">)</span>,</span>
<span>      \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>          <span class="va">outcome</span> <span class="op">==</span> <span class="st">"haz"</span> <span class="op">~</span> <span class="va">.x</span>,</span>
<span>          <span class="va">outcome</span> <span class="op">==</span> <span class="st">"odds"</span> <span class="op">~</span> <span class="fu">odds_inv</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,</span>
<span>          <span class="va">outcome</span> <span class="op">==</span> <span class="st">"log_odds"</span> <span class="op">~</span> <span class="fu">log_odds_inv</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,</span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot ------------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">first_sex_preds_lm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, colour <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.25</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Another important property of the logit-transformed hazard is that it
stabilizes the gap between the two within-group functions over time,
facilitating comparison and modelling. Again, the effect of transforming
the hazard probabilities can be appreciated by plotting them on
different scales. Here we transform the estimated hazard probabilities
from the <code>first_sex</code> parental transition life tables to
<em>odds</em> and <em>log odds</em>, exploring how each transformation
affects the shapes and levels of the within-group functions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_haz</span> <span class="op">&lt;-</span> <span class="va">first_sex_haz</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_odds</span> <span class="op">&lt;-</span> <span class="va">first_sex_haz</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu">odds</span><span class="op">(</span><span class="va">haz.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"odds.estimate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_logit</span> <span class="op">&lt;-</span> <span class="va">first_sex_haz</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu">log_odds</span><span class="op">(</span><span class="va">haz.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"log_odds.estimate"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 11.2, page 363:</span></span>
<span><span class="va">first_sex_haz</span> <span class="op">+</span> <span class="va">first_sex_odds</span> <span class="op">+</span> <span class="va">first_sex_logit</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="the-shape-of-the-hazard-function">The shape of the hazard function<a class="anchor" aria-label="anchor" href="#the-shape-of-the-hazard-function"></a>
</h4>
<p>For the shape of the discrete-time hazard function, although there is
no single and uniquely suitable functional form, we typically begin with
a <strong>completely general</strong> functional form that places no
constraints on the shape of the hazard function over time before
considering more constrained representations.</p>
<p>Here we will fit three logistic regression models to the
<code>first_sex_pp</code> person-period data set: A model where logit
hazard is horizontal with time, achieved by excluding a time predictor;
a model where logit hazard is linear with time, via the slope of the
<code>grade</code> predictor; and a model where logit hazard is
completely general with time, achieved by transforming
<code>grade</code> into a factor. Note that the purpose of this example
is purely on visualizing potential functional forms for the
discrete-time hazard model—rather than specification and fitting of the
discrete-time hazard model—and similar trajectories would be obtained
had we fit three linear models with logit-transformed outcomes
instead.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">first_sex_fit_horizontal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span></span>
<span>  <span class="va">event</span> <span class="op">~</span> <span class="va">parental_transition</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">first_sex_pp</span></span>
<span><span class="op">)</span></span>
<span><span class="va">first_sex_fit_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">first_sex_fit_horizontal</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">grade</span><span class="op">)</span></span>
<span><span class="va">first_sex_fit_general</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">first_sex_fit_horizontal</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grade</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fits_funcform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  horizontal <span class="op">=</span> <span class="va">first_sex_fit_horizontal</span>,</span>
<span>  linear <span class="op">=</span> <span class="va">first_sex_fit_linear</span>,</span>
<span>  general <span class="op">=</span> <span class="va">first_sex_fit_general</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions ------------------------------------------------------------</span></span>
<span><span class="va">first_sex_preds_funcform</span> <span class="op">&lt;-</span> <span class="va">first_sex_fits_funcform</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">.x</span>, newdata <span class="op">=</span> <span class="va">first_sex_pp</span>, type.predict <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"form"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    form <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">form</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"horizontal"</span>, <span class="st">"linear"</span>, <span class="st">"general"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Figure 11.3, page 366:</span></span>
<span><span class="va">first_sex_preds_funcform</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, colour <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">log_odds.estimate</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        <span class="va">first_sex_lifetables</span><span class="op">$</span><span class="va">parental_transition</span>,</span>
<span>        parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span>,</span>
<span>        log_odds.estimate <span class="op">=</span> <span class="fu">log_odds</span><span class="op">(</span><span class="va">haz.estimate</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">form</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Singer and Willett (2003) identify three assumptions highlighted in
these plots that are inherent to basic discrete-time hazard models,
regardless of their functional form:</p>
<ul>
<li>There is a postulated logit hazard function for each value of the
predictor (or for each combination of predictor levels for models with
more than one predictor).</li>
<li>The postulated logit hazard functions have an identical shape for
all predictor values.</li>
<li>The postulated logit hazard functions have an identical distance
between them in every time period.</li>
</ul>
<p>Thus, conceptually, the basic discrete-time hazard model postulates
that the effect of a predictor is to “shift” one entire logit hazard
function vertically relative to the other, which represents a baseline
profile of risk.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="a-formal-representation-of-the-population-discrete-time-hazard-model">11.2 A formal representation of the population discrete-time hazard
model<a class="anchor" aria-label="anchor" href="#a-formal-representation-of-the-population-discrete-time-hazard-model"></a>
</h2>
<p>In Section 11.2 Singer and Willett (2003) delve into the
specification and interpretation of the basic <strong>population
discrete-time hazard model</strong>.</p>
<p>We begin by expanding the definition of the discrete-time hazard
function introduced in Section 10.2, <span class="math inline">\(h(t_{ij}) = \Pr[T_i = j \mid T \geq j]\)</span>,
to consider that the population value of hazard for the <span class="math inline">\(i\)</span>th individual in the <span class="math inline">\(j\)</span>th time period depends upon their vector
of values, <span class="math inline">\(x_{ij} = [x_{1ij}, x_{2ij},
\dots, x_{Pij}]\)</span>, for the <span class="math inline">\(P\)</span>
predictors:</p>
<p><span class="math display">\[
h(t_{ij}) = \Pr [T_i = j \mid T \geq j \text{ and } X_{1ij} = x_{1ij},
X_{2ij} = x_{2ij}, \dots, X_{Pij} = x_{Pij}],
\]</span></p>
<p>without specifying the functional form of that dependence.</p>
<p>Because the discrete-time hazard functions are probabilities, they
can be reparameterized so that they have a logistic dependence on the
<span class="math inline">\(P\)</span> predictors and the <span class="math inline">\(J\)</span> time periods:</p>
<p><span class="math display">\[
h(t_{ij}) = \frac{1}{1 + e^{-([\alpha_1 D_{1ij} + \alpha_2 D_{2ij} +
\cdots + \alpha_J D_{Jij}] + [\beta_1 X_{1ij} + \beta_2 X_{2ij} + \cdots
+ \beta_P X_{Pij}])}},
\]</span></p>
<p>where <span class="math inline">\([D_{1ij}, D_{2ij}, \dots,
D_{Jij}]\)</span> are a sequence of dummy variables acting as
<strong>discrete-time indicators</strong>, with values <span class="math inline">\([d_{1ij}, d_{2ij}, \dots, d_{Jij}]\)</span>
indexing the <span class="math inline">\(J\)</span> time periods.</p>
<p>Applying an inverse transformation to both sides of the equation, we
can see that the intercept parameters <span class="math inline">\([\alpha_1, \alpha_2, \dots, \alpha_J]\)</span>
represent the baseline level of logit hazard in each time period, and
the slope parameters <span class="math inline">\([\beta_1, \beta_2,
\dots, \beta_P]\)</span> represent the effects of the predictors on the
baseline hazard function:</p>
<p><span class="math display">\[
\operatorname{logit} h(t_{ij}) = [\alpha_1 D_{1ij} + \alpha_2 D_{2ij} +
\cdots + \alpha_J D_{Jij}] + [\beta_1 X_{1ij} + \beta_2 X_{2ij} + \cdots
+ \beta_P X_{Pij}],
\]</span></p>
<p>where <span class="math inline">\(\operatorname{logit}\)</span> is
the logit <strong>link function</strong> that transforms the expected
value of the hazard.</p>
<p>As Singer and Willett (1993, 2003) discuss, these expressions of the
basic population discrete-time hazard model clarify that we assume:</p>
<ul>
<li>A <strong>linear relationship</strong> between predictors and
<em>logit hazard</em>.</li>
<li>A <strong>proportional relationship</strong> between predictors and
<em>odds</em>.</li>
<li>A <strong>nonlinear relationship</strong> between predictors and
<em>raw hazard</em>.</li>
</ul>
<p>We can see how these relationships manifest themselves by plotting
the predicted within-group functions of the
<code>first_sex_fit_general</code> model—which follows the specification
of the basic population discrete-time hazard model described above—on
the log odds, odds, and raw hazard (probability) scales.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcome_scales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>log_odds <span class="op">=</span> <span class="st">"link"</span>, odds <span class="op">=</span> <span class="st">"odds"</span>, hazard <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fit_general_preds</span> <span class="op">&lt;-</span> <span class="va">outcome_scales</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.predict</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">first_sex_fit_general</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span></span>
<span>          newdata <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span>grade <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>, parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          type.predict <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">.predict</span> <span class="op">!=</span> <span class="st">"odds"</span>, <span class="va">.predict</span>, <span class="st">"response"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>          .fitted <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">.predict</span> <span class="op">!=</span> <span class="st">"odds"</span><span class="op">)</span> <span class="va">.fitted</span> <span class="kw">else</span> <span class="fu">odds</span><span class="op">(</span><span class="va">.fitted</span><span class="op">)</span>,</span>
<span>          parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"scale"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">scale</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log_odds"</span>, <span class="st">"odds"</span>, <span class="st">"hazard"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 11.4, page 374:</span></span>
<span><span class="va">first_sex_fit_general_preds</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, y <span class="op">=</span> <span class="va">.fitted</span>, colour <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">scale</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Because the basic discrete-time hazard model has no simple
corresponding interpretation for the relationship between raw hazard and
predictors, Singer and Willett (2003) recommend plotting within-group
functions not just on the hazard scale, but also the odds and log odds
scales to develop when conducting analyses.</p>
</div>
<div class="section level2">
<h2 id="fitting-a-discrete-time-hazard-model-to-data">11.3 Fitting a discrete-time hazard model to data<a class="anchor" aria-label="anchor" href="#fitting-a-discrete-time-hazard-model-to-data"></a>
</h2>
<p>In Section 11.3 Singer and Willett (2003) demonstrate how the basic
discrete-time hazard model can be fit using logistic regression on the
person-period data set by simply regressing the event-indicator
variable, <code>event</code>, on the discrete-time indicator variables
and any substantive predictors.</p>
<p>In short, this approach is possible because of an equivalence between
discrete-time and independent Bernoulli likelihood functions, which
allows maximum likelihood estimates of the discrete-time hazard model’s
intercept parameters <span class="math inline">\([\alpha_1, \alpha_2,
\dots, \alpha_J]\)</span> and slope parameters <span class="math inline">\([\beta_1, \beta_2, \dots, \beta_P]\)</span>—and
therefore the hazard probability, <span class="math inline">\(h(t_{ij})\)</span>—to be obtained by appropriately
applying standard logistic regression routines to the person-period data
set.</p>
<p>For this example, we return to the <code>first_sex_pp</code>
person-period data set created in Section 11.1.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_pp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 822 × 5</span></span></span>
<span><span class="co">#&gt;    id    grade event parental_transition parental_antisociality</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         7     0                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         8     0                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         9     1                   0                  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2         7     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2         8     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2         9     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2        10     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2        11     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2        12     0                   1                 -<span style="color: #BB0000;">0.545</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3         7     0                   0                 -<span style="color: #BB0000;">1.40</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 812 more rows</span></span></span></code></pre></div>
<p>Here we will fit four discrete-time hazard models to the
<code>first_sex_pp</code> data: A model including only the main effect
of <code>grade</code>, which we give a completely general functional
form by treating <code>grade</code> as a factor (Model A); a model
including the main effects of <code>grade</code> and
<code>parental_transition</code> (Model B); a model including the main
effects of <code>grade</code> and <code>parental_antisociality</code>
(Model C); and a model including the main effects of <code>grade</code>,
<code>parental_transition</code>, and
<code>parental_antisociality</code> (Model D).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">first_sex_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span></span>
<span>  <span class="va">event</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grade</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">first_sex_pp</span></span>
<span><span class="op">)</span></span>
<span><span class="va">first_sex_fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">first_sex_fit_A</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">parental_transition</span><span class="op">)</span></span>
<span><span class="va">first_sex_fit_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">first_sex_fit_A</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">parental_antisociality</span><span class="op">)</span></span>
<span><span class="va">first_sex_fit_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">first_sex_fit_B</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">parental_antisociality</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Model A"</span> <span class="op">=</span> <span class="va">first_sex_fit_A</span>,</span>
<span>  <span class="st">"Model B"</span> <span class="op">=</span> <span class="va">first_sex_fit_B</span>,</span>
<span>  <span class="st">"Model C"</span> <span class="op">=</span> <span class="va">first_sex_fit_C</span>,</span>
<span>  <span class="st">"Model D"</span> <span class="op">=</span> <span class="va">first_sex_fit_D</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>modelsummary_get <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 11.3, page 386:</span></span>
<span><span class="va">first_sex_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    fmt <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    coef_rename <span class="op">=</span> \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://modelsummary.com/man/coef_rename.html" class="external-link">coef_rename</a></span><span class="op">(</span><span class="va">.x</span>, factor_name <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logLik"</span>, <span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model D">Model D</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers=" " class="gt_row gt_left">Grade 7</td>
<td headers="Model A" class="gt_row gt_center">-2.3979</td>
<td headers="Model B" class="gt_row gt_center">-2.9943</td>
<td headers="Model C" class="gt_row gt_center">-2.4646</td>
<td headers="Model D" class="gt_row gt_center">-2.8932</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center">(0.2697)</td>
<td headers="Model B" class="gt_row gt_center">(0.3175)</td>
<td headers="Model C" class="gt_row gt_center">(0.2741)</td>
<td headers="Model D" class="gt_row gt_center">(0.3206)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Grade 8</td>
<td headers="Model A" class="gt_row gt_center">-3.1167</td>
<td headers="Model B" class="gt_row gt_center">-3.7001</td>
<td headers="Model C" class="gt_row gt_center">-3.1591</td>
<td headers="Model D" class="gt_row gt_center">-3.5848</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center">(0.3862)</td>
<td headers="Model B" class="gt_row gt_center">(0.4205)</td>
<td headers="Model C" class="gt_row gt_center">(0.3889)</td>
<td headers="Model D" class="gt_row gt_center">(0.4230)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Grade 9</td>
<td headers="Model A" class="gt_row gt_center">-1.7198</td>
<td headers="Model B" class="gt_row gt_center">-2.2811</td>
<td headers="Model C" class="gt_row gt_center">-1.7297</td>
<td headers="Model D" class="gt_row gt_center">-2.1502</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center">(0.2217)</td>
<td headers="Model B" class="gt_row gt_center">(0.2724)</td>
<td headers="Model C" class="gt_row gt_center">(0.2245)</td>
<td headers="Model D" class="gt_row gt_center">(0.2775)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Grade 10</td>
<td headers="Model A" class="gt_row gt_center">-1.2867</td>
<td headers="Model B" class="gt_row gt_center">-1.8226</td>
<td headers="Model C" class="gt_row gt_center">-1.2851</td>
<td headers="Model D" class="gt_row gt_center">-1.6932</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center">(0.2098)</td>
<td headers="Model B" class="gt_row gt_center">(0.2585)</td>
<td headers="Model C" class="gt_row gt_center">(0.2127)</td>
<td headers="Model D" class="gt_row gt_center">(0.2646)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Grade 11</td>
<td headers="Model A" class="gt_row gt_center">-1.1632</td>
<td headers="Model B" class="gt_row gt_center">-1.6542</td>
<td headers="Model C" class="gt_row gt_center">-1.1360</td>
<td headers="Model D" class="gt_row gt_center">-1.5177</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center">(0.2291)</td>
<td headers="Model B" class="gt_row gt_center">(0.2691)</td>
<td headers="Model C" class="gt_row gt_center">(0.2324)</td>
<td headers="Model D" class="gt_row gt_center">(0.2757)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Grade 12</td>
<td headers="Model A" class="gt_row gt_center">-0.7309</td>
<td headers="Model B" class="gt_row gt_center">-1.1791</td>
<td headers="Model C" class="gt_row gt_center">-0.6421</td>
<td headers="Model D" class="gt_row gt_center">-1.0099</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center">(0.2387)</td>
<td headers="Model B" class="gt_row gt_center">(0.2716)</td>
<td headers="Model C" class="gt_row gt_center">(0.2428)</td>
<td headers="Model D" class="gt_row gt_center">(0.2811)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Parental Transition</td>
<td headers="Model A" class="gt_row gt_center"></td>
<td headers="Model B" class="gt_row gt_center">0.8736</td>
<td headers="Model C" class="gt_row gt_center"></td>
<td headers="Model D" class="gt_row gt_center">0.6605</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left"></td>
<td headers="Model A" class="gt_row gt_center"></td>
<td headers="Model B" class="gt_row gt_center">(0.2174)</td>
<td headers="Model C" class="gt_row gt_center"></td>
<td headers="Model D" class="gt_row gt_center">(0.2367)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Parental Antisociality</td>
<td headers="Model A" class="gt_row gt_center"></td>
<td headers="Model B" class="gt_row gt_center"></td>
<td headers="Model C" class="gt_row gt_center">0.4428</td>
<td headers="Model D" class="gt_row gt_center">0.2964</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.1140)</td>
<td headers="Model D" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.1254)</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Log.Lik.</td>
<td headers="Model A" class="gt_row gt_center">-325.978</td>
<td headers="Model B" class="gt_row gt_center">-317.331</td>
<td headers="Model C" class="gt_row gt_center">-318.584</td>
<td headers="Model D" class="gt_row gt_center">-314.573</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">Deviance</td>
<td headers="Model A" class="gt_row gt_center">651.96</td>
<td headers="Model B" class="gt_row gt_center">634.66</td>
<td headers="Model C" class="gt_row gt_center">637.17</td>
<td headers="Model D" class="gt_row gt_center">629.15</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">AIC</td>
<td headers="Model A" class="gt_row gt_center">664.0</td>
<td headers="Model B" class="gt_row gt_center">648.7</td>
<td headers="Model C" class="gt_row gt_center">651.2</td>
<td headers="Model D" class="gt_row gt_center">645.1</td>
</tr>
<tr>
<td headers=" " class="gt_row gt_left">BIC</td>
<td headers="Model A" class="gt_row gt_center">692.2</td>
<td headers="Model B" class="gt_row gt_center">681.6</td>
<td headers="Model C" class="gt_row gt_center">684.2</td>
<td headers="Model D" class="gt_row gt_center">682.8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-parameter-estimates">11.4 Interpreting parameter estimates<a class="anchor" aria-label="anchor" href="#interpreting-parameter-estimates"></a>
</h2>
<p>In Section 11.4 Singer and Willett (2003) discuss how to interpret
intercept and slope parameter estimates for the basic discrete-time
hazard model.</p>
<div class="section level3">
<h3 id="interpreting-intercept-parameter-estimates">Interpreting intercept parameter estimates<a class="anchor" aria-label="anchor" href="#interpreting-intercept-parameter-estimates"></a>
</h3>
<p>Collectively, the intercept parameters <span class="math inline">\([\alpha_1, \alpha_2, \dots, \alpha_J]\)</span> are
maximum likelihood estimates of the baseline logit hazard function,
where the baseline group represents those individuals for whom every
predictor in the model takes on the value 0. The shape of the baseline
logit hazard function—and whether risk increases, decreases, or remains
steady over time—is reflected in the amount and direction of variation
in the values of the intercept parameters.</p>
<p>To facilitate interpretation, the baseline logit hazard function
estimates can be transformed to the odds or hazard scales, yielding
baseline odds function estimates or baseline hazard function estimates,
respectively. We demonstrate this here by transforming the intercept
parameter estimates of Model A to both scales.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 11.4, page 388:</span></span>
<span><span class="va">first_sex_fit_A</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">term</span>, log_odds <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    odds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_odds</span><span class="op">)</span>,</span>
<span>    hazard <span class="op">=</span> <span class="fu">log_odds_inv</span><span class="op">(</span><span class="va">log_odds</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   term            log_odds   odds hazard</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> factor(grade)7    -<span style="color: #BB0000;">2.40</span>  0.090<span style="text-decoration: underline;">9</span> 0.083<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> factor(grade)8    -<span style="color: #BB0000;">3.12</span>  0.044<span style="text-decoration: underline;">3</span> 0.042<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> factor(grade)9    -<span style="color: #BB0000;">1.72</span>  0.179  0.152 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> factor(grade)10   -<span style="color: #BB0000;">1.29</span>  0.276  0.216 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> factor(grade)11   -<span style="color: #BB0000;">1.16</span>  0.313  0.238 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> factor(grade)12   -<span style="color: #BB0000;">0.731</span> 0.481  0.325</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-slope-parameter-estimates">Interpreting slope parameter estimates<a class="anchor" aria-label="anchor" href="#interpreting-slope-parameter-estimates"></a>
</h3>
<p>Interpretation of slope parameters <span class="math inline">\([\beta_1, \beta_2, \dots, \beta_P]\)</span>
depends on the type of predictor they represent:</p>
<ul>
<li>
<strong>Dichotomous predictors</strong> estimate the direction and
magnitude of vertical separation between the baseline logit hazard
function and the “treatment” logit hazard function on a logit
scale.</li>
<li>
<strong>Continuous predictors</strong> estimate the direction and
magnitude of vertical separation in logit hazard corresponding to a
1-unit difference in the predictor.</li>
<li>
<strong>Polytomous predictors</strong> estimate the direction and
magnitude of vertical separation between the baseline logit hazard
function and the “subgroup” logit hazard functions on a logit
scale.</li>
</ul>
<p>To facilitate interpretation of the slope parameters, Singer and
Willett (2003) suggest transforming them into an <strong>odds
ratio</strong>—the ratio of the odds of event occurrence between a
reference group for which the predictor takes on the value 0 and another
group for which the predictor takes on the value 1 (or some other
meaningful increment)—by anti-logging them. Note that this odds ratio
can also be re-expressed as an odds ratio where the <em>other group</em>
is the reference group by taking its reciprocal.</p>
<p>We demonstrate this approach by transforming the
<code>parental_transition</code> estimate of Model B, and the
<code>parental_antisociality</code> estimate of Model C, into odds
ratios.</p>
<p>First Model B. Because <code>parental_transition</code> is a
dichotomous predictor, it might make sense to examine the reference
group odds ratio and the reciprocal odds ratio.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parental_transition_or_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">first_sex_fit_B</span><span class="op">)</span><span class="op">[</span><span class="st">"parental_transition"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">parental_transition_or_1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">parental_transition_or_0</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds ratio"</span>, <span class="st">"reciprocal"</span><span class="op">)</span>,</span>
<span>  estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parental_transition_or_0</span>, <span class="va">parental_transition_or_1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   parental_transition estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> odds ratio             2.40 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> reciprocal             0.417</span></span></code></pre></div>
<p>Next Model C. Because <code>parental_antisociality</code> is a
continuous predictor, it might make sense to examine increments other
than 1, which we can do by multiplying the coefficient by the chosen
increment before anti-logging.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>one <span class="op">=</span> <span class="fl">1</span>, two <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.increment</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">first_sex_fit_C</span><span class="op">)</span><span class="op">[</span><span class="st">"parental_antisociality"</span><span class="op">]</span> <span class="op">*</span> <span class="va">.increment</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $one</span></span>
<span><span class="co">#&gt; parental_antisociality </span></span>
<span><span class="co">#&gt;               1.557061 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $two</span></span>
<span><span class="co">#&gt; parental_antisociality </span></span>
<span><span class="co">#&gt;               2.424439</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="displaying-fitted-hazard-and-survivor-functions">11.5 Displaying fitted hazard and survivor functions<a class="anchor" aria-label="anchor" href="#displaying-fitted-hazard-and-survivor-functions"></a>
</h2>
<p>In Section 11.5 Singer and Willett (2003) discuss strategies for
plotting fitted functions for <strong>prototypical individuals</strong>
to describe the results of model fitting, with prototypical values of
predictors selected using the same strategies presented for the
multilevel model for change in Chapter 4.</p>
<p>After selecting prototypical values of the predictors,
<strong>prototypical hazard functions</strong> and <strong>prototypical
survival functions</strong> can be derived from combinations of these
values by transforming model predictions to the probability (hazard)
scale, then computing the survivor functions using the hazard.</p>
<p>We begin by visualizing this process in tabular form—starting from
the intercept and slope parameter estimates of Model B, and ending in
the prototypical survival functions for adolescents who did and did not
experience a parental transition.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_first_sex_B</span> <span class="op">&lt;-</span> <span class="va">first_sex_fit_B</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span></span>
<span>    newdata <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span>grade <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>, parental_transition <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    type.predict <span class="op">=</span> <span class="st">"link"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>log_odds <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    hazard <span class="op">=</span> <span class="fu">log_odds_inv</span><span class="op">(</span><span class="va">log_odds</span><span class="op">)</span>,</span>
<span>    survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">hazard</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>grade <span class="op">=</span> <span class="fl">6</span>, parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, survival <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 11.5, page 392:</span></span>
<span><span class="va">prototypical_first_sex_B</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">grade</span> <span class="op">!=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">parental_transition</span>, values_from <span class="op">=</span> <span class="va">log_odds</span><span class="op">:</span><span class="va">survival</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep_at.html" class="external-link">discard_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">first_sex_fit_B</span><span class="op">)</span>, <span class="st">"parental_transition"</span><span class="op">)</span>,</span>
<span>    slope <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep_at.html" class="external-link">keep_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">first_sex_fit_B</span><span class="op">)</span>, <span class="st">"parental_transition"</span><span class="op">)</span>,</span>
<span>    .after <span class="op">=</span> <span class="va">grade</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   grade intercept slope log_odds_0 log_odds_1 hazard_0 hazard_1 survival_0</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     7     -<span style="color: #BB0000;">2.99</span> 0.874      -<span style="color: #BB0000;">2.99</span>     -<span style="color: #BB0000;">2.12</span>    0.047<span style="text-decoration: underline;">7</span>   0.107       0.952</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     8     -<span style="color: #BB0000;">3.70</span> 0.874      -<span style="color: #BB0000;">3.70</span>     -<span style="color: #BB0000;">2.83</span>    0.024<span style="text-decoration: underline;">1</span>   0.055<span style="text-decoration: underline;">9</span>      0.929</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     9     -<span style="color: #BB0000;">2.28</span> 0.874      -<span style="color: #BB0000;">2.28</span>     -<span style="color: #BB0000;">1.41</span>    0.092<span style="text-decoration: underline;">7</span>   0.197       0.843</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    10     -<span style="color: #BB0000;">1.82</span> 0.874      -<span style="color: #BB0000;">1.82</span>     -<span style="color: #BB0000;">0.949</span>   0.139    0.279       0.726</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    11     -<span style="color: #BB0000;">1.65</span> 0.874      -<span style="color: #BB0000;">1.65</span>     -<span style="color: #BB0000;">0.781</span>   0.161    0.314       0.609</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    12     -<span style="color: #BB0000;">1.18</span> 0.874      -<span style="color: #BB0000;">1.18</span>     -<span style="color: #BB0000;">0.305</span>   0.235    0.424       0.466</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: survival_1 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Now we can plot the corresponding fitted functions for Model B.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_fit_B_logit</span> <span class="op">&lt;-</span> <span class="va">prototypical_first_sex_B</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, y <span class="op">=</span> <span class="va">log_odds</span>, colour <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fit_B_haz</span> <span class="op">&lt;-</span> <span class="va">first_sex_fit_B_logit</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">hazard</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fit_B_surv</span> <span class="op">&lt;-</span> <span class="va">first_sex_fit_B_logit</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">survival</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 11.6, page 393:</span></span>
<span><span class="va">first_sex_fit_B_logit</span> <span class="op">/</span> <span class="va">first_sex_fit_B_haz</span> <span class="op">/</span> <span class="va">first_sex_fit_B_surv</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>, axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>We can easily extend this approach to models involving multiple
predictors, such as Model D. To make predictions for the hazard
directly, we set the <code>type.predict</code> argument in the
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> function to <code>"response"</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_first_sex_D</span> <span class="op">&lt;-</span> <span class="va">first_sex_fit_D</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span></span>
<span>    type.predict <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>    newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>        grade <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>        parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        parental_antisociality <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>hazard <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">hazard</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>    grade <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    parental_antisociality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    survival <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    parental_transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_transition</span><span class="op">)</span>,</span>
<span>    parental_antisociality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">parental_antisociality</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">prototypical_first_sex_D</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 42 × 6</span></span></span>
<span><span class="co">#&gt;       id grade parental_transition parental_antisociality hazard survival</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     7 0                   -1                     0.039<span style="text-decoration: underline;">6</span>    0.960</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     7 0                   0                      0.052<span style="text-decoration: underline;">5</span>    0.910</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     7 0                   1                      0.069<span style="text-decoration: underline;">3</span>    0.847</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4     7 1                   -1                     0.073<span style="text-decoration: underline;">8</span>    0.926</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5     7 1                   0                      0.096<span style="text-decoration: underline;">9</span>    0.836</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6     7 1                   1                      0.126     0.731</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     8 0                   -1                     0.020<span style="text-decoration: underline;">2</span>    0.830</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     8 0                   0                      0.027<span style="text-decoration: underline;">0</span>    0.807</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     8 0                   1                      0.036<span style="text-decoration: underline;">0</span>    0.778</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     4     8 1                   -1                     0.038<span style="text-decoration: underline;">4</span>    0.703</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 32 more rows</span></span></span></code></pre></div>
<p>Now we can plot the corresponding fitted functions for Model D.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_fit_D_haz</span> <span class="op">&lt;-</span> <span class="va">prototypical_first_sex_D</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, y <span class="op">=</span> <span class="va">hazard</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">parental_antisociality</span>, linetype <span class="op">=</span> <span class="va">parental_transition</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"G"</span>, begin <span class="op">=</span> <span class="fl">.2</span>, end <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sex_fit_D_surv</span> <span class="op">&lt;-</span> <span class="va">first_sex_fit_D_haz</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">survival</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 11.7, page 395:</span></span>
<span><span class="va">first_sex_fit_D_haz</span> <span class="op">/</span> <span class="va">first_sex_fit_D_surv</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>, axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-11_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>When interpreting these plots, Singer and Willett (2003) advise two
points of caution:</p>
<ul>
<li>Do not incorrectly conclude that the predictors’ effects vary over
time. In survival analysis, a varying gap between fitted hazard
functions <em>does not</em> imply a statistical interaction.</li>
<li>Make it clear that these plots depict fitted hazard and survival
functions from a statistical model, <em>not</em> sample hazard and
survival functions from a life table.</li>
</ul>
</div>
<div class="section level2">
<h2 id="comparing-models-using-deviance-statistics-and-information-criteria">11.6 Comparing models using deviance statistics and information
criteria<a class="anchor" aria-label="anchor" href="#comparing-models-using-deviance-statistics-and-information-criteria"></a>
</h2>
<p>In Section 11.6 Singer and Willet (2003) discuss strategies for
comparing discrete-time hazard models using deviance statistics and
information criteria. In short, as in the case of the multilevel model
for change, we can select a “final” model from our taxonomy of models by
using <strong>likelihood ratio tests</strong> to compare the deviance
statistics between nested models, and AIC/BIC statistics between
non-nested models (in addition to using a combination of logic, theory,
and prior research).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sex_anovas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"parental_transition (uncontrolled effect)"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span></span>
<span>    <span class="va">first_sex_fit_A</span>, <span class="va">first_sex_fit_B</span>, test <span class="op">=</span> <span class="st">"LRT"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"parental_antisociality (uncontrolled effect)"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span></span>
<span>    <span class="va">first_sex_fit_A</span>, <span class="va">first_sex_fit_C</span>, test <span class="op">=</span> <span class="st">"LRT"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"parental_transition (controlled effect)"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span></span>
<span>    <span class="va">first_sex_fit_C</span>, <span class="va">first_sex_fit_D</span>, test <span class="op">=</span> <span class="st">"LRT"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"parental_antisociality (controlled effect)"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span></span>
<span>    <span class="va">first_sex_fit_B</span>, <span class="va">first_sex_fit_D</span>, test <span class="op">=</span> <span class="st">"LRT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 11.3, page 386 (bottom):</span></span>
<span><span class="va">first_sex_anovas</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">tidy</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    term <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"0 \\+|- 1"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df.residual</span>, <span class="va">df</span><span class="op">)</span>, <span class="va">as.integer</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"comparison"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/sub_missing.html" class="external-link">sub_missing</a></span><span class="op">(</span>missing_text <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div id="eexombwkke" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eexombwkke table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eexombwkke thead, #eexombwkke tbody, #eexombwkke tfoot, #eexombwkke tr, #eexombwkke td, #eexombwkke th {
  border-style: none;
}

#eexombwkke p {
  margin: 0;
  padding: 0;
}

#eexombwkke .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eexombwkke .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eexombwkke .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eexombwkke .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eexombwkke .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eexombwkke .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eexombwkke .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eexombwkke .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eexombwkke .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eexombwkke .gt_spanner_row {
  border-bottom-style: hidden;
}

#eexombwkke .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eexombwkke .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eexombwkke .gt_from_md > :first-child {
  margin-top: 0;
}

#eexombwkke .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eexombwkke .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eexombwkke .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eexombwkke .gt_row_group_first td {
  border-top-width: 2px;
}

#eexombwkke .gt_row_group_first th {
  border-top-width: 2px;
}

#eexombwkke .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eexombwkke .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eexombwkke .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_left {
  text-align: left;
}

#eexombwkke .gt_center {
  text-align: center;
}

#eexombwkke .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eexombwkke .gt_font_normal {
  font-weight: normal;
}

#eexombwkke .gt_font_bold {
  font-weight: bold;
}

#eexombwkke .gt_font_italic {
  font-style: italic;
}

#eexombwkke .gt_super {
  font-size: 65%;
}

#eexombwkke .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eexombwkke .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eexombwkke .gt_indent_1 {
  text-indent: 5px;
}

#eexombwkke .gt_indent_2 {
  text-indent: 10px;
}

#eexombwkke .gt_indent_3 {
  text-indent: 15px;
}

#eexombwkke .gt_indent_4 {
  text-indent: 20px;
}

#eexombwkke .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df.residual">df.residual</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="residual.deviance">residual.deviance</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="deviance">deviance</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="parental_transition (uncontrolled effect)">parental_transition (uncontrolled effect)</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="parental_transition (uncontrolled effect)  term" class="gt_row gt_left">event ~  factor(grade)</td>
<td headers="parental_transition (uncontrolled effect)  df.residual" class="gt_row gt_right">816</td>
<td headers="parental_transition (uncontrolled effect)  residual.deviance" class="gt_row gt_right">651.96</td>
<td headers="parental_transition (uncontrolled effect)  df" class="gt_row gt_right"><br></td>
<td headers="parental_transition (uncontrolled effect)  deviance" class="gt_row gt_right"><br></td>
<td headers="parental_transition (uncontrolled effect)  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="parental_transition (uncontrolled effect)  term" class="gt_row gt_left">event ~ factor(grade) + parental_transition </td>
<td headers="parental_transition (uncontrolled effect)  df.residual" class="gt_row gt_right">815</td>
<td headers="parental_transition (uncontrolled effect)  residual.deviance" class="gt_row gt_right">634.66</td>
<td headers="parental_transition (uncontrolled effect)  df" class="gt_row gt_right">1</td>
<td headers="parental_transition (uncontrolled effect)  deviance" class="gt_row gt_right">17.29</td>
<td headers="parental_transition (uncontrolled effect)  p.value" class="gt_row gt_right">0.00</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="parental_antisociality (uncontrolled effect)">parental_antisociality (uncontrolled effect)</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="parental_antisociality (uncontrolled effect)  term" class="gt_row gt_left">event ~  factor(grade)</td>
<td headers="parental_antisociality (uncontrolled effect)  df.residual" class="gt_row gt_right">816</td>
<td headers="parental_antisociality (uncontrolled effect)  residual.deviance" class="gt_row gt_right">651.96</td>
<td headers="parental_antisociality (uncontrolled effect)  df" class="gt_row gt_right"><br></td>
<td headers="parental_antisociality (uncontrolled effect)  deviance" class="gt_row gt_right"><br></td>
<td headers="parental_antisociality (uncontrolled effect)  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="parental_antisociality (uncontrolled effect)  term" class="gt_row gt_left">event ~ factor(grade) + parental_antisociality </td>
<td headers="parental_antisociality (uncontrolled effect)  df.residual" class="gt_row gt_right">815</td>
<td headers="parental_antisociality (uncontrolled effect)  residual.deviance" class="gt_row gt_right">637.17</td>
<td headers="parental_antisociality (uncontrolled effect)  df" class="gt_row gt_right">1</td>
<td headers="parental_antisociality (uncontrolled effect)  deviance" class="gt_row gt_right">14.79</td>
<td headers="parental_antisociality (uncontrolled effect)  p.value" class="gt_row gt_right">0.00</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="parental_transition (controlled effect)">parental_transition (controlled effect)</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="parental_transition (controlled effect)  term" class="gt_row gt_left">event ~ factor(grade) + parental_antisociality </td>
<td headers="parental_transition (controlled effect)  df.residual" class="gt_row gt_right">815</td>
<td headers="parental_transition (controlled effect)  residual.deviance" class="gt_row gt_right">637.17</td>
<td headers="parental_transition (controlled effect)  df" class="gt_row gt_right"><br></td>
<td headers="parental_transition (controlled effect)  deviance" class="gt_row gt_right"><br></td>
<td headers="parental_transition (controlled effect)  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="parental_transition (controlled effect)  term" class="gt_row gt_left">event ~ factor(grade) + parental_transition + parental_antisociality </td>
<td headers="parental_transition (controlled effect)  df.residual" class="gt_row gt_right">814</td>
<td headers="parental_transition (controlled effect)  residual.deviance" class="gt_row gt_right">629.15</td>
<td headers="parental_transition (controlled effect)  df" class="gt_row gt_right">1</td>
<td headers="parental_transition (controlled effect)  deviance" class="gt_row gt_right">8.02</td>
<td headers="parental_transition (controlled effect)  p.value" class="gt_row gt_right">0.00</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="parental_antisociality (controlled effect)">parental_antisociality (controlled effect)</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="parental_antisociality (controlled effect)  term" class="gt_row gt_left">event ~ factor(grade) + parental_transition </td>
<td headers="parental_antisociality (controlled effect)  df.residual" class="gt_row gt_right">815</td>
<td headers="parental_antisociality (controlled effect)  residual.deviance" class="gt_row gt_right">634.66</td>
<td headers="parental_antisociality (controlled effect)  df" class="gt_row gt_right"><br></td>
<td headers="parental_antisociality (controlled effect)  deviance" class="gt_row gt_right"><br></td>
<td headers="parental_antisociality (controlled effect)  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="parental_antisociality (controlled effect)  term" class="gt_row gt_left">event ~ factor(grade) + parental_transition + parental_antisociality </td>
<td headers="parental_antisociality (controlled effect)  df.residual" class="gt_row gt_right">814</td>
<td headers="parental_antisociality (controlled effect)  residual.deviance" class="gt_row gt_right">629.15</td>
<td headers="parental_antisociality (controlled effect)  df" class="gt_row gt_right">1</td>
<td headers="parental_antisociality (controlled effect)  deviance" class="gt_row gt_right">5.51</td>
<td headers="parental_antisociality (controlled effect)  p.value" class="gt_row gt_right">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael McCarthy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
