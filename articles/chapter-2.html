<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2: Exploring longitudinal data on change • alda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 2: Exploring longitudinal data on change">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">alda</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tips-tricks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tips &amp; Tricks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tips-tricks">
<li><a class="dropdown-item" href="../articles/longitudinal-data-organization.html">Longitudinal data organization</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-textbook-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Textbook examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-textbook-examples">
<li><h6 class="dropdown-header" data-toc-skip>Longitudinal mixed effects modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-2.html">Chapter 2</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-3.html">Chapter 3</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-4.html">Chapter 4</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-5.html">Chapter 5</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-6.html">Chapter 6</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-7.html">Chapter 7</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Longitudinal structural equation modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-8.html">Chapter 8</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Survival analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-9.html">Chapter 9</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-10.html">Chapter 10</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-11.html">Chapter 11</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-12.html">Chapter 12</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-13.html">Chapter 13</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-14.html">Chapter 14</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-15.html">Chapter 15</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mccarthy-m-g/alda/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 2: Exploring longitudinal data on change</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mccarthy-m-g/alda/blob/main/vignettes/articles/chapter-2.Rmd" class="external-link"><code>vignettes/articles/chapter-2.Rmd</code></a></small>
      <div class="d-none name"><code>chapter-2.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mccarthy-m-g.github.io/alda/">alda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/corrr" class="external-link">corrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="creating-a-longitudinal-data-set">2.1 Creating a longitudinal data set<a class="anchor" aria-label="anchor" href="#creating-a-longitudinal-data-set"></a>
</h2>
<p>In Section 2.1 Singer and Willett (2003) introduce two distinct
formats of data organization for longitudinal data—the
<strong>person-level</strong> format and the
<strong>person-period</strong> format—using a subset of data from the
National Youth Survey (NYS) measuring the development of tolerance
towards deviant behaviour in adolescents over time in relation to
self-reported sex and exposure to deviant peers (Raudenbush &amp; Chan,
1992). Adolescents’ tolerance towards deviant behaviour was based on a
9-item scale measuring attitudes tolerant of deviant behaviour. The
scale was administered each year from age 11 to 15 and so is a
<strong>time-varying variable</strong>. However, adolescents’
self-reported sex and exposure to deviant peers were only recorded at
the beginning of the study period and so are <strong>time-invariant
variables</strong>.</p>
<p>For this example we illustrate the difference between the two formats
using the <code>deviant_tolerance_pl</code> and
<code>deviant_tolerance_pp</code> data sets, which correspond to the
adolescent tolerance of deviant behaviour data organized in the
person-level and person-period formats, respectively.</p>
<div class="section level3">
<h3 id="the-person-level-data-set">The person-Level data set<a class="anchor" aria-label="anchor" href="#the-person-level-data-set"></a>
</h3>
<p>In the person-level format (also known as <strong>wide</strong> or
<strong>multivariate</strong> format), each person has only one row of
data and multiple columns containing data from each measurement occasion
for any time-varying variables. This is demonstrated in the
<code>deviant_tolerance_pl</code> data set, a person-level data frame
with 16 rows and 8 columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>tolerance_11</code>, <code>tolerance_12</code>,
<code>tolerance_13</code>, <code>tolerance_14</code>,
<code>tolerance_15</code>: Average score across a 9-item scale assessing
attitudes favourable to deviant behaviour at ages 11, 12, 13, 14, and
15. Each item used a four point scale (1 = very wrong, 2 = wrong, 3 = a
little bit wrong, 4 = not wrong at all).</li>
<li>
<code>male</code>: Binary indicator for whether the adolescent is a
male.</li>
<li>
<code>exposure</code>: Average score across a 9-item scale assessing
level of exposure to deviant peers. Each item used a five point Likert
score (ranging from 0 = none, to 4 = all).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_pl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 8</span></span></span>
<span><span class="co">#&gt;    id    tolerance_11 tolerance_12 tolerance_13 tolerance_14 tolerance_15  male</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9             2.23         1.79         1.9          2.12         2.66     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 45            1.12         1.45         1.45         1.45         1.99     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 268           1.45         1.34         1.99         1.79         1.34     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 314           1.22         1.22         1.55         1.12         1.12     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 442           1.45         1.99         1.45         1.67         1.9      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 514           1.34         1.67         2.23         2.12         2.44     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 569           1.79         1.9          1.9          1.99         1.99     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 624           1.12         1.12         1.22         1.12         1.22     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 723           1.22         1.34         1.12         1            1.12     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 918           1            1            1.22         1.99         1.22     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 949           1.99         1.55         1.12         1.45         1.55     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 978           1.22         1.34         2.12         3.46         3.32     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 1105          1.34         1.9          1.99         1.9          2.12     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1542          1.22         1.22         1.99         1.79         2.12     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 1552          1            1.12         2.23         1.55         1.55     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 1653          1.11         1.11         1.34         1.55         2.12     0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: exposure &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Although the person-level format is common in cross-sectional
research, it has four disadvantages that make it ill-suited for
longitudinal data analysis:</p>
<ol style="list-style-type: decimal">
<li>It restricts data analysis to examining <em>rank order</em>
wave-to-wave relationships, leading to non-informative summaries that do
not tell us <em>how</em> each person changes over time, nor even the
<em>direction</em> of change.</li>
<li>It omits an explicit time-indicator variable, rendering time
<em>unavailable</em> for data analysis.</li>
<li>It requires adding an additional variable to the data set for each
unique measurement occasion, making it inefficient or useless when the
number or spacing of measurement occasions varies across
individuals.</li>
<li>It requires adding an additional <em>set</em> of columns for each
time-varying predictor (one column per measurement occasion), rendering
it unable to easily handle the presence of time-varying predictors.</li>
</ol>
<p>Singer and Willett (2003) exemplify the first of these disadvantages
by postulating how one might analyze the person-level tolerance towards
deviant behaviour data set. A natural approach would be to summarize the
wave-to-wave relationships among <code>tolerance_11</code> through
<code>tolerance_15</code> using bivariate correlations and bivariate
plots; however, doing so does not tell us anything about how adolescent
tolerance towards deviant behaviour changed over time for either
individuals or groups. Rather, the weak positive correlation between
measurement occasions merely tells us that the rank order of tolerance
towards deviant behaviour remained relatively stable across
occasions—that is, adolescents who were more tolerant towards deviant
behaviour at one measurement occasion tended to be more tolerant at the
next.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 2.1, page 20:</span></span>
<span><span class="va">deviant_tolerance_pl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"tolerance"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://corrr.tidymodels.org/reference/correlate.html" class="external-link">correlate</a></span><span class="op">(</span>diagonal <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://corrr.tidymodels.org/reference/shave.html" class="external-link">shave</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://corrr.tidymodels.org/reference/fashion.html" class="external-link">fashion</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           term tolerance_11 tolerance_12 tolerance_13 tolerance_14 tolerance_15</span></span>
<span><span class="co">#&gt; 1 tolerance_11         1.00                                                    </span></span>
<span><span class="co">#&gt; 2 tolerance_12          .66         1.00                                       </span></span>
<span><span class="co">#&gt; 3 tolerance_13          .06          .25         1.00                          </span></span>
<span><span class="co">#&gt; 4 tolerance_14          .14          .21          .59         1.00             </span></span>
<span><span class="co">#&gt; 5 tolerance_15          .26          .39          .57          .83         1.00</span></span></code></pre></div>
<p>The first disadvantage is also apparent when examining bivariate
plots between measurement occasions: There is again no way to tell how
adolescent tolerance towards deviant behaviour changed over time for
either individuals or groups. Moreover, because we lack an explicit
time-indicator variable, it isn’t possible to plot the person-level data
set in a more meaningful way, such as a time series plot organized by
<code>id</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_pl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"tolerance"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Considered together, these disadvantages make the person-level format
ill-suited for most longitudinal data analyses. Fortunately, each of the
disadvantages of the person-level format can be addressed by a simple
conversion to the person-period format.</p>
</div>
<div class="section level3">
<h3 id="the-person-period-data-set">The person-period data set<a class="anchor" aria-label="anchor" href="#the-person-period-data-set"></a>
</h3>
<p>In the person-period format (also known as <strong>long</strong> or
<strong>univariate</strong> format), each person has one row of data for
each measurement occasion, with a <strong>participant identifier
variable</strong> for each person, and a <strong>time-indicator
variable</strong> for each measurement occasion. In this format,
time-invariant variables have identical values across each measurement
occasion; whereas time-varying variables have potentially differing
values. This is demonstrated in the <code>deviant_tolerance_pp</code>
data set, a person-period data frame with 80 rows and 5 columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>age</code>: Adolescent age in years.</li>
<li>
<code>tolerance</code>: Average score across a 9-item scale
assessing attitudes favourable to deviant behaviour. Each item used a
four point scale (1 = very wrong, 2 = wrong, 3 = a little bit wrong, 4 =
not wrong at all).</li>
<li>
<code>male</code>: Binary indicator for whether the adolescent is a
male.</li>
<li>
<code>exposure</code>: Average score across a 9-item scale assessing
level of exposure to deviant peers. Each item used a five point Likert
score (ranging from 0 = none, to 4 = all).</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_pp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 80 × 5</span></span></span>
<span><span class="co">#&gt;    id      age tolerance  male exposure</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9        11      2.23     0     1.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 9        12      1.79     0     1.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 9        13      1.9      0     1.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 9        14      2.12     0     1.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 9        15      2.66     0     1.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 45       11      1.12     1     1.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 45       12      1.45     1     1.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 45       13      1.45     1     1.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 45       14      1.45     1     1.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 45       15      1.99     1     1.16</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 70 more rows</span></span></span></code></pre></div>
<p>Although the person-period data set contains the same information as
the person-level data set, its format for data organization makes it
more amenable to longitudinal data analysis, specifically:</p>
<ul>
<li>It includes an explicit participant identifier variable, enabling
the data to be sorted into person-specific subsets.</li>
<li>It includes an explicit time-indicator variable, rendering time
<em>available</em> for data analysis, and accommodating research designs
in which the number or spacing of measurement occasions varies across
individuals.</li>
<li>It needs only a <em>single</em> column for each variable in the data
set—whether time-varying or time-invariant, outcome or predictor—making
it trivial to handle any number of variables.</li>
</ul>
<p>Indeed, most R functions are designed to work with data in the
person-period format—which falls under the larger umbrella of the
<strong>tidy data</strong> format—due to R’s vectorized nature. As
Wickham, Çetinkaya-Rundel, and Grolemund (2023) explain, there are three
interrelated rules that make a data set tidy:</p>
<ol style="list-style-type: decimal">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ol>
<p>Thus, the person-period format is simply a special case of the tidy
data format, which distinguishes itself through its longitudinal nature
and requirements for explicit participant identifier and time-indicator
variables.</p>
</div>
<div class="section level3">
<h3 id="converting-between-person-level-and-person-period-data-sets">Converting between person-level and person-period data sets<a class="anchor" aria-label="anchor" href="#converting-between-person-level-and-person-period-data-sets"></a>
</h3>
<p>Unfortunately, longitudinal data is often initially stored as a
person-level data set, meaning that most real analyses will require at
least a little tidying to get your data into a person-period format.
There are a few reasons for this:</p>
<ul>
<li>Many people aren’t familiar with the principles of tidy data—nor its
special cases like the person person-period format—and it’s hard to
derive them yourself without spending a lot of time working with
longitudinal data.</li>
<li>The person-level format closely resembles the familiar
cross-sectional data-set format, making it a seemingly sensible default
for inexperienced analysts.</li>
<li>Data is often organized to facilitate non-analytical goals, such as
data entry, rather than data analysis.</li>
</ul>
<p>Thus, an essential skill for the aspiring longitudinal data analyst
is to be able to convert a person-level data set into a person-period
data set. The <strong>tidyr</strong> package provides two functions that
can easily convert a longitudinal data set from one format to the other:
<code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider()</a></code>.</p>
<p>To convert a person-level data set into a person-period data set use
<code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 2.1, page 18:</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>  <span class="va">deviant_tolerance_pl</span>,</span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"tolerance_"</span><span class="op">)</span>,</span>
<span>  names_to <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  names_prefix <span class="op">=</span> <span class="st">"tolerance_"</span>,</span>
<span>  names_transform <span class="op">=</span> <span class="va">as.integer</span>,</span>
<span>  values_to <span class="op">=</span> <span class="st">"tolerance"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 80 × 5</span></span></span>
<span><span class="co">#&gt;    id     male exposure   age tolerance</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9         0     1.54    11      2.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 9         0     1.54    12      1.79</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 9         0     1.54    13      1.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 9         0     1.54    14      2.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 9         0     1.54    15      2.66</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 45        1     1.16    11      1.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 45        1     1.16    12      1.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 45        1     1.16    13      1.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 45        1     1.16    14      1.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 45        1     1.16    15      1.99</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 70 more rows</span></span></span></code></pre></div>
<p>After the person-level data, there are five key arguments:</p>
<ul>
<li>
<code>cols</code> specifies which columns need to be pivoted into
longer format—for longitudinal data, this will always be the columns
corresponding to any time-varying variables. This argument uses
<strong>tidy selection</strong>, a small data science language for
selecting columns in a data frame (<code><a href="https://tidyr.tidyverse.org/reference/tidyr_tidy_select.html" class="external-link">?tidyr_tidy_select</a></code>),
making it simple to select each column of a time-varying variable based
on its naming pattern.</li>
<li>
<code>names_to</code> names the new column (or columns) to create
from the information stored in the column names specified by
<code>cols</code>. We named the new column <code>age</code>.</li>
<li>
<code>names_prefix</code> removes the matching text from the start
of each column name—for longitudinal data, this will always be the
prefix for any time-varying variables separating the variable name from
the measurement occasion. This argument uses a <strong>regular
expression</strong> to select the matching text.</li>
<li>
<code>names_transform</code> applies a function to the new column
(or columns). We converted the new column <code>age</code> from type
character to type integer.</li>
<li>
<code>values_to</code> names the new column (or columns) to create
from the data stored in cell values. We named the new column
<code>tolerance</code>.</li>
</ul>
<p>Note that <code>"age"</code> and <code>"tolerance"</code> are quoted
in the call to <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code> because they represent the
column names of the new variables we’re creating, rather than
already-existing variables in the data.</p>
<p>Although most longitudinal data analyses will begin by getting your
data into a person-period format, it can occasionally be useful to go in
the opposite direction. Some computations can be made easier using a
person-period data set, and certain functions and analyses expect a
person-period data set; therefore, it’s helpful to know how to untidy,
transform, and re-tidy your data as needed.</p>
<p>To convert a person-period data set to person-level data set use
<code>dplyr::pivot_wider()</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>  <span class="va">deviant_tolerance_pp</span>,</span>
<span>  names_from <span class="op">=</span> <span class="va">age</span>,</span>
<span>  names_prefix <span class="op">=</span> <span class="st">"tolerance_"</span>,</span>
<span>  values_from <span class="op">=</span> <span class="va">tolerance</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 8</span></span></span>
<span><span class="co">#&gt;    id     male exposure tolerance_11 tolerance_12 tolerance_13 tolerance_14</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9         0     1.54         2.23         1.79         1.9          2.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 45        1     1.16         1.12         1.45         1.45         1.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 268       1     0.9          1.45         1.34         1.99         1.79</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 314       0     0.81         1.22         1.22         1.55         1.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 442       0     1.13         1.45         1.99         1.45         1.67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 514       1     0.9          1.34         1.67         2.23         2.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 569       0     1.99         1.79         1.9          1.9          1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 624       1     0.98         1.12         1.12         1.22         1.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 723       0     0.81         1.22         1.34         1.12         1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 918       0     1.21         1            1            1.22         1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 949       1     0.93         1.99         1.55         1.12         1.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 978       1     1.59         1.22         1.34         2.12         3.46</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 1105      1     1.38         1.34         1.9          1.99         1.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1542      0     1.44         1.22         1.22         1.99         1.79</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 1552      0     1.04         1            1.12         2.23         1.55</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 1653      0     1.25         1.11         1.11         1.34         1.55</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: tolerance_15 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>After the person-period data, there are three key arguments:</p>
<ul>
<li>
<code>names_from</code> specifies which column (or columns) to get
the name of the output columns from—for longitudinal data, this will
always be the columns corresponding to any time-indicator
variables.</li>
<li>
<code>names_prefix</code> adds the specified string to the start of
each output column name—for longitudinal data, this will always be the
prefix for any time-varying variables separating the variable name from
the measurement occasion.</li>
<li>
<code>values_from</code> specifies which column (or columns) to get
the cell values from—for longitudinal data, this will always be the
columns corresponding to any time-varying variables.</li>
</ul>
<p>To learn more about the principles of tidy data and how pivoting
works, see the <a href="https://r4ds.hadley.nz/data-tidy" class="external-link">Data
Tidying</a> chapter of <a href="https://r4ds.hadley.nz" class="external-link">R for Data
Science</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="descriptive-analysis-of-individual-change-over-time">2.2 Descriptive analysis of individual change over time<a class="anchor" aria-label="anchor" href="#descriptive-analysis-of-individual-change-over-time"></a>
</h2>
<p>In Section 2.2 Singer and Willett (2003) use the
<code>deviant_tolerance_pp</code> data set to demonstrate how the
person-period format facilitates exploratory analyses that describe how
individuals in the data set change over time, revealing the nature and
idiosyncrasies of each person’s temporal pattern of change.</p>
<div class="section level3">
<h3 id="empirical-growth-plots">Empirical growth plots<a class="anchor" aria-label="anchor" href="#empirical-growth-plots"></a>
</h3>
<p><strong>Empirical growth plots</strong> show, for each individual,
the sequence of change in a time-varying variable. Here change can be
evaluated in either absolute terms against the scale of the variable of
interest, or in relative terms in comparison to other sample members.
Singer and Willett (2003) identify several questions that are helpful to
answer when examining empirical growth plots:</p>
<ul>
<li>Who is increasing?</li>
<li>Who is decreasing?</li>
<li>Who is increasing the most? The least?</li>
<li>Who is decreasing the most? The least?</li>
<li>Does anyone increase and then decrease?</li>
<li>Does anyone decrease and then increase?</li>
</ul>
<p>To construct an empirical growth plot with the
<strong>ggplot2</strong> package, put your time-indicator on the x-axis,
your time-varying variable on the y-axis, and facet each individual into
a separate panel.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 2.2, page 25:</span></span>
<span><span class="va">deviant_tolerance_empgrowth</span> <span class="op">&lt;-</span> <span class="va">deviant_tolerance_pp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">tolerance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deviant_tolerance_empgrowth</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>If your data set is large, Singer and Willett (2003) suggest
constructing empirical growth plots for a randomly selected a subsample
of individuals—perhaps stratified into groups defined by the values of
important predictors—rather than using the entire sample.</p>
<p>This task can be be easily accomplished using <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code>
function from the <strong>dplyr</strong> package prior to plotting. For
example, here we sample four random adolescents. Note the use of the
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> function prior to sampling, which sets the state
of R’s random number generator: we do this so that the results of the
random sample are reproducible.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deviant_tolerance_pp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;    id      age tolerance  male exposure</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 268      11      1.45     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 268      12      1.34     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 268      13      1.99     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 268      14      1.79     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 268      15      1.34     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 442      11      1.45     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 442      12      1.99     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 442      13      1.45     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 442      14      1.67     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 442      15      1.9      0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 569      11      1.79     0     1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 569      12      1.9      0     1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 569      13      1.9      0     1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 569      14      1.99     0     1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 569      15      1.99     0     1.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 1105     11      1.34     1     1.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 1105     12      1.9      1     1.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 1105     13      1.99     1     1.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 1105     14      1.9      1     1.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 1105     15      2.12     1     1.38</span></span></code></pre></div>
<p>This approach can also be extended to randomly select a subsample of
individuals within different strata by combining the
<code><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split()</a></code> function from the dplyr package to split the
data into a list of different groups, and the <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code>
function from the <strong>purrr</strong> package to apply the
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> call from the previous example to each group. For
example, here we sample two random adolescent males and two random
adolescent females, then combine the filtered data frames in the list
back together using the <code><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind()</a></code> function from the
purrr package.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deviant_tolerance_pp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.group</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.group</span>, <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;    id      age tolerance  male exposure</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 442      11      1.45     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 442      12      1.99     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 442      13      1.45     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 442      14      1.67     0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 442      15      1.9      0     1.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 918      11      1        0     1.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 918      12      1        0     1.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 918      13      1.22     0     1.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 918      14      1.99     0     1.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 918      15      1.22     0     1.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 268      11      1.45     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 268      12      1.34     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 268      13      1.99     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 268      14      1.79     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 268      15      1.34     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 514      11      1.34     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 514      12      1.67     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 514      13      2.23     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 514      14      2.12     1     0.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 514      15      2.44     1     0.9</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-a-trajectory-to-summarize-each-persons-empirical-growth-record">Using a trajectory to summarize each person’s empirical growth
record<a class="anchor" aria-label="anchor" href="#using-a-trajectory-to-summarize-each-persons-empirical-growth-record"></a>
</h3>
<p>Each person’s empirical growth record can be summarized by applying
two standardized approaches:</p>
<ul>
<li>The <strong>nonparametric</strong> approach uses nonparametric
smooths to summarize each person’s pattern of change over time
graphically without imposing a specific functional form. The primary
advantage of the nonparametric approach is that it requires no
assumptions.</li>
<li>The <strong>parametric</strong> approach uses separate parametric
models fit to each person’s data to summarize their pattern of change
over time. Each model uses a common functional form for the trajectories
(e.g., a straight line, a quadratic curve, etc.). The primary advantage
of the parametric approach is that it provides numeric summaries of the
trajectories that can be used for further exploration.</li>
</ul>
<p>Singer and Willett (2003) recommend using both approaches—beginning
with the nonparametric approach—as examining the smoothed trajectories
will help you select a common functional form for the trajectories in
the parametric approach.</p>
<div class="section level4">
<h4 id="the-nonparametric-approach">The nonparametric approach<a class="anchor" aria-label="anchor" href="#the-nonparametric-approach"></a>
</h4>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth()</a></code> function can be used to add a
nonparametric smooth layer to the empirical growth record plot. The
choice of a particular smoothing algorithm is primarily a matter of
convenience, so we’ll use the default loess smoother. The
<code>span</code> argument controls the amount of smoothing for the
default loess smoother—with smaller numbers producing wigglier lines and
larger numbers producing smoother lines; here choose a value that
creates a similar smooth to the textbook figure.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 2.3, page 27:</span></span>
<span><span class="va">deviant_tolerance_empgrowth</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Singer and Willett (2003) recommend focusing on the elevation, shape,
and tilt of the smoothed trajectories by answering questions like:</p>
<ul>
<li>Do the scores hover at the low, medium, or high end of the
scale?</li>
<li>Does everyone change over time or do some people remain the
same?</li>
<li>Do the trajectories have an inflection point or plateau?</li>
<li>Is the rate of change steep or shallow?</li>
<li>What is the overall functional form of the trajectory at the
group-level? Is it linear or curvilinear? smooth or step-like?</li>
</ul>
<p>Answering the last question is particularly important, as it will
help you select a common functional form for the trajectories in the
parametric approach.</p>
</div>
<div class="section level4">
<h4 id="the-parametric-approach">The parametric approach<a class="anchor" aria-label="anchor" href="#the-parametric-approach"></a>
</h4>
<p>For the parametric approach, Singer and Willett (2003) suggest using
the following three-step process:</p>
<ol style="list-style-type: decimal">
<li>Estimate a within-person linear model for each person in the data
set.</li>
<li>Collect summary statistics from each within-person linear model into
a single data set.</li>
<li>Add each person’s fitted trajectory to the empirical growth record
plot.</li>
</ol>
<p>To begin, we’ll use the <code><a href="https://rdrr.io/pkg/lme4/man/lmList.html" class="external-link">lmList()</a></code> function from the
<strong>lme4</strong> package to fit a common linear model for each
adolescent in the data set. The model formula for the
<code><a href="https://rdrr.io/pkg/lme4/man/lmList.html" class="external-link">lmList()</a></code> function takes the form
<code>response ~ terms | group</code>. Here we select a straight line as
the common functional form for the trajectories, with age centred at age
11.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmList.html" class="external-link">lmList</a></span><span class="op">(</span></span>
<span>  <span class="va">tolerance</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">11</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span>,</span>
<span>  pool <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data <span class="op">=</span> <span class="va">deviant_tolerance_pp</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 2.2, page 30:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deviant_tolerance_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;   Model: tolerance ~ I(age - 11) | NULL </span></span>
<span><span class="co">#&gt;    Data: deviant_tolerance_pp </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;    (Intercept) </span></span>
<span><span class="co">#&gt;      Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; 9       1.902 0.25194841  7.549165 4.819462e-03</span></span>
<span><span class="co">#&gt; 45      1.144 0.13335666  8.578499 3.329579e-03</span></span>
<span><span class="co">#&gt; 268     1.536 0.26038049  5.899059 9.725771e-03</span></span>
<span><span class="co">#&gt; 314     1.306 0.15265648  8.555156 3.356044e-03</span></span>
<span><span class="co">#&gt; 442     1.576 0.20786534  7.581832 4.759898e-03</span></span>
<span><span class="co">#&gt; 514     1.430 0.13794927 10.366130 1.915399e-03</span></span>
<span><span class="co">#&gt; 569     1.816 0.02572936 70.580844 6.267530e-06</span></span>
<span><span class="co">#&gt; 624     1.120 0.04000000 28.000000 1.000014e-04</span></span>
<span><span class="co">#&gt; 723     1.268 0.08442748 15.018806 6.407318e-04</span></span>
<span><span class="co">#&gt; 918     1.000 0.30444376  3.284679 4.626268e-02</span></span>
<span><span class="co">#&gt; 949     1.728 0.24118043  7.164760 5.600382e-03</span></span>
<span><span class="co">#&gt; 978     1.028 0.31995000  3.213002 4.884420e-02</span></span>
<span><span class="co">#&gt; 1105    1.538 0.15115555 10.174949 2.022903e-03</span></span>
<span><span class="co">#&gt; 1542    1.194 0.18032748  6.621287 7.015905e-03</span></span>
<span><span class="co">#&gt; 1552    1.184 0.37355321  3.169562 5.049772e-02</span></span>
<span><span class="co">#&gt; 1653    0.954 0.13925516  6.850734 6.366647e-03</span></span>
<span><span class="co">#&gt;    I(age - 11) </span></span>
<span><span class="co">#&gt;      Estimate Std. Error    t value   Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; 9       0.119 0.10285751  1.1569404 0.33105320</span></span>
<span><span class="co">#&gt; 45      0.174 0.05444263  3.1960249 0.04948216</span></span>
<span><span class="co">#&gt; 268     0.023 0.10629989  0.2163690 0.84257784</span></span>
<span><span class="co">#&gt; 314    -0.030 0.06232175 -0.4813729 0.66318168</span></span>
<span><span class="co">#&gt; 442     0.058 0.08486067  0.6834733 0.54336337</span></span>
<span><span class="co">#&gt; 514     0.265 0.05631755  4.7054602 0.01816360</span></span>
<span><span class="co">#&gt; 569     0.049 0.01050397  4.6649040 0.01859462</span></span>
<span><span class="co">#&gt; 624     0.020 0.01632993  1.2247449 0.30806801</span></span>
<span><span class="co">#&gt; 723    -0.054 0.03446738 -1.5666989 0.21516994</span></span>
<span><span class="co">#&gt; 918     0.143 0.12428864  1.1505476 0.33330784</span></span>
<span><span class="co">#&gt; 949    -0.098 0.09846150 -0.9953129 0.39294486</span></span>
<span><span class="co">#&gt; 978     0.632 0.13061904  4.8384983 0.01683776</span></span>
<span><span class="co">#&gt; 1105    0.156 0.06170899  2.5279945 0.08557441</span></span>
<span><span class="co">#&gt; 1542    0.237 0.07361839  3.2193045 0.04861002</span></span>
<span><span class="co">#&gt; 1552    0.153 0.15250246  1.0032625 0.38965538</span></span>
<span><span class="co">#&gt; 1653    0.246 0.05685068  4.3271249 0.02275586</span></span></code></pre></div>
<p>Next we’ll collect summary statistics from each within-person linear
model into a single data set using the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> function from
the <strong>broom</strong> package. However, because
<code><a href="https://rdrr.io/pkg/lme4/man/lmList.html" class="external-link">lmList()</a></code> returns a list of models, we need to apply the
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> call to each model prior to collecting the summary
statistics into a single data set. Ironically, we also need to tidy the
result of <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> to prepare the data for plotting.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_tidy</span> <span class="op">&lt;-</span> <span class="va">deviant_tolerance_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">tidy</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span>    term <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">term</span> <span class="op">==</span> <span class="st">"(Intercept)"</span> <span class="op">~</span> <span class="st">"intercept"</span>,</span>
<span>      <span class="va">term</span> <span class="op">==</span> <span class="st">"I(age - 11)"</span> <span class="op">~</span> <span class="st">"slope"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">deviant_tolerance_abline</span> <span class="op">&lt;-</span> <span class="va">deviant_tolerance_tidy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span><span class="op">:</span><span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">term</span>, values_from <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deviant_tolerance_abline</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 3</span></span></span>
<span><span class="co">#&gt;    id    intercept   slope</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9         1.90   0.119 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 45        1.14   0.174 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 268       1.54   0.023<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 314       1.31  -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 442       1.58   0.058<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 514       1.43   0.265 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 569       1.82   0.049<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 624       1.12   0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 723       1.27  -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 918       1      0.143 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 949       1.73  -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 978       1.03   0.632 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 1105      1.54   0.156 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1542      1.19   0.237 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 1552      1.18   0.153 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 1653      0.954  0.246</span></span></code></pre></div>
<p>Finally, we can add each person’s fitted trajectory to the empirical
growth record plot using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline()</a></code> function.
However, because we centred <code>age</code> in our linear model, we
need to transform the scale of the x-axis of the empirical growth plot
to be centred as well—otherwise ggplot2 will not be able to align the
fitted trajectories correctly. To do so, we must create a custom
transformation object using the <code><a href="https://scales.r-lib.org/reference/new_transform.html" class="external-link">new_transform()</a></code> function
from the <strong>scales</strong> package, which defines the
transformation, its inverse, and methods for generating breaks and
labels.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transform_centre</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">subtract</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://scales.r-lib.org/reference/new_transform.html" class="external-link">new_transform</a></span><span class="op">(</span></span>
<span>    <span class="st">"centre"</span>,</span>
<span>    transform <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="va">subtract</span>,</span>
<span>    inverse <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="va">subtract</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Figure 2.5, page 32:</span></span>
<span><span class="va">deviant_tolerance_empgrowth</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">intercept</span>, slope <span class="op">=</span> <span class="va">slope</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">deviant_tolerance_abline</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>transform <span class="op">=</span> <span class="fu">transform_centre</span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Alternatively, if you only plan to examine the parametric
trajectories graphically, the three-step process suggested by Singer and
Willett (2003) can be skipped altogether by using the
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth()</a></code> function with the <code>"lm"</code> method.
This approach also fits a within-person linear model for each person in
the data set; the only drawback is that it makes it awkward (<a href="https://stackoverflow.com/a/9791394/16844576" class="external-link">though not
impossible</a>) to access the summary statistics from each model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_empgrowth</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="exploring-differences-in-change-across-people">2.3 Exploring differences in change across people<a class="anchor" aria-label="anchor" href="#exploring-differences-in-change-across-people"></a>
</h2>
<p>Having explored how each individual changes over time, in Section 2.3
Singer and Willett (2003) continue with the
<code>deviant_tolerance_pp</code> data set to demonstrate three
strategies for exploring <strong>interindividual differences</strong> in
change:</p>
<ol style="list-style-type: decimal">
<li>Plotting the entire set of individual trajectories together, along
with an average change trajectory for the entire group. Individual
trajectories can either be compared with one another to examine
similarities and differences in changes across people, or with the
average change trajectory to compare individual change with group
change.</li>
<li>Conducting descriptive analyses of key model parameters, such as the
estimated intercepts and slopes of the individual change trajectory
models.</li>
<li>Exploring the relationship between change and time-invariant
predictors. This relationship can be explored through both plots and
statistical modelling.</li>
</ol>
<div class="section level3">
<h3 id="plotting-the-entire-set-of-trajectories-together">Plotting the entire set of trajectories together<a class="anchor" aria-label="anchor" href="#plotting-the-entire-set-of-trajectories-together"></a>
</h3>
<p>The purpose of the first strategy is to answer <em>generic</em>
questions about change, such as:</p>
<ul>
<li>Is the direction and rate of change similar or different across
people?</li>
<li>How does individual change compare to the group-averaged change
trajectory?</li>
</ul>
<p>For this strategy, Singer and Willett (2003) suggest using both the
nonparametric and parametric approaches, as certain patterns in the data
may be somewhat easier to interpret using one approach or the other.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_grptraj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"loess"</span>, <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.method</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">deviant_tolerance_pp</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">.method</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">tolerance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"individual"</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>          method <span class="op">=</span> <span class="va">.method</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">.9</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>,</span>
<span>          method <span class="op">=</span> <span class="va">.method</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">.9</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linewidth_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"trajectory"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 2.6, page 34:</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">deviant_tolerance_grptraj</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span>, axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="conducting-descriptive-analyses-of-key-model-parameters">Conducting descriptive analyses of key model parameters<a class="anchor" aria-label="anchor" href="#conducting-descriptive-analyses-of-key-model-parameters"></a>
</h3>
<p>The purpose of the second strategy is to answer <em>specific</em>
questions about the behaviour of key parameters in the individual change
trajectory models, such as:</p>
<ul>
<li>What is the average initial status and the average annual rate of
change?</li>
<li>What is the observed variability in initial status and annual rate
of change?</li>
<li>What is the relationship between initial status and annual rate of
change?</li>
</ul>
<p>For this strategy, Singer and Willett (2003) suggest examining the
estimated intercepts and slopes from the fitted linear models with the
following three summary statistics:</p>
<ol style="list-style-type: decimal">
<li>The sample <strong>mean</strong>, which summarizes the average
initial status (intercept) and annual rate of change (slope) across the
sample.</li>
<li>The sample <strong>variance</strong> or <strong>standard
deviation</strong>, which summarize the amount of observed
interindividual heterogeneity in initial status and annual rate of
change.</li>
<li>The sample <strong>correlation</strong>, which summarizes the
strength and direction of the relationship between initial status and
annual rate of change.</li>
</ol>
<p>The sample mean, variance, and standard deviation can be computed
together from the tidied model fits we saved earlier using a combination
of the <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> functions
from the dplyr package.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 2.3, page 37:</span></span>
<span><span class="va">deviant_tolerance_tidy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>,</span>
<span>    var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   term       mean    var    sd</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> intercept 1.36  0.088<span style="text-decoration: underline;">7</span> 0.298</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> slope     0.131 0.029<span style="text-decoration: underline;">7</span> 0.172</span></span></code></pre></div>
<p>The sample correlation needs to be computed in a separate step, and
requires some additional transformations to the tidied model fits before
doing so. Here we use the <code><a href="https://corrr.tidymodels.org/reference/correlate.html" class="external-link">correlate()</a></code> function from the
<strong>corrr</strong> package—which is part of the
<strong>tidymodels</strong> universe of packages—because its API is
designed with data pipelines in mind.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_tidy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">term</span>, <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">term</span>, values_from <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://corrr.tidymodels.org/reference/correlate.html" class="external-link">correlate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://corrr.tidymodels.org/reference/stretch.html" class="external-link">stretch</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, remove.dups <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   x         y          r</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> intercept slope -<span style="color: #BB0000;">0.448</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploring-the-relationship-between-change-and-time-invariant-predictors">Exploring the relationship between change and time-invariant
predictors<a class="anchor" aria-label="anchor" href="#exploring-the-relationship-between-change-and-time-invariant-predictors"></a>
</h3>
<p>The purpose of the final strategy is to answer questions about
<em>systematic interindividual differences</em> in change, such as:</p>
<ul>
<li>Does the observed (average) initial status and (average) annual rate
of change differ across the levels or values of any time-invariant
predictors?</li>
<li>Is there a relationship between initial status or annual rate of
change and any time-invariant predictors?</li>
</ul>
<p>For this strategy, Singer and Willett (2003) suggest using two
approaches:</p>
<ol style="list-style-type: decimal">
<li>Plotting (smoothed) individual growth trajectories, displayed
separately for groups distinguished by important values of
time-invariant predictors. For categorical predictors, each level of the
predictor can be used. For continuous predictors, the values can be
temporarily categorized for the purpose of display.</li>
<li>Conducting exploratory analyses of the relationship between change
and time-invariant predictors, investigating whether the estimated
intercepts and slopes of the individual change trajectory models vary
systematically with different predictors.</li>
</ol>
<div class="section level4">
<h4 id="the-plotting-approach">The plotting approach<a class="anchor" aria-label="anchor" href="#the-plotting-approach"></a>
</h4>
<p>For the plotting approach, we can adapt the code we used earlier to
plot the entire set of trajectories together, simply changing the
variable we’ll facet by. Here we facet by the categorical predictor
<code>male</code> and the continuous predictor <code>exposure</code>,
which we split at its median for the purposes of display.</p>
<p><!-- TODO: Add `axes = "collect"` to the patchwork once this bug is fixed: <https://github.com/thomasp85/patchwork/issues/359> --></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_grptraj_by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>male <span class="op">=</span> <span class="st">"male"</span>, exposure <span class="op">=</span> <span class="st">"exposure"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.by</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">deviant_tolerance_pp</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        exposure <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">exposure</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span>,</span>
<span>        exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">exposure</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">tolerance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"individual"</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">.9</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">.9</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linewidth_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">.by</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"trajectory"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 2.7, page 38:</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">deviant_tolerance_grptraj_by</span>, ncol <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>When examining plots like these, Singer and Willett (2003) recommend
looking for systematic patterns in the trajectories to answer questions
like:</p>
<ul>
<li>Do the observed trajectories differ across groups?</li>
<li>Do observed differences appear more in the intercepts or in the
slopes?</li>
<li>Are the observed trajectories of some groups more heterogeneous than
others?</li>
</ul>
<p>If we also wished to conduct descriptive analyses of the key model
parameters for each of these groups we could use the
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> function to update and refit our common linear
model to different subsets of the data. Here we store the model fits for
each subgroup in a list so they’re easier to iterate upon together.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tolerance_fit_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  male <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">deviant_tolerance_fit</span>, subset <span class="op">=</span> <span class="va">male</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">deviant_tolerance_fit</span>, subset <span class="op">=</span> <span class="va">male</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tolerance_fit_exposure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">deviant_tolerance_fit</span>, subset <span class="op">=</span> <span class="va">exposure</span> <span class="op">&lt;</span> <span class="fl">1.145</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">deviant_tolerance_fit</span>, subset <span class="op">=</span> <span class="va">exposure</span> <span class="op">&gt;=</span> <span class="fl">1.145</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For example, here is a descriptive analysis of the intercepts and
slopes for males and females.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tolerance_fit_sex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit_sex</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.fit_sex</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">tidy</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   sex    term         mean    sd</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> male   (Intercept) 1.36  0.264</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> male   I(age - 11) 0.167 0.238</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> female (Intercept) 1.36  0.338</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> female I(age - 11) 0.102 0.106</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-exploratory-analysis-approach">The exploratory analysis approach<a class="anchor" aria-label="anchor" href="#the-exploratory-analysis-approach"></a>
</h4>
<p>For the exploratory analysis approach, Singer and Willett (2003)
recommend restricting ourselves to the simplest of approaches to examine
relationship between change and time-invariant predictors—bivariate
scatter plots and sample correlations. Their reasoning for this
restriction is twofold:</p>
<ol style="list-style-type: decimal">
<li>The statistical models presented in this chapter are intended for
descriptive and exploratory purposes only; their estimates have known
biases that make them imperfect measures of each person’s true initial
status and true rate of change.</li>
<li>These models will soon be replaced with the multilevel model for
change in Chapter 3, which is better-suited for modelling longitudinal
data.</li>
</ol>
<p>Before doing any plotting or computations, we first need to add each
adolescent’s <code>male</code> and <code>exposure</code> values to the
<code>deviant_tolerance_tidy</code> data frame. This is easily done
using the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> function from the dplyr package,
which performs a mutating join to add columns from one data frame to
another, matching observations based on the keys. Here we join a
selection of columns from the person-level
<code>deviant_tolerance_pl</code> data set: Specifically, the
<code>id</code> column, which exists in both data frames and will thus
be used for joining; and our two time-invariant predictors
<code>male</code> and <code>exposure</code>. We’ll also create a new
<code>sex</code> variable, which we can use instead of <code>male</code>
for plotting.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_tidy_2</span> <span class="op">&lt;-</span> <span class="va">deviant_tolerance_tidy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">deviant_tolerance_pl</span>, <span class="va">id</span>, <span class="va">male</span>, <span class="va">exposure</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">male</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deviant_tolerance_tidy_2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 9</span></span></span>
<span><span class="co">#&gt;    id    term      estimate std.error statistic p.value  male exposure sex   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9     intercept   1.90      0.252      7.55  0.004<span style="text-decoration: underline;">82</span>     0     1.54 female</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 9     slope       0.119     0.103      1.16  0.331       0     1.54 female</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 45    intercept   1.14      0.133      8.58  0.003<span style="text-decoration: underline;">33</span>     1     1.16 male  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 45    slope       0.174     0.054<span style="text-decoration: underline;">4</span>     3.20  0.049<span style="text-decoration: underline;">5</span>      1     1.16 male  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 268   intercept   1.54      0.260      5.90  0.009<span style="text-decoration: underline;">73</span>     1     0.9  male  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 268   slope       0.023<span style="text-decoration: underline;">0</span>    0.106      0.216 0.843       1     0.9  male  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 314   intercept   1.31      0.153      8.56  0.003<span style="text-decoration: underline;">36</span>     0     0.81 female</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 314   slope      -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">0</span>    0.062<span style="text-decoration: underline;">3</span>    -<span style="color: #BB0000;">0.481</span> 0.663       0     0.81 female</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 442   intercept   1.58      0.208      7.58  0.004<span style="text-decoration: underline;">76</span>     0     1.13 female</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 442   slope       0.058<span style="text-decoration: underline;">0</span>    0.084<span style="text-decoration: underline;">9</span>     0.683 0.543       0     1.13 female</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 22 more rows</span></span></span></code></pre></div>
<p>Now we can create the bivariate scatter plots. Note that we use the
<code>.data</code> pronoun inside our call to <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>—the
<code>.data</code> pronoun is a special construct in the tidyverse that
allows us to treat a character vector of variable names as environment
variables, so they work in the expected way for arguments that use
<strong>non-standard evaluation</strong>. To learn more about the
<code>.data</code> pronoun, see the dplyr package’s <a href="https://dplyr.tidyverse.org/articles/programming.html" class="external-link">Programming
with dplyr</a> vignette.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deviant_tolerance_biplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="st">"sex"</span>, exposure <span class="op">=</span> <span class="st">"exposure"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">deviant_tolerance_tidy_2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 2.8, page 40:</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">deviant_tolerance_biplot</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-2_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>Finally, we can compute the correlation between the intercepts and
slopes of the individual change trajectory models with the
time-invariant predictors <code>male</code> and <code>exposure</code>.
Here we use the <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code> function rather than
<code><a href="https://corrr.tidymodels.org/reference/correlate.html" class="external-link">corrr::correlate()</a></code> since we just want to return the
correlation value, not a correlation data frame.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correlation values shown in Figure 2.8, page 40:</span></span>
<span><span class="va">deviant_tolerance_tidy_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    male_cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">male</span><span class="op">)</span>,</span>
<span>    exposure_cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">exposure</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   term      male_cor exposure_cor</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> intercept  0.008<span style="text-decoration: underline;">63</span>        0.232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> slope      0.194          0.442</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael McCarthy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
