<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 13: Describing continuous-time event occurrence data • alda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 13: Describing continuous-time event occurrence data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">alda</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tips-tricks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tips &amp; Tricks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tips-tricks">
<li><a class="dropdown-item" href="../articles/longitudinal-data-organization.html">Longitudinal data organization</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-textbook-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Textbook examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-textbook-examples">
<li><h6 class="dropdown-header" data-toc-skip>Longitudinal mixed effects modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-2.html">Chapter 2</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-3.html">Chapter 3</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-4.html">Chapter 4</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-5.html">Chapter 5</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-6.html">Chapter 6</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-7.html">Chapter 7</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Longitudinal structural equation modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-8.html">Chapter 8</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Survival analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-9.html">Chapter 9</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-10.html">Chapter 10</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-11.html">Chapter 11</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-12.html">Chapter 12</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-13.html">Chapter 13</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-14.html">Chapter 14</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-15.html">Chapter 15</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mccarthy-m-g/alda/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 13: Describing continuous-time event occurrence data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mccarthy-m-g/alda/blob/main/vignettes/articles/chapter-13.Rmd" class="external-link"><code>vignettes/articles/chapter-13.Rmd</code></a></small>
      <div class="d-none name"><code>chapter-13.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mccarthy-m-g.github.io/alda/">alda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">muhaz</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="a-framework-for-characterizing-the-distribution-of-continuous-time-event-data">13.1 A framework for characterizing the distribution of
continuous-time event data<a class="anchor" aria-label="anchor" href="#a-framework-for-characterizing-the-distribution-of-continuous-time-event-data"></a>
</h2>
<p>In Section 13.1 Singer and Willett (2003) discuss the salient
features of <strong>continuous-time event data</strong> using a subset
of data from Diekmann and colleagues (1996), who measured time to horn
honking in a sample of 57 motorists who were purposefully blocked at a
green light by a Volkswagen Jetta at a busy intersection near the centre
of Munich, West Germany on two busy afternoons (Sunday and Monday) in
1998. Motorists were followed until they honked their horns or took an
alternative action (beaming or changing lanes).</p>
<p>For this example we use the <code>honking</code> data set, a
person-level data frame with 57 rows and 3 columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>seconds</code>: Number of seconds to horn honking or an
alternative action.</li>
<li>
<code>censor</code>: Censoring status.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 57 × 3</span></span></span>
<span><span class="co">#&gt;    id    seconds censor</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        2.88      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2        4.63      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3        2.36      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4        2.68      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5        2.5       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6        4.3       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7        1.86      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8        4.01      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9        1.41      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       9.59      0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 47 more rows</span></span></span></code></pre></div>
<p>The defining feature of continuous time is that it is infinitely
divisible—there exist an infinite number of possible instants when the
target event can occur, which can be measured with ever-increasing
precision by using finer metrics for clocking time. As Singer and
Willett (2003) discuss, because continuous time is infinitely divisible,
the (theoretical) distribution of event times has two salient
features:</p>
<ul>
<li>The probability of observing any particular event time is
infinitesimally small.</li>
<li>The probability that two or more individuals will share the same
event time is infinitesimally small.</li>
</ul>
<p>Although we do not expect to observe these properties exactly in real
data due to measurement limitations, such as rounding, we can observe
that both of these properties are almost manifested in the event times
of the <code>honking</code> data, which has only one tie at 1.41
seconds.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Similar to Table 13.1:</span></span>
<span><span class="va">honking</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">seconds</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    seconds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">censor</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">seconds</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">seconds</span>, <span class="st">"*"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .keep <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">seconds</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "1.41"   "1.41*"  "1.51"   "1.67"   "1.68"   "1.86"   "2.12"   "2.19"  </span></span>
<span><span class="co">#&gt;  [9] "2.36*"  "2.48"   "2.5"    "2.53"   "2.54"   "2.56"   "2.62"   "2.68"  </span></span>
<span><span class="co">#&gt; [17] "2.76*"  "2.78*"  "2.83"   "2.88"   "2.89"   "2.92"   "2.98"   "3.05*" </span></span>
<span><span class="co">#&gt; [25] "3.14"   "3.17"   "3.21"   "3.22"   "3.24"   "3.46*"  "3.56"   "3.57"  </span></span>
<span><span class="co">#&gt; [33] "3.58"   "3.78"   "4.01*"  "4.1"    "4.18"   "4.3*"   "4.44"   "4.51"  </span></span>
<span><span class="co">#&gt; [41] "4.52"   "4.63*"  "4.71*"  "4.96"   "5.12*"  "5.39"   "5.73"   "5.88*" </span></span>
<span><span class="co">#&gt; [49] "6.03"   "6.21*"  "6.3"    "6.6*"   "7.2"    "9.59"   "12.29"  "13.18" </span></span>
<span><span class="co">#&gt; [57] "17.15*"</span></span></code></pre></div>
<p>These features are a significant departure from the distributional
features of discrete event times, where the probability of event
occurrence in at least some periods is non-zero and ties are pervasive.
Because of this departure, we must introduce new continuous time
definitions of the survivor and hazard functions:</p>
<ul>
<li>
<p>The <strong>continuous-time survival function</strong> is the
<em>cumulative probability</em> that the event time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>,
of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
individual will exceed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>j</mi></msub><annotation encoding="application/x-tex">t_j</annotation></semantics></math>,
the infinite number of possible instants when the target event could
occur:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>T</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
S(t_{ij}) = \Pr[T_i &gt; t_j],
</annotation></semantics></math></p>
<p>which is essentially identical to the discrete-time survival function
in definition and meaning, aside from the different metric for clocking
time.</p>
</li>
<li>
<p>The <strong>continuous-time hazard function</strong> is an
instantaneous <em>rate</em> assessing the conditional probability that
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
individual will experience the target event in the next small interval
of time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math>,
given that they did not experience it in any prior interval, divided by
the length of that interval:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>lim</mo><mrow><mi>Δ</mi><mi>t</mi><mo>→</mo><mn>0</mn></mrow></munder><mrow><mo stretchy="true" form="prefix">{</mo><mfrac><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>T</mi><mi>i</mi></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo>,</mo><msub><mi>t</mi><mi>j</mi></msub><mo>+</mo><mi>Δ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub><mo>≥</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>Δ</mi><mi>t</mi></mrow></mfrac><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
h(t_{ij}) = \lim_{\Delta t \to 0} \left\{
  \frac{\Pr[T_i \in (t_j, t_j + \Delta t) | T_i \geq t_j]}
  {\Delta t}
\right\},
</annotation></semantics></math></p>
<p>which means that unlike discrete-time hazard probabilities,
continuous-time hazard rates do not have an upper bound and can exceed
values of 1.0.</p>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="grouped-methods-for-estimating-continuous-time-survivor-and-hazard-functions">13.2 Grouped methods for estimating continuous-time survivor and
hazard functions<a class="anchor" aria-label="anchor" href="#grouped-methods-for-estimating-continuous-time-survivor-and-hazard-functions"></a>
</h2>
<p>In Section 13.2 Singer and Willett (2003) discuss two strategies for
estimating continuous-time survival and hazard functions from the
<strong>grouped life table</strong>, which partitions continuous time
into a manageable number of contiguous (possibly unequal width)
intervals:</p>
<ul>
<li>The <strong>discrete-time method</strong> estimates continuous-time
survival and hazard functions by applying the discrete-time principles
of Section 10.2 to the grouped life table.</li>
<li>The <strong>actuarial method</strong> (aka the life table method)
estimates continuous-time survival and hazard functions based on data
assumed to be available at each interval’s midpoint, using a similar
strategy to the discrete-time method.</li>
</ul>
<p>We begin by creating a grouped life table for the
<code>honking</code> data, which we divide into eight contiguous
intervals: seven 1-second intervals, and one 10-second interval.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_lifetable</span> <span class="op">&lt;-</span> <span class="va">honking</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">seconds</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">18</span><span class="op">)</span>, right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># All grouping needs to be dropped after summarizing in order to calculate the</span></span>
<span>  <span class="co"># number at risk correctly in the next step.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n.event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censor</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.censor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censor</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    n.risk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    prob.estimate <span class="op">=</span> <span class="va">n.event</span> <span class="op">/</span> <span class="va">n.risk</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time_interval</span>, <span class="va">n.risk</span>, <span class="va">n.event</span><span class="op">:</span><span class="va">prob.estimate</span><span class="op">)</span></span>
<span></span>
<span><span class="va">honking_lifetable</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">#&gt;   time_interval n.risk n.event n.censor prob.estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [1,2)             57       5        1        0.087<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [2,3)             51      14        3        0.275 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [3,4)             34       9        2        0.265 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [4,5)             23       6        4        0.261 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> [5,6)             13       2        2        0.154 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> [6,7)              9       2        2        0.222 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> [7,8)              5       1        0        0.2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> [8,18)             4       3        1        0.75</span></span></code></pre></div>
<p>Then we can estimate the continuous-time survival and hazard
functions “by hand” using the discrete-time and actuarial methods.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_lifetable</span> <span class="op">&lt;-</span> <span class="va">honking_lifetable</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Temporary variables</span></span>
<span>    time_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">time_interval</span>, <span class="st">"[[:digit:]]+(?=,)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    time_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">time_interval</span>, <span class="st">"(?&lt;=,)[[:digit:]]+"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    time_width <span class="op">=</span> <span class="va">time_end</span> <span class="op">-</span> <span class="va">time_start</span>,</span>
<span>    prob.estimate.actuarial <span class="op">=</span> <span class="va">n.event</span> <span class="op">/</span> <span class="op">(</span><span class="va">n.risk</span> <span class="op">-</span> <span class="op">(</span><span class="va">n.censor</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Discrete-time method estimates</span></span>
<span>    surv.discrete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">prob.estimate</span><span class="op">)</span>,</span>
<span>    haz.discrete <span class="op">=</span> <span class="va">prob.estimate</span> <span class="op">/</span> <span class="va">time_width</span>,</span>
<span>    <span class="co"># Actuarial method estimates</span></span>
<span>    surv.actuarial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">prob.estimate.actuarial</span><span class="op">)</span>,</span>
<span>    haz.actuarial <span class="op">=</span> <span class="op">(</span></span>
<span>      <span class="va">n.event</span> <span class="op">/</span> <span class="op">(</span><span class="va">n.risk</span> <span class="op">-</span> <span class="op">(</span><span class="va">n.censor</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">n.event</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">time_width</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">time_start</span><span class="op">:</span><span class="va">prob.estimate.actuarial</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 13.2, page 477:</span></span>
<span><span class="va">honking_lifetable</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">prob.estimate</span><span class="op">:</span><span class="va">haz.actuarial</span>, decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="time_interval">time_interval</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n.risk">n.risk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n.event">n.event</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n.censor">n.censor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prob.estimate">prob.estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="surv.discrete">surv.discrete</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="haz.discrete">haz.discrete</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="surv.actuarial">surv.actuarial</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="haz.actuarial">haz.actuarial</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="time_interval" class="gt_row gt_center">[1,2)</td>
<td headers="n.risk" class="gt_row gt_right">57</td>
<td headers="n.event" class="gt_row gt_right">5</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0877</td>
<td headers="surv.discrete" class="gt_row gt_right">0.9123</td>
<td headers="haz.discrete" class="gt_row gt_right">0.0877</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.9115</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.0926</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[2,3)</td>
<td headers="n.risk" class="gt_row gt_right">51</td>
<td headers="n.event" class="gt_row gt_right">14</td>
<td headers="n.censor" class="gt_row gt_right">3</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2745</td>
<td headers="surv.discrete" class="gt_row gt_right">0.6619</td>
<td headers="haz.discrete" class="gt_row gt_right">0.2745</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.6537</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.3294</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[3,4)</td>
<td headers="n.risk" class="gt_row gt_right">34</td>
<td headers="n.event" class="gt_row gt_right">9</td>
<td headers="n.censor" class="gt_row gt_right">2</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2647</td>
<td headers="surv.discrete" class="gt_row gt_right">0.4867</td>
<td headers="haz.discrete" class="gt_row gt_right">0.2647</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.4754</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.3158</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[4,5)</td>
<td headers="n.risk" class="gt_row gt_right">23</td>
<td headers="n.event" class="gt_row gt_right">6</td>
<td headers="n.censor" class="gt_row gt_right">4</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2609</td>
<td headers="surv.discrete" class="gt_row gt_right">0.3597</td>
<td headers="haz.discrete" class="gt_row gt_right">0.2609</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.3396</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.3333</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[5,6)</td>
<td headers="n.risk" class="gt_row gt_right">13</td>
<td headers="n.event" class="gt_row gt_right">2</td>
<td headers="n.censor" class="gt_row gt_right">2</td>
<td headers="prob.estimate" class="gt_row gt_right">0.1538</td>
<td headers="surv.discrete" class="gt_row gt_right">0.3044</td>
<td headers="haz.discrete" class="gt_row gt_right">0.1538</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.2830</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.1818</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[6,7)</td>
<td headers="n.risk" class="gt_row gt_right">9</td>
<td headers="n.event" class="gt_row gt_right">2</td>
<td headers="n.censor" class="gt_row gt_right">2</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2222</td>
<td headers="surv.discrete" class="gt_row gt_right">0.2367</td>
<td headers="haz.discrete" class="gt_row gt_right">0.2222</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.2122</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.2857</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[7,8)</td>
<td headers="n.risk" class="gt_row gt_right">5</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2000</td>
<td headers="surv.discrete" class="gt_row gt_right">0.1894</td>
<td headers="haz.discrete" class="gt_row gt_right">0.2000</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.1698</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.2222</td>
</tr>
<tr>
<td headers="time_interval" class="gt_row gt_center">[8,18)</td>
<td headers="n.risk" class="gt_row gt_right">4</td>
<td headers="n.event" class="gt_row gt_right">3</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.7500</td>
<td headers="surv.discrete" class="gt_row gt_right">0.0473</td>
<td headers="haz.discrete" class="gt_row gt_right">0.0750</td>
<td headers="surv.actuarial" class="gt_row gt_right">0.0243</td>
<td headers="haz.actuarial" class="gt_row gt_right">0.1500</td>
</tr>
</tbody>
</table>
</div>
<p>Finally we can plot the estimates of both methods. Following Singer
and Willett (2003), we plot the actuarial estimates as a step function
associating each survival probability and hazard rate with its entire
time interval.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Baseline plot</span></span>
<span><span class="va">honking_plot</span> <span class="op">&lt;-</span> <span class="va">honking_lifetable</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    seconds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">time_interval</span>, <span class="st">"(?&lt;=,)[[:digit:]]+"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>seconds <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, surv.discrete <span class="op">=</span> <span class="fl">1</span>, surv.actuarial <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">seconds</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Survival functions</span></span>
<span><span class="va">honking_surv.discrete</span> <span class="op">&lt;-</span> <span class="va">honking_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">surv.discrete</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">honking_surv.actuarial</span> <span class="op">&lt;-</span> <span class="va">honking_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">surv.actuarial</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"vh"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hazard functions</span></span>
<span><span class="va">honking_haz.discrete</span> <span class="op">&lt;-</span> <span class="va">honking_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">haz.discrete</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.35</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">honking_haz.actuarial</span> <span class="op">&lt;-</span> <span class="va">honking_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">haz.actuarial</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"vh"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.35</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 13.1, page 479:</span></span>
<span><span class="va">honking_surv.discrete</span> <span class="op">+</span> <span class="va">honking_surv.actuarial</span> <span class="op">+</span></span>
<span>  <span class="va">honking_haz.discrete</span> <span class="op">+</span> <span class="va">honking_haz.actuarial</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, axes <span class="op">=</span> <span class="st">"collect_x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="the-kaplan-meier-method-of-estimating-the-continuous-time-survivor-function">13.3 The Kaplan-Meier method of estimating the continuous-time
survivor function<a class="anchor" aria-label="anchor" href="#the-kaplan-meier-method-of-estimating-the-continuous-time-survivor-function"></a>
</h2>
<p>In Section 13.3 Singer and Willett (2003) introduce the
<strong>Kaplan-Meier method</strong> (aka the <strong>product-limit
method</strong>) of estimating the continuous-time survival function,
which is a simple extension of the discrete-time method that constructs
time intervals using the raw event times such that each interval
contains just one observed event time.</p>
<p>We can fit a survival function with the the Kaplan-Meier method using
the <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit()</a></code> function from the <strong>survival</strong>
package (which we briefly discussed in Section 10.1). The model formula
for the <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit()</a></code> function takes the form
<code>response ~ terms</code>, where the response must be a “survival
object” created by the <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv()</a></code> function. For right-censored
data, the survival object can be created by supplying two unnamed
arguments to the <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv()</a></code> function corresponding to
<code>time</code> and <code>event</code> variables, in that order. Note
that we can recode a <code>censor</code> variable into an
<code>event</code> variable by reversing its values. For 0-1 coded data,
we can write the event status as <code>event = censor - 1</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_survfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">seconds</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">censor</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">honking</span><span class="op">)</span></span>
<span><span class="va">honking_survfit</span></span>
<span><span class="co">#&gt; Call: survfit(formula = Surv(seconds, 1 - censor) ~ 1, data = honking)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       n events median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; [1,] 57     42   3.58    3.17    4.96</span></span></code></pre></div>
<p>We can view the grouped life table from the <code>survfit</code>
object using either the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function, or the
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> function from the <strong>broom</strong>
package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">honking_survfit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: survfit(formula = Surv(seconds, 1 - censor) ~ 1, data = honking)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   time n.risk n.event survival std.err lower 95% CI upper 95% CI</span></span>
<span><span class="co">#&gt;   1.41     57       1   0.9825  0.0174      0.94896        1.000</span></span>
<span><span class="co">#&gt;   1.51     55       1   0.9646  0.0246      0.91758        1.000</span></span>
<span><span class="co">#&gt;   1.67     54       1   0.9467  0.0299      0.88985        1.000</span></span>
<span><span class="co">#&gt;   1.68     53       1   0.9289  0.0343      0.86405        0.999</span></span>
<span><span class="co">#&gt;   1.86     52       1   0.9110  0.0380      0.83950        0.989</span></span>
<span><span class="co">#&gt;   2.12     51       1   0.8931  0.0412      0.81587        0.978</span></span>
<span><span class="co">#&gt;   2.19     50       1   0.8753  0.0441      0.79296        0.966</span></span>
<span><span class="co">#&gt;   2.48     48       1   0.8570  0.0468      0.77004        0.954</span></span>
<span><span class="co">#&gt;   2.50     47       1   0.8388  0.0492      0.74765        0.941</span></span>
<span><span class="co">#&gt;   2.53     46       1   0.8206  0.0514      0.72572        0.928</span></span>
<span><span class="co">#&gt;   2.54     45       1   0.8023  0.0534      0.70418        0.914</span></span>
<span><span class="co">#&gt;   2.56     44       1   0.7841  0.0552      0.68299        0.900</span></span>
<span><span class="co">#&gt;   2.62     43       1   0.7659  0.0569      0.66212        0.886</span></span>
<span><span class="co">#&gt;   2.68     42       1   0.7476  0.0584      0.64154        0.871</span></span>
<span><span class="co">#&gt;   2.83     39       1   0.7285  0.0599      0.61996        0.856</span></span>
<span><span class="co">#&gt;   2.88     38       1   0.7093  0.0614      0.59868        0.840</span></span>
<span><span class="co">#&gt;   2.89     37       1   0.6901  0.0626      0.57769        0.824</span></span>
<span><span class="co">#&gt;   2.92     36       1   0.6710  0.0637      0.55695        0.808</span></span>
<span><span class="co">#&gt;   2.98     35       1   0.6518  0.0647      0.53648        0.792</span></span>
<span><span class="co">#&gt;   3.14     33       1   0.6320  0.0657      0.51549        0.775</span></span>
<span><span class="co">#&gt;   3.17     32       1   0.6123  0.0666      0.49477        0.758</span></span>
<span><span class="co">#&gt;   3.21     31       1   0.5925  0.0673      0.47429        0.740</span></span>
<span><span class="co">#&gt;   3.22     30       1   0.5728  0.0679      0.45405        0.723</span></span>
<span><span class="co">#&gt;   3.24     29       1   0.5530  0.0684      0.43404        0.705</span></span>
<span><span class="co">#&gt;   3.56     27       1   0.5325  0.0688      0.41338        0.686</span></span>
<span><span class="co">#&gt;   3.57     26       1   0.5121  0.0692      0.39297        0.667</span></span>
<span><span class="co">#&gt;   3.58     25       1   0.4916  0.0694      0.37282        0.648</span></span>
<span><span class="co">#&gt;   3.78     24       1   0.4711  0.0694      0.35291        0.629</span></span>
<span><span class="co">#&gt;   4.10     22       1   0.4497  0.0695      0.33217        0.609</span></span>
<span><span class="co">#&gt;   4.18     21       1   0.4283  0.0694      0.31172        0.588</span></span>
<span><span class="co">#&gt;   4.44     19       1   0.4057  0.0693      0.29028        0.567</span></span>
<span><span class="co">#&gt;   4.51     18       1   0.3832  0.0690      0.26919        0.545</span></span>
<span><span class="co">#&gt;   4.52     17       1   0.3606  0.0686      0.24847        0.523</span></span>
<span><span class="co">#&gt;   4.96     14       1   0.3349  0.0683      0.22451        0.500</span></span>
<span><span class="co">#&gt;   5.39     12       1   0.3070  0.0681      0.19875        0.474</span></span>
<span><span class="co">#&gt;   5.73     11       1   0.2791  0.0674      0.17386        0.448</span></span>
<span><span class="co">#&gt;   6.03      9       1   0.2481  0.0666      0.14651        0.420</span></span>
<span><span class="co">#&gt;   6.30      7       1   0.2126  0.0659      0.11585        0.390</span></span>
<span><span class="co">#&gt;   7.20      5       1   0.1701  0.0650      0.08044        0.360</span></span>
<span><span class="co">#&gt;   9.59      4       1   0.1276  0.0611      0.04991        0.326</span></span>
<span><span class="co">#&gt;  12.29      3       1   0.0851  0.0535      0.02478        0.292</span></span>
<span><span class="co">#&gt;  13.18      2       1   0.0425  0.0403      0.00665        0.272</span></span></code></pre></div>
<p>Note that these two methods return different standard errors: The
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function returns the standard error for the
survival function; however, the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> function <a href="https://github.com/tidymodels/broom/pull/1162" class="external-link">returns the
standard error for the cumulative hazard</a> (see Section 13.4), so we
need to transform it to get the standard error for the survival
function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">honking_survfit</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 56 × 8</span></span></span>
<span><span class="co">#&gt;     time n.risk n.event n.censor estimate std.error conf.high conf.low</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  1.41     57       1        1    0.982    0.017<span style="text-decoration: underline;">7</span>     1        0.949</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  1.51     55       1        0    0.965    0.025<span style="text-decoration: underline;">5</span>     1        0.918</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  1.67     54       1        0    0.947    0.031<span style="text-decoration: underline;">6</span>     1        0.890</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  1.68     53       1        0    0.929    0.036<span style="text-decoration: underline;">9</span>     0.999    0.864</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  1.86     52       1        0    0.911    0.041<span style="text-decoration: underline;">7</span>     0.989    0.840</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  2.12     51       1        0    0.893    0.046<span style="text-decoration: underline;">2</span>     0.978    0.816</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  2.19     50       1        0    0.875    0.050<span style="text-decoration: underline;">4</span>     0.966    0.793</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  2.36     49       0        1    0.875    0.050<span style="text-decoration: underline;">4</span>     0.966    0.793</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  2.48     48       1        0    0.857    0.054<span style="text-decoration: underline;">6</span>     0.954    0.770</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  2.5      47       1        0    0.839    0.058<span style="text-decoration: underline;">7</span>     0.941    0.748</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more rows</span></span></span></code></pre></div>
<p>They also return differing numbers of rows: By default, the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function returns rows only for intervals where an
event occurred (this can be changed with the <code>censored</code>
argument); whereas the the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> function always returns
rows for both uncensored and censored intervals. However, because
survival estimates do not change during censored intervals, an easy way
to match the result of <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
is to group the data by estimate values, then summarize.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_lifetable_km</span> <span class="op">&lt;-</span> <span class="va">honking_survfit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit0.html" class="external-link">survfit0</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">:</span><span class="va">conf.low</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    time_start <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>    n.risk <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">n.risk</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n.event</span>, <span class="va">n.censor</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">time_start</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    std.error <span class="op">=</span> <span class="va">estimate</span> <span class="op">*</span> <span class="va">std.error</span>,</span>
<span>    interval <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    time_end <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">time_start</span>, default <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>    time_width <span class="op">=</span> <span class="va">time_end</span> <span class="op">-</span> <span class="va">time_start</span>,</span>
<span>    prob.estimate <span class="op">=</span> <span class="va">n.event</span> <span class="op">/</span> <span class="va">n.risk</span>,</span>
<span>    <span class="co"># Note that although there is no Kaplan-Meier-type hazard estimate, this</span></span>
<span>    <span class="co"># statistic forms the basis of other descriptive methods discussed below.</span></span>
<span>    <span class="co"># The values depicted here differ slightly from the text because Singer and</span></span>
<span>    <span class="co"># Willett (2003) rounded the probability estimates before estimating the</span></span>
<span>    <span class="co"># hazard.</span></span>
<span>    haz.estimate <span class="op">=</span> <span class="va">prob.estimate</span> <span class="op">/</span> <span class="va">time_width</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">interval</span>,</span>
<span>    <span class="va">time_start</span>,</span>
<span>    <span class="va">time_end</span>,</span>
<span>    <span class="va">n.risk</span><span class="op">:</span><span class="va">n.censor</span>,</span>
<span>    <span class="va">prob.estimate</span>,</span>
<span>    surv.estimate <span class="op">=</span> <span class="va">estimate</span>,</span>
<span>    <span class="va">std.error</span>,</span>
<span>    <span class="va">time_width</span>,</span>
<span>    <span class="va">haz.estimate</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 13.3, page 484:</span></span>
<span><span class="va">honking_lifetable_km</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prob.estimate</span>, <span class="va">surv.estimate</span>, <span class="va">std.error</span>, <span class="va">haz.estimate</span><span class="op">)</span>,</span>
<span>    decimals <span class="op">=</span> <span class="fl">4</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="eexombwkke" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eexombwkke table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eexombwkke thead, #eexombwkke tbody, #eexombwkke tfoot, #eexombwkke tr, #eexombwkke td, #eexombwkke th {
  border-style: none;
}

#eexombwkke p {
  margin: 0;
  padding: 0;
}

#eexombwkke .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eexombwkke .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eexombwkke .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eexombwkke .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eexombwkke .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eexombwkke .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eexombwkke .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eexombwkke .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eexombwkke .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eexombwkke .gt_spanner_row {
  border-bottom-style: hidden;
}

#eexombwkke .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eexombwkke .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eexombwkke .gt_from_md > :first-child {
  margin-top: 0;
}

#eexombwkke .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eexombwkke .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eexombwkke .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eexombwkke .gt_row_group_first td {
  border-top-width: 2px;
}

#eexombwkke .gt_row_group_first th {
  border-top-width: 2px;
}

#eexombwkke .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eexombwkke .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eexombwkke .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_left {
  text-align: left;
}

#eexombwkke .gt_center {
  text-align: center;
}

#eexombwkke .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eexombwkke .gt_font_normal {
  font-weight: normal;
}

#eexombwkke .gt_font_bold {
  font-weight: bold;
}

#eexombwkke .gt_font_italic {
  font-style: italic;
}

#eexombwkke .gt_super {
  font-size: 65%;
}

#eexombwkke .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eexombwkke .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eexombwkke .gt_indent_1 {
  text-indent: 5px;
}

#eexombwkke .gt_indent_2 {
  text-indent: 10px;
}

#eexombwkke .gt_indent_3 {
  text-indent: 15px;
}

#eexombwkke .gt_indent_4 {
  text-indent: 20px;
}

#eexombwkke .gt_indent_5 {
  text-indent: 25px;
}

#eexombwkke .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eexombwkke div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="interval">interval</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="time_start">time_start</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="time_end">time_end</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n.risk">n.risk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n.event">n.event</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n.censor">n.censor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="prob.estimate">prob.estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="surv.estimate">surv.estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="time_width">time_width</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="haz.estimate">haz.estimate</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="interval" class="gt_row gt_right">0</td>
<td headers="time_start" class="gt_row gt_right">0.00</td>
<td headers="time_end" class="gt_row gt_right">1.41</td>
<td headers="n.risk" class="gt_row gt_right">57</td>
<td headers="n.event" class="gt_row gt_right">0</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0000</td>
<td headers="surv.estimate" class="gt_row gt_right">1.0000</td>
<td headers="std.error" class="gt_row gt_right">0.0000</td>
<td headers="time_width" class="gt_row gt_right">1.41</td>
<td headers="haz.estimate" class="gt_row gt_right">0.0000</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">1</td>
<td headers="time_start" class="gt_row gt_right">1.41</td>
<td headers="time_end" class="gt_row gt_right">1.51</td>
<td headers="n.risk" class="gt_row gt_right">57</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0175</td>
<td headers="surv.estimate" class="gt_row gt_right">0.9825</td>
<td headers="std.error" class="gt_row gt_right">0.0174</td>
<td headers="time_width" class="gt_row gt_right">0.10</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1754</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">2</td>
<td headers="time_start" class="gt_row gt_right">1.51</td>
<td headers="time_end" class="gt_row gt_right">1.67</td>
<td headers="n.risk" class="gt_row gt_right">55</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0182</td>
<td headers="surv.estimate" class="gt_row gt_right">0.9646</td>
<td headers="std.error" class="gt_row gt_right">0.0246</td>
<td headers="time_width" class="gt_row gt_right">0.16</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1136</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">3</td>
<td headers="time_start" class="gt_row gt_right">1.67</td>
<td headers="time_end" class="gt_row gt_right">1.68</td>
<td headers="n.risk" class="gt_row gt_right">54</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0185</td>
<td headers="surv.estimate" class="gt_row gt_right">0.9467</td>
<td headers="std.error" class="gt_row gt_right">0.0299</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">1.8519</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">4</td>
<td headers="time_start" class="gt_row gt_right">1.68</td>
<td headers="time_end" class="gt_row gt_right">1.86</td>
<td headers="n.risk" class="gt_row gt_right">53</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0189</td>
<td headers="surv.estimate" class="gt_row gt_right">0.9289</td>
<td headers="std.error" class="gt_row gt_right">0.0343</td>
<td headers="time_width" class="gt_row gt_right">0.18</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1048</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">5</td>
<td headers="time_start" class="gt_row gt_right">1.86</td>
<td headers="time_end" class="gt_row gt_right">2.12</td>
<td headers="n.risk" class="gt_row gt_right">52</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0192</td>
<td headers="surv.estimate" class="gt_row gt_right">0.9110</td>
<td headers="std.error" class="gt_row gt_right">0.0380</td>
<td headers="time_width" class="gt_row gt_right">0.26</td>
<td headers="haz.estimate" class="gt_row gt_right">0.0740</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">6</td>
<td headers="time_start" class="gt_row gt_right">2.12</td>
<td headers="time_end" class="gt_row gt_right">2.19</td>
<td headers="n.risk" class="gt_row gt_right">51</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0196</td>
<td headers="surv.estimate" class="gt_row gt_right">0.8931</td>
<td headers="std.error" class="gt_row gt_right">0.0412</td>
<td headers="time_width" class="gt_row gt_right">0.07</td>
<td headers="haz.estimate" class="gt_row gt_right">0.2801</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">7</td>
<td headers="time_start" class="gt_row gt_right">2.19</td>
<td headers="time_end" class="gt_row gt_right">2.48</td>
<td headers="n.risk" class="gt_row gt_right">50</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0200</td>
<td headers="surv.estimate" class="gt_row gt_right">0.8753</td>
<td headers="std.error" class="gt_row gt_right">0.0441</td>
<td headers="time_width" class="gt_row gt_right">0.29</td>
<td headers="haz.estimate" class="gt_row gt_right">0.0690</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">8</td>
<td headers="time_start" class="gt_row gt_right">2.48</td>
<td headers="time_end" class="gt_row gt_right">2.50</td>
<td headers="n.risk" class="gt_row gt_right">48</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0208</td>
<td headers="surv.estimate" class="gt_row gt_right">0.8570</td>
<td headers="std.error" class="gt_row gt_right">0.0468</td>
<td headers="time_width" class="gt_row gt_right">0.02</td>
<td headers="haz.estimate" class="gt_row gt_right">1.0417</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">9</td>
<td headers="time_start" class="gt_row gt_right">2.50</td>
<td headers="time_end" class="gt_row gt_right">2.53</td>
<td headers="n.risk" class="gt_row gt_right">47</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0213</td>
<td headers="surv.estimate" class="gt_row gt_right">0.8388</td>
<td headers="std.error" class="gt_row gt_right">0.0492</td>
<td headers="time_width" class="gt_row gt_right">0.03</td>
<td headers="haz.estimate" class="gt_row gt_right">0.7092</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">10</td>
<td headers="time_start" class="gt_row gt_right">2.53</td>
<td headers="time_end" class="gt_row gt_right">2.54</td>
<td headers="n.risk" class="gt_row gt_right">46</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0217</td>
<td headers="surv.estimate" class="gt_row gt_right">0.8206</td>
<td headers="std.error" class="gt_row gt_right">0.0514</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">2.1739</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">11</td>
<td headers="time_start" class="gt_row gt_right">2.54</td>
<td headers="time_end" class="gt_row gt_right">2.56</td>
<td headers="n.risk" class="gt_row gt_right">45</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0222</td>
<td headers="surv.estimate" class="gt_row gt_right">0.8023</td>
<td headers="std.error" class="gt_row gt_right">0.0534</td>
<td headers="time_width" class="gt_row gt_right">0.02</td>
<td headers="haz.estimate" class="gt_row gt_right">1.1111</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">12</td>
<td headers="time_start" class="gt_row gt_right">2.56</td>
<td headers="time_end" class="gt_row gt_right">2.62</td>
<td headers="n.risk" class="gt_row gt_right">44</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0227</td>
<td headers="surv.estimate" class="gt_row gt_right">0.7841</td>
<td headers="std.error" class="gt_row gt_right">0.0552</td>
<td headers="time_width" class="gt_row gt_right">0.06</td>
<td headers="haz.estimate" class="gt_row gt_right">0.3788</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">13</td>
<td headers="time_start" class="gt_row gt_right">2.62</td>
<td headers="time_end" class="gt_row gt_right">2.68</td>
<td headers="n.risk" class="gt_row gt_right">43</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0233</td>
<td headers="surv.estimate" class="gt_row gt_right">0.7659</td>
<td headers="std.error" class="gt_row gt_right">0.0569</td>
<td headers="time_width" class="gt_row gt_right">0.06</td>
<td headers="haz.estimate" class="gt_row gt_right">0.3876</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">14</td>
<td headers="time_start" class="gt_row gt_right">2.68</td>
<td headers="time_end" class="gt_row gt_right">2.83</td>
<td headers="n.risk" class="gt_row gt_right">42</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">2</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0238</td>
<td headers="surv.estimate" class="gt_row gt_right">0.7476</td>
<td headers="std.error" class="gt_row gt_right">0.0584</td>
<td headers="time_width" class="gt_row gt_right">0.15</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1587</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">15</td>
<td headers="time_start" class="gt_row gt_right">2.83</td>
<td headers="time_end" class="gt_row gt_right">2.88</td>
<td headers="n.risk" class="gt_row gt_right">39</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0256</td>
<td headers="surv.estimate" class="gt_row gt_right">0.7285</td>
<td headers="std.error" class="gt_row gt_right">0.0599</td>
<td headers="time_width" class="gt_row gt_right">0.05</td>
<td headers="haz.estimate" class="gt_row gt_right">0.5128</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">16</td>
<td headers="time_start" class="gt_row gt_right">2.88</td>
<td headers="time_end" class="gt_row gt_right">2.89</td>
<td headers="n.risk" class="gt_row gt_right">38</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0263</td>
<td headers="surv.estimate" class="gt_row gt_right">0.7093</td>
<td headers="std.error" class="gt_row gt_right">0.0614</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">2.6316</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">17</td>
<td headers="time_start" class="gt_row gt_right">2.89</td>
<td headers="time_end" class="gt_row gt_right">2.92</td>
<td headers="n.risk" class="gt_row gt_right">37</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0270</td>
<td headers="surv.estimate" class="gt_row gt_right">0.6901</td>
<td headers="std.error" class="gt_row gt_right">0.0626</td>
<td headers="time_width" class="gt_row gt_right">0.03</td>
<td headers="haz.estimate" class="gt_row gt_right">0.9009</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">18</td>
<td headers="time_start" class="gt_row gt_right">2.92</td>
<td headers="time_end" class="gt_row gt_right">2.98</td>
<td headers="n.risk" class="gt_row gt_right">36</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0278</td>
<td headers="surv.estimate" class="gt_row gt_right">0.6710</td>
<td headers="std.error" class="gt_row gt_right">0.0637</td>
<td headers="time_width" class="gt_row gt_right">0.06</td>
<td headers="haz.estimate" class="gt_row gt_right">0.4630</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">19</td>
<td headers="time_start" class="gt_row gt_right">2.98</td>
<td headers="time_end" class="gt_row gt_right">3.14</td>
<td headers="n.risk" class="gt_row gt_right">35</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0286</td>
<td headers="surv.estimate" class="gt_row gt_right">0.6518</td>
<td headers="std.error" class="gt_row gt_right">0.0647</td>
<td headers="time_width" class="gt_row gt_right">0.16</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1786</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">20</td>
<td headers="time_start" class="gt_row gt_right">3.14</td>
<td headers="time_end" class="gt_row gt_right">3.17</td>
<td headers="n.risk" class="gt_row gt_right">33</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0303</td>
<td headers="surv.estimate" class="gt_row gt_right">0.6320</td>
<td headers="std.error" class="gt_row gt_right">0.0657</td>
<td headers="time_width" class="gt_row gt_right">0.03</td>
<td headers="haz.estimate" class="gt_row gt_right">1.0101</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">21</td>
<td headers="time_start" class="gt_row gt_right">3.17</td>
<td headers="time_end" class="gt_row gt_right">3.21</td>
<td headers="n.risk" class="gt_row gt_right">32</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0312</td>
<td headers="surv.estimate" class="gt_row gt_right">0.6123</td>
<td headers="std.error" class="gt_row gt_right">0.0666</td>
<td headers="time_width" class="gt_row gt_right">0.04</td>
<td headers="haz.estimate" class="gt_row gt_right">0.7812</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">22</td>
<td headers="time_start" class="gt_row gt_right">3.21</td>
<td headers="time_end" class="gt_row gt_right">3.22</td>
<td headers="n.risk" class="gt_row gt_right">31</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0323</td>
<td headers="surv.estimate" class="gt_row gt_right">0.5925</td>
<td headers="std.error" class="gt_row gt_right">0.0673</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">3.2258</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">23</td>
<td headers="time_start" class="gt_row gt_right">3.22</td>
<td headers="time_end" class="gt_row gt_right">3.24</td>
<td headers="n.risk" class="gt_row gt_right">30</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0333</td>
<td headers="surv.estimate" class="gt_row gt_right">0.5728</td>
<td headers="std.error" class="gt_row gt_right">0.0679</td>
<td headers="time_width" class="gt_row gt_right">0.02</td>
<td headers="haz.estimate" class="gt_row gt_right">1.6667</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">24</td>
<td headers="time_start" class="gt_row gt_right">3.24</td>
<td headers="time_end" class="gt_row gt_right">3.56</td>
<td headers="n.risk" class="gt_row gt_right">29</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0345</td>
<td headers="surv.estimate" class="gt_row gt_right">0.5530</td>
<td headers="std.error" class="gt_row gt_right">0.0684</td>
<td headers="time_width" class="gt_row gt_right">0.32</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1078</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">25</td>
<td headers="time_start" class="gt_row gt_right">3.56</td>
<td headers="time_end" class="gt_row gt_right">3.57</td>
<td headers="n.risk" class="gt_row gt_right">27</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0370</td>
<td headers="surv.estimate" class="gt_row gt_right">0.5325</td>
<td headers="std.error" class="gt_row gt_right">0.0688</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">3.7037</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">26</td>
<td headers="time_start" class="gt_row gt_right">3.57</td>
<td headers="time_end" class="gt_row gt_right">3.58</td>
<td headers="n.risk" class="gt_row gt_right">26</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0385</td>
<td headers="surv.estimate" class="gt_row gt_right">0.5121</td>
<td headers="std.error" class="gt_row gt_right">0.0692</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">3.8462</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">27</td>
<td headers="time_start" class="gt_row gt_right">3.58</td>
<td headers="time_end" class="gt_row gt_right">3.78</td>
<td headers="n.risk" class="gt_row gt_right">25</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0400</td>
<td headers="surv.estimate" class="gt_row gt_right">0.4916</td>
<td headers="std.error" class="gt_row gt_right">0.0694</td>
<td headers="time_width" class="gt_row gt_right">0.20</td>
<td headers="haz.estimate" class="gt_row gt_right">0.2000</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">28</td>
<td headers="time_start" class="gt_row gt_right">3.78</td>
<td headers="time_end" class="gt_row gt_right">4.10</td>
<td headers="n.risk" class="gt_row gt_right">24</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0417</td>
<td headers="surv.estimate" class="gt_row gt_right">0.4711</td>
<td headers="std.error" class="gt_row gt_right">0.0694</td>
<td headers="time_width" class="gt_row gt_right">0.32</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1302</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">29</td>
<td headers="time_start" class="gt_row gt_right">4.10</td>
<td headers="time_end" class="gt_row gt_right">4.18</td>
<td headers="n.risk" class="gt_row gt_right">22</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0455</td>
<td headers="surv.estimate" class="gt_row gt_right">0.4497</td>
<td headers="std.error" class="gt_row gt_right">0.0695</td>
<td headers="time_width" class="gt_row gt_right">0.08</td>
<td headers="haz.estimate" class="gt_row gt_right">0.5682</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">30</td>
<td headers="time_start" class="gt_row gt_right">4.18</td>
<td headers="time_end" class="gt_row gt_right">4.44</td>
<td headers="n.risk" class="gt_row gt_right">21</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0476</td>
<td headers="surv.estimate" class="gt_row gt_right">0.4283</td>
<td headers="std.error" class="gt_row gt_right">0.0694</td>
<td headers="time_width" class="gt_row gt_right">0.26</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1832</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">31</td>
<td headers="time_start" class="gt_row gt_right">4.44</td>
<td headers="time_end" class="gt_row gt_right">4.51</td>
<td headers="n.risk" class="gt_row gt_right">19</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0526</td>
<td headers="surv.estimate" class="gt_row gt_right">0.4057</td>
<td headers="std.error" class="gt_row gt_right">0.0693</td>
<td headers="time_width" class="gt_row gt_right">0.07</td>
<td headers="haz.estimate" class="gt_row gt_right">0.7519</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">32</td>
<td headers="time_start" class="gt_row gt_right">4.51</td>
<td headers="time_end" class="gt_row gt_right">4.52</td>
<td headers="n.risk" class="gt_row gt_right">18</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0556</td>
<td headers="surv.estimate" class="gt_row gt_right">0.3832</td>
<td headers="std.error" class="gt_row gt_right">0.0690</td>
<td headers="time_width" class="gt_row gt_right">0.01</td>
<td headers="haz.estimate" class="gt_row gt_right">5.5556</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">33</td>
<td headers="time_start" class="gt_row gt_right">4.52</td>
<td headers="time_end" class="gt_row gt_right">4.96</td>
<td headers="n.risk" class="gt_row gt_right">17</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">2</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0588</td>
<td headers="surv.estimate" class="gt_row gt_right">0.3606</td>
<td headers="std.error" class="gt_row gt_right">0.0686</td>
<td headers="time_width" class="gt_row gt_right">0.44</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1337</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">34</td>
<td headers="time_start" class="gt_row gt_right">4.96</td>
<td headers="time_end" class="gt_row gt_right">5.39</td>
<td headers="n.risk" class="gt_row gt_right">14</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0714</td>
<td headers="surv.estimate" class="gt_row gt_right">0.3349</td>
<td headers="std.error" class="gt_row gt_right">0.0683</td>
<td headers="time_width" class="gt_row gt_right">0.43</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1661</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">35</td>
<td headers="time_start" class="gt_row gt_right">5.39</td>
<td headers="time_end" class="gt_row gt_right">5.73</td>
<td headers="n.risk" class="gt_row gt_right">12</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0833</td>
<td headers="surv.estimate" class="gt_row gt_right">0.3070</td>
<td headers="std.error" class="gt_row gt_right">0.0681</td>
<td headers="time_width" class="gt_row gt_right">0.34</td>
<td headers="haz.estimate" class="gt_row gt_right">0.2451</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">36</td>
<td headers="time_start" class="gt_row gt_right">5.73</td>
<td headers="time_end" class="gt_row gt_right">6.03</td>
<td headers="n.risk" class="gt_row gt_right">11</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.0909</td>
<td headers="surv.estimate" class="gt_row gt_right">0.2791</td>
<td headers="std.error" class="gt_row gt_right">0.0674</td>
<td headers="time_width" class="gt_row gt_right">0.30</td>
<td headers="haz.estimate" class="gt_row gt_right">0.3030</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">37</td>
<td headers="time_start" class="gt_row gt_right">6.03</td>
<td headers="time_end" class="gt_row gt_right">6.30</td>
<td headers="n.risk" class="gt_row gt_right">9</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.1111</td>
<td headers="surv.estimate" class="gt_row gt_right">0.2481</td>
<td headers="std.error" class="gt_row gt_right">0.0666</td>
<td headers="time_width" class="gt_row gt_right">0.27</td>
<td headers="haz.estimate" class="gt_row gt_right">0.4115</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">38</td>
<td headers="time_start" class="gt_row gt_right">6.30</td>
<td headers="time_end" class="gt_row gt_right">7.20</td>
<td headers="n.risk" class="gt_row gt_right">7</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.1429</td>
<td headers="surv.estimate" class="gt_row gt_right">0.2126</td>
<td headers="std.error" class="gt_row gt_right">0.0659</td>
<td headers="time_width" class="gt_row gt_right">0.90</td>
<td headers="haz.estimate" class="gt_row gt_right">0.1587</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">39</td>
<td headers="time_start" class="gt_row gt_right">7.20</td>
<td headers="time_end" class="gt_row gt_right">9.59</td>
<td headers="n.risk" class="gt_row gt_right">5</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2000</td>
<td headers="surv.estimate" class="gt_row gt_right">0.1701</td>
<td headers="std.error" class="gt_row gt_right">0.0650</td>
<td headers="time_width" class="gt_row gt_right">2.39</td>
<td headers="haz.estimate" class="gt_row gt_right">0.0837</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">40</td>
<td headers="time_start" class="gt_row gt_right">9.59</td>
<td headers="time_end" class="gt_row gt_right">12.29</td>
<td headers="n.risk" class="gt_row gt_right">4</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.2500</td>
<td headers="surv.estimate" class="gt_row gt_right">0.1276</td>
<td headers="std.error" class="gt_row gt_right">0.0611</td>
<td headers="time_width" class="gt_row gt_right">2.70</td>
<td headers="haz.estimate" class="gt_row gt_right">0.0926</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">41</td>
<td headers="time_start" class="gt_row gt_right">12.29</td>
<td headers="time_end" class="gt_row gt_right">13.18</td>
<td headers="n.risk" class="gt_row gt_right">3</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">0</td>
<td headers="prob.estimate" class="gt_row gt_right">0.3333</td>
<td headers="surv.estimate" class="gt_row gt_right">0.0851</td>
<td headers="std.error" class="gt_row gt_right">0.0535</td>
<td headers="time_width" class="gt_row gt_right">0.89</td>
<td headers="haz.estimate" class="gt_row gt_right">0.3745</td>
</tr>
<tr>
<td headers="interval" class="gt_row gt_right">42</td>
<td headers="time_start" class="gt_row gt_right">13.18</td>
<td headers="time_end" class="gt_row gt_right">Inf</td>
<td headers="n.risk" class="gt_row gt_right">2</td>
<td headers="n.event" class="gt_row gt_right">1</td>
<td headers="n.censor" class="gt_row gt_right">1</td>
<td headers="prob.estimate" class="gt_row gt_right">0.5000</td>
<td headers="surv.estimate" class="gt_row gt_right">0.0425</td>
<td headers="std.error" class="gt_row gt_right">0.0403</td>
<td headers="time_width" class="gt_row gt_right">Inf</td>
<td headers="haz.estimate" class="gt_row gt_right">0.0000</td>
</tr>
</tbody>
</table>
</div>
<p>Finally, we can plot the Kaplan-Meier estimates of the continuous
time survival function, and compare them with the discrete-time and
actuarial estimates. Note that for plotting, we prefer the grouped life
table with uncensored and censored intervals. This is because, if the
largest event time is censored (as it is here), it allows us to extend
the last interval of the step function out to that largest censored
value rather than going to infinity. Therefore, here we re-tidy the
<code>honking_survfit</code> object rather than using the
<code>honking_lifetable_km</code> grouped life table.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_surv.km</span> <span class="op">&lt;-</span> <span class="va">honking_survfit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit0.html" class="external-link">survfit0</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>seconds <span class="op">=</span> <span class="va">time</span>, surv.estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="st">"Kaplan-Meier"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kaplan-Meier"</span>, <span class="st">"discrete-time"</span>, <span class="st">"actuarial"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">seconds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">surv.estimate</span>, linetype <span class="op">=</span> <span class="va">method</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"hv"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">honking_survs</span> <span class="op">&lt;-</span> <span class="va">honking_surv.km</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">surv.discrete</span>, linetype <span class="op">=</span> <span class="st">"discrete-time"</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">honking_plot</span><span class="op">$</span><span class="va">data</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.33</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">surv.actuarial</span>, linetype <span class="op">=</span> <span class="st">"actuarial"</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">honking_plot</span><span class="op">$</span><span class="va">data</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"vh"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.33</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 13.2, page 485:</span></span>
<span><span class="va">honking_surv.km</span> <span class="op">+</span> <span class="va">honking_survs</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span>, axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="the-cumulative-hazard-function">13.4 The cumulative hazard function<a class="anchor" aria-label="anchor" href="#the-cumulative-hazard-function"></a>
</h2>
<p>In Section 13.4 Singer and Willett (2003) introduce the
<strong>cumulative hazard function</strong>, which is the <em>integral
of the hazard function</em> between the integration limits of time 0 and
time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(i.e., the “accumulation” of the hazard over time), given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>t</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
H(t_{ij}) = \int_0^t h(t_{ij}) d t.
</annotation></semantics></math></p>
<p>There are two simple ways to estimate the cumulative hazard
function:</p>
<ul>
<li>
<p>The <strong>Nelson-Aalen method</strong> accumulates the
estimated total amount of hazard during all instants in each interval,
given by the product of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
Kaplan-Meier–type hazard estimate and its interval’s width:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>H</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">NA</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mover><mi>h</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">KM</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mtext mathvariant="normal">width</mtext><mn>1</mn></msub><mo>+</mo><msub><mover><mi>h</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">KM</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mtext mathvariant="normal">width</mtext><mn>2</mn></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mover><mi>h</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">KM</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mtext mathvariant="normal">width</mtext><mi>j</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat H_\text{NA}(t_j) = \hat h_\text{KM}(t_1) \text{width}_1
  + \hat h_\text{KM}(t_2) \text{width}_2
  + \dots
  + \hat h_\text{KM}(t_j) \text{width}_j.
</annotation></semantics></math></p>
</li>
<li>
<p>The <strong>negative log survivor function method</strong>
exploits a well-known mathematical relationship between the cumulative
hazard and survivor functions, which is that the population cumulative
hazard function is identical to the negative log of the population
survivor function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>H</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mtext mathvariant="normal">LS</mtext></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mo>log</mo><msub><mover><mi>S</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">KM</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat H_{-\text{LS}}(t_j) = -\log \hat S_\text{KM}(t_{ij}).
</annotation></semantics></math></p>
</li>
</ul>
<p>Here we will use both of these methods to plot cumulative hazard
functions from the <code>honking_survfit</code> object. Notice that the
the estimates are most similar during early event times, when the risk
set is large, diverging as the size of the risk set decreases.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_lifetable_km_2</span> <span class="op">&lt;-</span> <span class="va">honking_survfit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit0.html" class="external-link">survfit0</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    time_end <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">time</span>, default <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="va">time_end</span> <span class="op">-</span> <span class="va">time</span>,</span>
<span>    prob.estimate <span class="op">=</span> <span class="va">n.event</span> <span class="op">/</span> <span class="va">n.risk</span>,</span>
<span>    haz.estimate <span class="op">=</span> <span class="va">prob.estimate</span> <span class="op">/</span> <span class="va">width</span>,</span>
<span>    cumhaz.nelson_aalen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit0.html" class="external-link">survfit0</a></span><span class="op">(</span><span class="va">honking_survfit</span><span class="op">)</span><span class="op">[[</span><span class="st">"cumhaz"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    cumhaz.neglogsurv <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>seconds <span class="op">=</span> <span class="va">time</span>, surv.estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 13.4, page 493:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">honking_lifetable_km_2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">seconds</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">cumhaz.neglogsurv</span>, linetype <span class="op">=</span> <span class="st">"Negative log"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"vh"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">cumhaz.nelson_aalen</span>, linetype <span class="op">=</span> <span class="st">"Nelson-Aalen"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"vh"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"cumhaz.estimate"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"method"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>When examining plots of the cumulative hazard function, Singer and
Willett (2003) suggest studying how the <em>rate of increase</em> in the
cumulative hazard function <em>changes over time</em> to deduce the
shape of the underlying hazard function:</p>
<ul>
<li>A <em>linear</em> rate of increase suggests a constant hazard.</li>
<li>An <em>accelerating</em> rate of increase suggests an increasing
hazard.</li>
<li>A <em>decelerating</em> rate of increase suggests a decreasing
hazard.</li>
<li>A <em>changing</em> rate of increase suggests that the hazard
function has reached either a peak or a trough.</li>
</ul>
</div>
<div class="section level2">
<h2 id="kernel-smoothed-estimates-of-the-hazard-function">13.5 Kernel-smoothed estimates of the hazard function<a class="anchor" aria-label="anchor" href="#kernel-smoothed-estimates-of-the-hazard-function"></a>
</h2>
<p>In Section 13.5 Singer and Willett (2003) discuss how to visualize
the underlying shape of the continuous-time hazard function using
<strong>kernel-smoothed estimates</strong>, which estimate the “average”
population value of hazard at many focal points in time by aggregating
together all the point estimates in their temporal vicinity.</p>
<p>The <code><a href="https://rdrr.io/pkg/muhaz/man/muhaz.html" class="external-link">muhaz()</a></code> function from the <strong>muhaz</strong>
package can be used to estimate the kernel-smoothed hazard function from
right-censored data. For details on how the <code><a href="https://rdrr.io/pkg/muhaz/man/muhaz.html" class="external-link">muhaz()</a></code>
function works, consult the function documentation.</p>
<p>Here we will estimate and plot kernel-smooth hazard functions for the
<code>honking</code> data with bandwidths of 1, 2, and 3. Notice that as
the bandwidth increases, the shape of the function becomes smoother. As
Singer and Willett (2003) discuss, this suggests a need to explore a
range of bandwidths to strike a balance between smooth and precise
realizations of the underlying shape of the hazard function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">honking_smoothhaz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.bandwidth</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># muhaz() estimates the hazard function from right-censored data using</span></span>
<span>    <span class="co"># kernel-based methods, using the vector of survival and event times.</span></span>
<span>    <span class="va">kernel_smoothed_hazard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/muhaz/man/muhaz.html" class="external-link">muhaz</a></span><span class="op">(</span></span>
<span>      <span class="va">honking</span><span class="op">$</span><span class="va">seconds</span>,</span>
<span>      <span class="fl">1</span> <span class="op">-</span> <span class="va">honking</span><span class="op">$</span><span class="va">censor</span>,</span>
<span>      <span class="co"># Narrow the temporal region the smoothed function describes, given the</span></span>
<span>      <span class="co"># bandwidth and the minimum and maximum observed event times.</span></span>
<span>      min.time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">honking</span><span class="op">$</span><span class="va">seconds</span><span class="op">[</span><span class="va">honking</span><span class="op">$</span><span class="va">censor</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">.bandwidth</span>,</span>
<span>      max.time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">honking</span><span class="op">$</span><span class="va">seconds</span><span class="op">[</span><span class="va">honking</span><span class="op">$</span><span class="va">censor</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">.bandwidth</span>,</span>
<span>      bw.grid <span class="op">=</span> <span class="va">.bandwidth</span>,</span>
<span>      bw.method <span class="op">=</span> <span class="st">"global"</span>,</span>
<span>      b.cor <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>      kern <span class="op">=</span> <span class="st">"epanechnikov"</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">kernel_smoothed_hazard</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>smoothhaz.estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"bandwidth"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 13.5, page 496:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">honking_smoothhaz</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">smoothhaz.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">bandwidth</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="developing-an-intuition-about-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions">13.6 Developing an intuition about continuous-time survivor,
cumulative hazard, and kernel-smoothed hazard functions<a class="anchor" aria-label="anchor" href="#developing-an-intuition-about-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions"></a>
</h2>
<p>In Section 13.6 Singer and Willett (2003) examine and describe the
survival functions, cumulative hazard functions, and kernel-smoothed
hazard functions from four studies that differ by their type of target
event, metric for clocking time, and underlying profile of risk:</p>
<ul>
<li>
<p><code>alcohol_relapse</code>: A person-level data frame with 89
rows and 3 columns containing a subset of data from Cooney and
colleagues (1991), who measured weeks to first “heavy drinking” day in a
sample of 89 recently treated alcoholics. Individuals were followed for
up to two years (around 104.286 weeks) or until they relapsed.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_relapse</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 89 × 3</span></span></span>
<span><span class="co">#&gt;    id    weeks censor</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1     0.714      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2     0.714      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3     1.14       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4     1.43       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5     1.71       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6     1.71       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7     2.14       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8     2.71       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9     3.86       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10    4.14       0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 79 more rows</span></span></span></code></pre></div>
</li>
<li>
<p><code>judges</code>: A person-level data frame with 109 rows and
7 columns containing data from Zorn and Van Winkle (2000) measuring how
long all 107 justices appointed to the U.S. Supreme Court between 1789
and 1980 remained in their position.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judges</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 109 × 7</span></span></span>
<span><span class="co">#&gt;    id    tenure  dead retired left_appointment appointment_age appointment_year</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          1     0       1                1              50             <span style="text-decoration: underline;">1</span>789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          6     0       1                1              57             <span style="text-decoration: underline;">1</span>789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          6     0       1                1              44             <span style="text-decoration: underline;">1</span>789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4          9     1       0                1              47             <span style="text-decoration: underline;">1</span>789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         21     1       0                1              57             <span style="text-decoration: underline;">1</span>789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          9     1       0                1              38             <span style="text-decoration: underline;">1</span>790</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          1     0       1                1              59             <span style="text-decoration: underline;">1</span>791</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         13     1       0                1              47             <span style="text-decoration: underline;">1</span>793</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          4     0       1                1              51             <span style="text-decoration: underline;">1</span>796</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10        15     1       0                1              55             <span style="text-decoration: underline;">1</span>796</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 99 more rows</span></span></span></code></pre></div>
</li>
<li>
<p><code>first_depression_2</code>: A person-level data frame with
2974 rows and 3 columns containing data from Sorenson, Rutter, and
Aneshensel (1991), who measured age of first depressive episode in a
sample of 2974 adults. Age of first depressive episode was measured by
asking respondents whether and, if so, at what age they first
experienced a depressive episode.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_depression_2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,974 × 3</span></span></span>
<span><span class="co">#&gt;    id      age censor</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         4      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2         6      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3         8      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         8      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         9      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6         9      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7        10      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8        10      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9        11      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       12      0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,964 more rows</span></span></span></code></pre></div>
</li>
<li>
<p><code>health_workers</code>: A person-level data frame with 2074
rows and 3 columns containing a subset of data from Singer and
colleagues (1998), who measured length of employment in a sample of 2074
health care workers hired by community and migrant health centres.
Health care workers were followed for up to 33 months or until
termination of employment.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">health_workers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,074 × 3</span></span></span>
<span><span class="co">#&gt;    id    weeks censor</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1      0.14      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2      0.42      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3      1         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4      1.28      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5      1.28      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6      1.71      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7      1.85      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8      1.85      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9      1.85      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10     2         1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,064 more rows</span></span></span></code></pre></div>
</li>
</ul>
<p>First we will estimate survival and cumulative hazard functions for
each of the studies.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_relapse_survfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">weeks</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">censor</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">alcohol_relapse</span></span>
<span><span class="op">)</span></span>
<span><span class="va">judges_survfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">tenure</span>, <span class="va">dead</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">judges</span></span>
<span><span class="op">)</span></span>
<span><span class="va">first_depression_survfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">censor</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">first_depression_2</span></span>
<span><span class="op">)</span></span>
<span><span class="va">health_workers_survfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">weeks</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">censor</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">health_workers</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">study_survfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  alcohol_relapse <span class="op">=</span> <span class="va">alcohol_relapse_survfit</span>,</span>
<span>  judges <span class="op">=</span> <span class="va">judges_survfit</span>,</span>
<span>  first_depression <span class="op">=</span> <span class="va">first_depression_survfit</span>,</span>
<span>  health_workers <span class="op">=</span> <span class="va">health_workers_survfit</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">study_lifetables</span> <span class="op">&lt;-</span> <span class="va">study_survfit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.survfit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.survfit</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit0.html" class="external-link">survfit0</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumhaz.estimate <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, surv.estimate <span class="op">=</span> <span class="va">estimate</span>, <span class="va">cumhaz.estimate</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">study_lifetables</span></span>
<span><span class="co">#&gt; $alcohol_relapse</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 65 × 3</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0             1              0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0.714         0.978          0.022<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1.14          0.966          0.034<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1.43          0.955          0.046<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.71          0.933          0.069<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2.14          0.921          0.081<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2.71          0.910          0.094<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3.86          0.899          0.107 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 4.14          0.888          0.119 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4.57          0.876          0.132 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 55 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $judges</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 34 × 3</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0         1              0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1         1              0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     2         0.981          0.019<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     3         0.981          0.019<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     4         0.972          0.028<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     5         0.932          0.070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     6         0.902          0.103 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     7         0.870          0.140 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     8         0.859          0.152 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     9         0.825          0.192 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 24 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $first_depression</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 85 × 3</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0         1            0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     4         1.00         0.000<span style="text-decoration: underline;">336</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     6         0.999        0.000<span style="text-decoration: underline;">673</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     8         0.999        0.001<span style="text-decoration: underline;">35</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     9         0.998        0.002<span style="text-decoration: underline;">02</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    10         0.997        0.002<span style="text-decoration: underline;">69</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    11         0.997        0.003<span style="text-decoration: underline;">03</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    12         0.996        0.003<span style="text-decoration: underline;">71</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    13         0.994        0.006<span style="text-decoration: underline;">07</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    14         0.993        0.007<span style="text-decoration: underline;">42</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 75 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $health_workers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 649 × 3</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0            1            0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  0.14         1.00         0.000<span style="text-decoration: underline;">482</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  0.42         1.00         0.000<span style="text-decoration: underline;">482</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  1            0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  1.28         0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  1.71         0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  1.85         0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  2            0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  2.14         0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  2.28         0.999        0.000<span style="text-decoration: underline;">965</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 639 more rows</span></span></span></code></pre></div>
<p>Second, we will estimate the kernel-smoothed hazard functions.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_smoothhaz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      alcohol_relapse <span class="op">=</span> <span class="va">alcohol_relapse</span><span class="op">$</span><span class="va">weeks</span>,</span>
<span>      judges <span class="op">=</span> <span class="va">judges</span><span class="op">$</span><span class="va">tenure</span>,</span>
<span>      first_depression <span class="op">=</span> <span class="va">first_depression_2</span><span class="op">$</span><span class="va">age</span>,</span>
<span>      health_workers <span class="op">=</span> <span class="va">health_workers</span><span class="op">$</span><span class="va">weeks</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fl">1</span> <span class="op">-</span> <span class="va">alcohol_relapse</span><span class="op">$</span><span class="va">censor</span>,</span>
<span>      <span class="va">judges</span><span class="op">$</span><span class="va">dead</span>,</span>
<span>      <span class="fl">1</span> <span class="op">-</span> <span class="va">first_depression_2</span><span class="op">$</span><span class="va">censor</span>,</span>
<span>      <span class="fl">1</span> <span class="op">-</span> <span class="va">health_workers</span><span class="op">$</span><span class="va">censor</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">survival_time</span>, <span class="va">event</span>, <span class="va">bandwidth</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">kernel_smoothed_hazard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/muhaz/man/muhaz.html" class="external-link">muhaz</a></span><span class="op">(</span></span>
<span>      <span class="va">survival_time</span>,</span>
<span>      <span class="va">event</span>,</span>
<span>      min.time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">survival_time</span><span class="op">[</span><span class="fl">1</span> <span class="op">-</span> <span class="va">event</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">bandwidth</span>,</span>
<span>      max.time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">survival_time</span><span class="op">[</span><span class="fl">1</span> <span class="op">-</span> <span class="va">event</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">bandwidth</span>,</span>
<span>      bw.grid <span class="op">=</span> <span class="va">bandwidth</span>,</span>
<span>      bw.method <span class="op">=</span> <span class="st">"global"</span>,</span>
<span>      b.cor <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>      kern <span class="op">=</span> <span class="st">"epanechnikov"</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">kernel_smoothed_hazard</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>smoothhaz.estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">study_smoothhaz</span></span>
<span><span class="co">#&gt; $alcohol_relapse</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 101 × 2</span></span></span>
<span><span class="co">#&gt;     time smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  12.7             0.034<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  13.5             0.034<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  14.2             0.034<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  15.0             0.034<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  15.8             0.034<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  16.5             0.033<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  17.3             0.032<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  18.0             0.032<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  18.8             0.030<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  19.6             0.029<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 91 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $judges</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 101 × 2</span></span></span>
<span><span class="co">#&gt;     time smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  7                0.024<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  7.22             0.024<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  7.44             0.024<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  7.66             0.023<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  7.88             0.023<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  8.1              0.023<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  8.32             0.023<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  8.54             0.023<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  8.76             0.022<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  8.98             0.022<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 91 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $first_depression</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 101 × 2</span></span></span>
<span><span class="co">#&gt;     time smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  11              0.001<span style="text-decoration: underline;">13</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  11.4            0.001<span style="text-decoration: underline;">22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  11.7            0.001<span style="text-decoration: underline;">31</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  12.1            0.001<span style="text-decoration: underline;">39</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  12.4            0.001<span style="text-decoration: underline;">49</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  12.8            0.001<span style="text-decoration: underline;">58</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  13.2            0.001<span style="text-decoration: underline;">67</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  13.5            0.001<span style="text-decoration: underline;">76</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  13.9            0.001<span style="text-decoration: underline;">84</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  14.2            0.001<span style="text-decoration: underline;">93</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 91 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $health_workers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 101 × 2</span></span></span>
<span><span class="co">#&gt;     time smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  7.14            0.002<span style="text-decoration: underline;">13</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  8.38            0.002<span style="text-decoration: underline;">40</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  9.63            0.002<span style="text-decoration: underline;">55</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10.9             0.002<span style="text-decoration: underline;">62</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 12.1             0.002<span style="text-decoration: underline;">62</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 13.4             0.002<span style="text-decoration: underline;">61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 14.6             0.002<span style="text-decoration: underline;">58</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 15.9             0.002<span style="text-decoration: underline;">47</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 17.1             0.002<span style="text-decoration: underline;">36</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 18.3             0.002<span style="text-decoration: underline;">30</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 91 more rows</span></span></span></code></pre></div>
<p>Third, we will join the survival and cumulative hazard function data
frames with the kernel-smoothed hazard function data frames.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_functions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>  <span class="va">study_lifetables</span>, <span class="va">study_smoothhaz</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">.y</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">study_functions</span></span>
<span><span class="co">#&gt; $alcohol_relapse</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 165 × 4</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0             1              0                      <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0.714         0.978          0.022<span style="text-decoration: underline;">7</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1.14          0.966          0.034<span style="text-decoration: underline;">3</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1.43          0.955          0.046<span style="text-decoration: underline;">0</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.71          0.933          0.069<span style="text-decoration: underline;">8</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2.14          0.921          0.081<span style="text-decoration: underline;">9</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2.71          0.910          0.094<span style="text-decoration: underline;">2</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3.86          0.899          0.107                  <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 4.14          0.888          0.119                  <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4.57          0.876          0.132                  <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 155 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $judges</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 4</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0            1              0                 <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  1            1              0                 <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  2            0.981          0.019<span style="text-decoration: underline;">0</span>            <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  3            0.981          0.019<span style="text-decoration: underline;">0</span>            <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  4            0.972          0.028<span style="text-decoration: underline;">8</span>            <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  5            0.932          0.070<span style="text-decoration: underline;">0</span>            <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  6            0.902          0.103             <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  7            0.870          0.140              0.024<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  7.22        <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>                  0.024<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  7.44        <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>                  0.024<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 122 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $first_depression</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 181 × 4</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0           1            0                  <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   4           1.00         0.000<span style="text-decoration: underline;">336</span>           <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   6           0.999        0.000<span style="text-decoration: underline;">673</span>           <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   8           0.999        0.001<span style="text-decoration: underline;">35</span>            <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   9           0.998        0.002<span style="text-decoration: underline;">02</span>            <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  10           0.997        0.002<span style="text-decoration: underline;">69</span>            <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  11           0.997        0.003<span style="text-decoration: underline;">03</span>             0.001<span style="text-decoration: underline;">13</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  11.4        <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>                   0.001<span style="text-decoration: underline;">22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  11.7        <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>                   0.001<span style="text-decoration: underline;">31</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12           0.996        0.003<span style="text-decoration: underline;">71</span>            <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 171 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $health_workers</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 749 × 4</span></span></span>
<span><span class="co">#&gt;     time surv.estimate cumhaz.estimate smoothhaz.estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0            1            0                        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  0.14         1.00         0.000<span style="text-decoration: underline;">482</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  0.42         1.00         0.000<span style="text-decoration: underline;">482</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  1            0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  1.28         0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  1.71         0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  1.85         0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  2            0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  2.14         0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  2.28         0.999        0.000<span style="text-decoration: underline;">965</span>                 <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 739 more rows</span></span></span></code></pre></div>
<p>Finally, we can plot the functions for each of the studies.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">study_functions</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">130</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"weeks"</span>, <span class="st">"years"</span>, <span class="st">"age"</span>, <span class="st">"weeks"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.study</span>, <span class="va">.xlim</span>, <span class="va">.time</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">study_surv</span> <span class="op">&lt;-</span> <span class="va">.study</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">surv.estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">surv.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">.xlim</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">study_cumhaz</span> <span class="op">&lt;-</span> <span class="va">.study</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">cumhaz.estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">cumhaz.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">.xlim</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">study_smoothhaz</span> <span class="op">&lt;-</span> <span class="va">.study</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">smoothhaz.estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">smoothhaz.estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">.xlim</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">study_surv</span> <span class="op">/</span> <span class="va">study_cumhaz</span> <span class="op">/</span> <span class="va">study_smoothhaz</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>First, the <code>alcohol_relapse</code> data.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 13.6, page 499:</span></span>
<span><span class="va">study_plots</span><span class="op">$</span><span class="va">alcohol_relapse</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Second, the <code>judges</code> data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 13.6, page 499:</span></span>
<span><span class="va">study_plots</span><span class="op">$</span><span class="va">judges</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>Third, the <code>first_depression</code> data.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 13.6, page 499:</span></span>
<span><span class="va">study_plots</span><span class="op">$</span><span class="va">first_depression</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Finally, the <code>health_workers</code> data.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 13.6, page 499:</span></span>
<span><span class="va">study_plots</span><span class="op">$</span><span class="va">health_workers</span></span></code></pre></div>
<p><img src="chapter-13_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael McCarthy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
