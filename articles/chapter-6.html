<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="alda">
<title>Chapter 6: Modeling Discontinuous and Nonlinear Change • alda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 6: Modeling Discontinuous and Nonlinear Change">
<meta property="og:description" content="alda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">alda</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tips-amp-tricks">Tips &amp; Tricks</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tips-amp-tricks">
    <a class="dropdown-item" href="../articles/longitudinal-data-organization.html">Longitudinal data organization</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-textbook-examples">Textbook examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-textbook-examples">
    <h6 class="dropdown-header" data-toc-skip>Longitudinal mixed effects modelling</h6>
    <a class="dropdown-item" href="../articles/chapter-2.html">Chapter 2</a>
    <a class="dropdown-item" href="../articles/chapter-3.html">Chapter 3</a>
    <a class="dropdown-item" href="../articles/chapter-4.html">Chapter 4</a>
    <a class="dropdown-item" href="../articles/chapter-5.html">Chapter 5</a>
    <a class="dropdown-item" href="../articles/chapter-6.html">Chapter 6</a>
    <a class="dropdown-item" href="../articles/chapter-7.html">Chapter 7</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Longitudinal structural equation modelling</h6>
    <a class="dropdown-item" href="../articles/chapter-8.html">Chapter 8</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Survival analysis</h6>
    <a class="dropdown-item" href="../articles/chapter-9.html">Chapter 9</a>
    <a class="dropdown-item" href="../articles/chapter-10.html">Chapter 10</a>
    <a class="dropdown-item" href="../articles/chapter-11.html">Chapter 11</a>
    <a class="dropdown-item" href="../articles/chapter-12.html">Chapter 12</a>
    <a class="dropdown-item" href="../articles/chapter-13.html">Chapter 13</a>
    <a class="dropdown-item" href="../articles/chapter-14.html">Chapter 14</a>
    <a class="dropdown-item" href="../articles/chapter-15.html">Chapter 15</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mccarthy-m-g/alda/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Chapter 6: Modeling Discontinuous and Nonlinear Change</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mccarthy-m-g/alda/blob/HEAD/vignettes/articles/chapter-6.Rmd" class="external-link"><code>vignettes/articles/chapter-6.Rmd</code></a></small>
      <div class="d-none name"><code>chapter-6.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mccarthy-m-g.github.io/alda/">alda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed" class="external-link">broom.mixed</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/" class="external-link">modelbased</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modelsummary.com" class="external-link">modelsummary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="discontinuous-individual-change">6.1 Discontinuous Individual Change<a class="anchor" aria-label="anchor" href="#discontinuous-individual-change"></a>
</h2>
<p>In Section 6.1, Singer and Willett (2003) discuss strategies for
fitting <strong>discontinuous individual change trajectories</strong>
using a subset of data from the National Longitudinal Study of Youth
tracking the labour market experiences of male high school dropouts
(Murnane, Boudett, &amp; Willett, 1999).</p>
<p>For this example we return to the <code>dropout_wages</code> data set
introduced in Chapter 5, a person-period data frame with 6402 rows and 9
columns:</p>
<ul>
<li>
<code>id</code>: Participant ID.</li>
<li>
<code>log_wages</code>: Natural logarithm of wages.</li>
<li>
<code>experience</code>: Labour force experience in years, tracked
from dropouts’ first day of work.</li>
<li>
<code>ged</code>: Binary indicator for whether the dropout obtained
a GED.</li>
<li>
<code>postsecondary_education</code>: Binary indicator for whether
the dropout obtained post-secondary education.</li>
<li>
<code>black</code>: Binary indicator for whether the dropout is
black.</li>
<li>
<code>hispanic</code>: Binary indicator for whether the dropout is
hispanic.</li>
<li>
<code>highest_grade</code>: Highest grade completed.</li>
<li>
<code>unemployment_rate</code>: Unemployment rate in the local
geographic area.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,402 × 9</span></span></span>
<span><span class="co">#&gt;    id    log_wages experience   ged postsecondary_education black hispanic</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 31         1.49      0.015     1                   0.015     0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 31         1.43      0.715     1                   0.715     0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 31         1.47      1.73      1                   1.73      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 31         1.75      2.77      1                   2.77      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 31         1.93      3.93      1                   3.93      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 31         1.71      4.95      1                   4.95      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 31         2.09      5.96      1                   5.96      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 31         2.13      6.98      1                   6.98      0        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 36         1.98      0.315     1                   0.315     0        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 36         1.80      0.983     1                   0.983     0        0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6,392 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: highest_grade &lt;dbl&gt;, unemployment_rate &lt;dbl&gt;</span></span></span></code></pre></div>
<p>As we demonstrated in Section 5.3, the inclusion of one (or more)
time-varying predictor(s) in your level-1 individual growth model can be
used to model discontinuous individual change trajectories. As Singer
and Willett (2003) discuss, the <code>dropout_wages</code> data contains
several time-varying predictors that can be used to model different
forms of discontinuous change. We can see the behaviour of each of these
predictors by examining the data from a subset of individuals:</p>
<ul>
<li>
<code>ged</code>: An immediate shift in elevation, but no shift in
slope.</li>
<li>
<code>postsecondary_education</code>: An immediate shift in slope,
but no shift in elevation.</li>
<li>
<code>ged_x_experience</code>: Immediate shifts in both elevation
and slope.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 6.1, page 192:</span></span>
<span><span class="va">dropout_wages</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">206</span>, <span class="fl">2365</span>, <span class="fl">4384</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">log_wages</span>, <span class="va">experience</span>, <span class="va">ged</span>, <span class="va">postsecondary_education</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ged_x_experience <span class="op">=</span> <span class="va">ged</span> <span class="op">*</span> <span class="va">experience</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">22</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 22 × 6</span></span></span>
<span><span class="co">#&gt;    id    log_wages experience   ged postsecondary_education ged_x_experience</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 206        2.03      1.87      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 206        2.30      2.81      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 206        2.48      4.31      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2365       1.78      0.66      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2365       1.76      1.68      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2365       1.71      2.74      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2365       1.74      3.68      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2365       2.19      4.68      1                    0                4.68</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2365       2.04      5.72      1                    1.04             5.72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2365       2.32      6.72      1                    2.04             6.72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2365       2.66      7.87      1                    3.19             7.87</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2365       2.42      9.08      1                    4.40             9.08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2365       2.39     10.0       1                    5.36            10.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 2365       2.48     11.1       1                    6.44            11.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2365       2.44     12.0       1                    7.36            12.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 4384       2.86      0.096     0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 4384       1.53      1.04      0                    0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 4384       1.59      1.73      1                    0                1.73</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 4384       1.97      3.13      1                    1.40             3.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 4384       1.68      4.28      1                    2.56             4.28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span> 4384       2.62      5.72      1                    4.00             5.72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span> 4384       2.58      6.02      1                    4.30             6.02</span></span></code></pre></div>
<p>Here we will fit ten models to the <code>dropout_wages</code>
data:</p>
<ul>
<li>Model A: A baseline model.</li>
<li>Model B: A model that adds a discontinuity in elevation, but not
slope, by including fixed and random effects for <code>ged</code>.</li>
<li>Model C: A model that excludes the variance/covariance components
associated with <code>ged</code> in Model B.</li>
<li>Model D: A model that adds a discontinuity in slope, but not
elevation, by including fixed and random effects for
<code>postsecondary_education</code>.</li>
<li>Model E: A model that excludes the variance/covariance components
associated with <code>postsecondary_education</code> in Model D.</li>
<li>Model F: A model that adds a discontinuity in elevation and slope by
including fixed and random effects for <code>ged</code> and
<code>postsecondary_education</code>.</li>
<li>Model G: A model that excludes the variance/covariance components
associated with <code>postsecondary_education</code> in Model F.</li>
<li>Model H: A model that excludes the variance/covariance components
associated with <code>ged</code> in Model F.</li>
<li>Model I: A model that adds a discontinuity in elevation and slope by
including fixed and random effects for <code>ged</code> and the
interaction between <code>ged</code> and <code>experience</code>.</li>
<li>Model J: A model that excludes the variance/covariance components
associated with the interaction between <code>ged</code> and
<code>experience</code> in Model I.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">dropout_wages_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">log_wages</span> <span class="op">~</span></span>
<span>    <span class="va">experience</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">highest_grade</span> <span class="op">-</span> <span class="fl">9</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">experience</span><span class="op">:</span><span class="va">black</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">unemployment_rate</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dropout_wages</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">ged</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">+</span> <span class="va">postsecondary_education</span></span>
<span>    <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">postsecondary_education</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">postsecondary_education</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">+</span> <span class="va">ged</span></span>
<span>    <span class="op">+</span> <span class="va">postsecondary_education</span></span>
<span>    <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">+</span> <span class="va">postsecondary_education</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_F</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">+</span> <span class="va">postsecondary_education</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_F</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">+</span> <span class="va">postsecondary_education</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">postsecondary_education</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_A</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">+</span> <span class="va">ged</span></span>
<span>    <span class="op">+</span> <span class="va">experience</span><span class="op">:</span><span class="va">ged</span></span>
<span>    <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">+</span> <span class="va">experience</span><span class="op">:</span><span class="va">ged</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fit_J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">dropout_wages_fit_I</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">+</span> <span class="va">experience</span><span class="op">:</span><span class="va">ged</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ged</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A` <span class="op">=</span> <span class="va">dropout_wages_fit_A</span>,</span>
<span>  `Model B` <span class="op">=</span> <span class="va">dropout_wages_fit_B</span>,</span>
<span>  `Model C` <span class="op">=</span> <span class="va">dropout_wages_fit_C</span>,</span>
<span>  `Model D` <span class="op">=</span> <span class="va">dropout_wages_fit_D</span>,</span>
<span>  `Model E` <span class="op">=</span> <span class="va">dropout_wages_fit_E</span>,</span>
<span>  `Model F` <span class="op">=</span> <span class="va">dropout_wages_fit_F</span>,</span>
<span>  `Model G` <span class="op">=</span> <span class="va">dropout_wages_fit_G</span>,</span>
<span>  `Model H` <span class="op">=</span> <span class="va">dropout_wages_fit_H</span>,</span>
<span>  `Model I` <span class="op">=</span> <span class="va">dropout_wages_fit_I</span>,</span>
<span>  `Model J` <span class="op">=</span> <span class="va">dropout_wages_fit_J</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>modelsummary_get <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropout_wages_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"I(unemployment_rate - 7)"</span>,</span>
<span>      <span class="st">"black"</span>,</span>
<span>      <span class="st">"experience"</span>,</span>
<span>      <span class="st">"experience:I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"experience:black"</span>,</span>
<span>      <span class="st">"ged"</span>,</span>
<span>      <span class="st">"postsecondary_education"</span>,</span>
<span>      <span class="st">"experience:ged"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__experience"</span>,</span>
<span>      <span class="st">"var__ged"</span>,</span>
<span>      <span class="st">"var__postsecondary_education"</span>,</span>
<span>      <span class="st">"var__experience:ged"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">23</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">17</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model D">Model D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model E">Model E</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model F">Model F</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model G">Model G</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model H">Model H</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model I">Model I</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model J">Model J</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="11" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">1.749</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">1.734</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">1.734</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">1.749</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">1.750</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">1.739</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">1.739</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">1.739</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">1.738</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">1.738</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.011)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.012)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.012)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.011)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.011)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.012)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.012)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.012)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.012)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.012)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(highest_grade - 9)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.040</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.038</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.039</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.040</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">0.040</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.039</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.038</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">0.039</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">0.038</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">0.038</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.006)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(unemployment_rate - 7)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">-0.012</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">-0.012</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.002)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.002)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.044</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.043</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.043</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.041</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">0.041</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.041</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.041</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">0.041</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">0.042</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">0.042</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.003)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.003)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:black</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">-0.018</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">-0.018</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-0.019</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.019</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">-0.019</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">-0.020</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">-0.019</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">-0.019</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">-0.019</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">-0.018</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.004)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">ged</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.061</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.059</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.041</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.043</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">0.043</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">0.046</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">0.046</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.018)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.017)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.022)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.021)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.019)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.026)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.025)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">postsecondary_education</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.015</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">0.014</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.009</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.009</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">0.009</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.005)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.004)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.006)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.005)</td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center">(0.005)</td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:ged</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">0.005</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">0.005</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model H" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model I" class="gt_row gt_center">(0.005)</td>
<td headers="Fixed Effects  Model J" class="gt_row gt_center">(0.005)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="11" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.094</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model E" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.094</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.094</td>
<td headers="Variance Components  Model H" class="gt_row gt_center">0.095</td>
<td headers="Variance Components  Model I" class="gt_row gt_center">0.094</td>
<td headers="Variance Components  Model J" class="gt_row gt_center">0.094</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.051</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.044</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.051</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.051</td>
<td headers="Variance Components  Model E" class="gt_row gt_center">0.051</td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.041</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.043</td>
<td headers="Variance Components  Model H" class="gt_row gt_center">0.050</td>
<td headers="Variance Components  Model I" class="gt_row gt_center">0.041</td>
<td headers="Variance Components  Model J" class="gt_row gt_center">0.044</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__experience</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.002</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.002</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.002</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.001</td>
<td headers="Variance Components  Model E" class="gt_row gt_center">0.002</td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.001</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.002</td>
<td headers="Variance Components  Model H" class="gt_row gt_center">0.001</td>
<td headers="Variance Components  Model I" class="gt_row gt_center">0.001</td>
<td headers="Variance Components  Model J" class="gt_row gt_center">0.002</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__ged</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.028</td>
<td headers="Variance Components  Model C" class="gt_row gt_center"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center"></td>
<td headers="Variance Components  Model E" class="gt_row gt_center"></td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.016</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.028</td>
<td headers="Variance Components  Model H" class="gt_row gt_center"></td>
<td headers="Variance Components  Model I" class="gt_row gt_center">0.063</td>
<td headers="Variance Components  Model J" class="gt_row gt_center">0.030</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__postsecondary_education</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.001</td>
<td headers="Variance Components  Model E" class="gt_row gt_center"></td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.003</td>
<td headers="Variance Components  Model G" class="gt_row gt_center"></td>
<td headers="Variance Components  Model H" class="gt_row gt_center">0.001</td>
<td headers="Variance Components  Model I" class="gt_row gt_center"></td>
<td headers="Variance Components  Model J" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__experience:ged</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model E" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model F" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model G" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model H" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model I" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.002</td>
<td headers="Variance Components  Model J" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="11" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">4830.5</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">4805.5</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">4818.3</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">4817.4</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">4820.7</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">4789.4</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">4802.7</td>
<td headers="Goodness-of-Fit  Model H" class="gt_row gt_center">4812.6</td>
<td headers="Goodness-of-Fit  Model I" class="gt_row gt_center">4793.5</td>
<td headers="Goodness-of-Fit  Model J" class="gt_row gt_center">4804.6</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">4848.5</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">4831.5</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">4838.3</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">4843.4</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">4840.7</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">4825.4</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">4830.7</td>
<td headers="Goodness-of-Fit  Model H" class="gt_row gt_center">4840.6</td>
<td headers="Goodness-of-Fit  Model I" class="gt_row gt_center">4829.5</td>
<td headers="Goodness-of-Fit  Model J" class="gt_row gt_center">4832.6</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">4909.4</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">4919.5</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">4906.0</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">4931.3</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">4908.4</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">4947.1</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">4925.4</td>
<td headers="Goodness-of-Fit  Model H" class="gt_row gt_center">4935.3</td>
<td headers="Goodness-of-Fit  Model I" class="gt_row gt_center">4951.3</td>
<td headers="Goodness-of-Fit  Model J" class="gt_row gt_center">4927.3</td>
</tr>
</tbody>
</table>
</div>
<p>We can visualize the different forms of discontinuous change
hypothesized by these models by plotting the fitted change trajectory
for a single prototypical individual.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_dropout_wages</span> <span class="op">&lt;-</span> <span class="va">dropout_wages_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep_at.html" class="external-link">keep_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Model "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"D"</span>, <span class="st">"F"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">prototypical_dropout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        experience <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>        ged <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        postsecondary_education <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>        highest_grade <span class="op">=</span> <span class="fl">9</span>,</span>
<span>        black <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        unemployment_rate <span class="op">=</span> <span class="fl">7</span>,</span>
<span>        cid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">prototypical_dropout</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>log_wages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">.fit</span>, <span class="va">prototypical_dropout</span>, re.form <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span>        </span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Similar to Figure 6.2:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_dropout_wages</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">experience</span>, y <span class="op">=</span> <span class="va">log_wages</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">cid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">experience</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We can select a “final” model from our taxonomy of models by
comparing deviance statistics between nested models, and AIC/BIC
statistics between non-nested models (in addition to using a combination
of logic, theory, and prior research).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_wages_anovas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Model B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_B</span>, <span class="va">dropout_wages_fit_A</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_C</span>, <span class="va">dropout_wages_fit_B</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model D"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_D</span>, <span class="va">dropout_wages_fit_A</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model E"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_E</span>, <span class="va">dropout_wages_fit_D</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model F"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_F</span>, <span class="va">dropout_wages_fit_B</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model F"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_F</span>, <span class="va">dropout_wages_fit_D</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model G"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_G</span>, <span class="va">dropout_wages_fit_F</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model H"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_H</span>, <span class="va">dropout_wages_fit_F</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model I"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_I</span>, <span class="va">dropout_wages_fit_B</span><span class="op">)</span>,</span>
<span>  <span class="st">"Model J"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">dropout_wages_fit_J</span>, <span class="va">dropout_wages_fit_I</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 6.2, page 203:</span></span>
<span><span class="va">dropout_wages_anovas</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">tidy</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">term</span>, <span class="va">npar</span>, <span class="va">deviance</span>, <span class="va">statistic</span>, <span class="va">df</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    term <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"dropout_wages_fit_"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">npar</span>, <span class="va">df</span><span class="op">)</span>, <span class="va">as.integer</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"comparison"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/sub_missing.html" class="external-link">sub_missing</a></span><span class="op">(</span>missing_text <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div id="eexombwkke" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eexombwkke table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eexombwkke thead, #eexombwkke tbody, #eexombwkke tfoot, #eexombwkke tr, #eexombwkke td, #eexombwkke th {
  border-style: none;
}

#eexombwkke p {
  margin: 0;
  padding: 0;
}

#eexombwkke .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eexombwkke .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eexombwkke .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eexombwkke .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eexombwkke .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eexombwkke .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eexombwkke .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eexombwkke .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eexombwkke .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eexombwkke .gt_spanner_row {
  border-bottom-style: hidden;
}

#eexombwkke .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eexombwkke .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eexombwkke .gt_from_md > :first-child {
  margin-top: 0;
}

#eexombwkke .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eexombwkke .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eexombwkke .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eexombwkke .gt_row_group_first td {
  border-top-width: 2px;
}

#eexombwkke .gt_row_group_first th {
  border-top-width: 2px;
}

#eexombwkke .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eexombwkke .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eexombwkke .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eexombwkke .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eexombwkke .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eexombwkke .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eexombwkke .gt_left {
  text-align: left;
}

#eexombwkke .gt_center {
  text-align: center;
}

#eexombwkke .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eexombwkke .gt_font_normal {
  font-weight: normal;
}

#eexombwkke .gt_font_bold {
  font-weight: bold;
}

#eexombwkke .gt_font_italic {
  font-style: italic;
}

#eexombwkke .gt_super {
  font-size: 65%;
}

#eexombwkke .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eexombwkke .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eexombwkke .gt_indent_1 {
  text-indent: 5px;
}

#eexombwkke .gt_indent_2 {
  text-indent: 10px;
}

#eexombwkke .gt_indent_3 {
  text-indent: 15px;
}

#eexombwkke .gt_indent_4 {
  text-indent: 20px;
}

#eexombwkke .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="npar">npar</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="deviance">deviance</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model B">Model B</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model B  term" class="gt_row gt_left">A</td>
<td headers="Model B  npar" class="gt_row gt_right">9</td>
<td headers="Model B  deviance" class="gt_row gt_right">4,830.52</td>
<td headers="Model B  statistic" class="gt_row gt_right"><br></td>
<td headers="Model B  df" class="gt_row gt_right"><br></td>
<td headers="Model B  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model B  term" class="gt_row gt_left">B</td>
<td headers="Model B  npar" class="gt_row gt_right">13</td>
<td headers="Model B  deviance" class="gt_row gt_right">4,805.52</td>
<td headers="Model B  statistic" class="gt_row gt_right">25.00</td>
<td headers="Model B  df" class="gt_row gt_right">4</td>
<td headers="Model B  p.value" class="gt_row gt_right">0.00</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model C">Model C</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model C  term" class="gt_row gt_left">C</td>
<td headers="Model C  npar" class="gt_row gt_right">10</td>
<td headers="Model C  deviance" class="gt_row gt_right">4,818.32</td>
<td headers="Model C  statistic" class="gt_row gt_right"><br></td>
<td headers="Model C  df" class="gt_row gt_right"><br></td>
<td headers="Model C  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model C  term" class="gt_row gt_left">B</td>
<td headers="Model C  npar" class="gt_row gt_right">13</td>
<td headers="Model C  deviance" class="gt_row gt_right">4,805.52</td>
<td headers="Model C  statistic" class="gt_row gt_right">12.81</td>
<td headers="Model C  df" class="gt_row gt_right">3</td>
<td headers="Model C  p.value" class="gt_row gt_right">0.01</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model D">Model D</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model D  term" class="gt_row gt_left">A</td>
<td headers="Model D  npar" class="gt_row gt_right">9</td>
<td headers="Model D  deviance" class="gt_row gt_right">4,830.52</td>
<td headers="Model D  statistic" class="gt_row gt_right"><br></td>
<td headers="Model D  df" class="gt_row gt_right"><br></td>
<td headers="Model D  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model D  term" class="gt_row gt_left">D</td>
<td headers="Model D  npar" class="gt_row gt_right">13</td>
<td headers="Model D  deviance" class="gt_row gt_right">4,817.38</td>
<td headers="Model D  statistic" class="gt_row gt_right">13.14</td>
<td headers="Model D  df" class="gt_row gt_right">4</td>
<td headers="Model D  p.value" class="gt_row gt_right">0.01</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model E">Model E</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model E  term" class="gt_row gt_left">E</td>
<td headers="Model E  npar" class="gt_row gt_right">10</td>
<td headers="Model E  deviance" class="gt_row gt_right">4,820.71</td>
<td headers="Model E  statistic" class="gt_row gt_right"><br></td>
<td headers="Model E  df" class="gt_row gt_right"><br></td>
<td headers="Model E  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model E  term" class="gt_row gt_left">D</td>
<td headers="Model E  npar" class="gt_row gt_right">13</td>
<td headers="Model E  deviance" class="gt_row gt_right">4,817.38</td>
<td headers="Model E  statistic" class="gt_row gt_right">3.33</td>
<td headers="Model E  df" class="gt_row gt_right">3</td>
<td headers="Model E  p.value" class="gt_row gt_right">0.34</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model F">Model F</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model F  term" class="gt_row gt_left">B</td>
<td headers="Model F  npar" class="gt_row gt_right">13</td>
<td headers="Model F  deviance" class="gt_row gt_right">4,805.52</td>
<td headers="Model F  statistic" class="gt_row gt_right"><br></td>
<td headers="Model F  df" class="gt_row gt_right"><br></td>
<td headers="Model F  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model F  term" class="gt_row gt_left">F</td>
<td headers="Model F  npar" class="gt_row gt_right">18</td>
<td headers="Model F  deviance" class="gt_row gt_right">4,789.35</td>
<td headers="Model F  statistic" class="gt_row gt_right">16.16</td>
<td headers="Model F  df" class="gt_row gt_right">5</td>
<td headers="Model F  p.value" class="gt_row gt_right">0.01</td>
</tr>
<tr>
<td headers="Model F  term" class="gt_row gt_left">D</td>
<td headers="Model F  npar" class="gt_row gt_right">13</td>
<td headers="Model F  deviance" class="gt_row gt_right">4,817.38</td>
<td headers="Model F  statistic" class="gt_row gt_right"><br></td>
<td headers="Model F  df" class="gt_row gt_right"><br></td>
<td headers="Model F  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model F  term" class="gt_row gt_left">F</td>
<td headers="Model F  npar" class="gt_row gt_right">18</td>
<td headers="Model F  deviance" class="gt_row gt_right">4,789.35</td>
<td headers="Model F  statistic" class="gt_row gt_right">28.02</td>
<td headers="Model F  df" class="gt_row gt_right">5</td>
<td headers="Model F  p.value" class="gt_row gt_right">0.00</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model G">Model G</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model G  term" class="gt_row gt_left">G</td>
<td headers="Model G  npar" class="gt_row gt_right">14</td>
<td headers="Model G  deviance" class="gt_row gt_right">4,802.69</td>
<td headers="Model G  statistic" class="gt_row gt_right"><br></td>
<td headers="Model G  df" class="gt_row gt_right"><br></td>
<td headers="Model G  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model G  term" class="gt_row gt_left">F</td>
<td headers="Model G  npar" class="gt_row gt_right">18</td>
<td headers="Model G  deviance" class="gt_row gt_right">4,789.35</td>
<td headers="Model G  statistic" class="gt_row gt_right">13.33</td>
<td headers="Model G  df" class="gt_row gt_right">4</td>
<td headers="Model G  p.value" class="gt_row gt_right">0.01</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model H">Model H</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model H  term" class="gt_row gt_left">H</td>
<td headers="Model H  npar" class="gt_row gt_right">14</td>
<td headers="Model H  deviance" class="gt_row gt_right">4,812.64</td>
<td headers="Model H  statistic" class="gt_row gt_right"><br></td>
<td headers="Model H  df" class="gt_row gt_right"><br></td>
<td headers="Model H  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model H  term" class="gt_row gt_left">F</td>
<td headers="Model H  npar" class="gt_row gt_right">18</td>
<td headers="Model H  deviance" class="gt_row gt_right">4,789.35</td>
<td headers="Model H  statistic" class="gt_row gt_right">23.29</td>
<td headers="Model H  df" class="gt_row gt_right">4</td>
<td headers="Model H  p.value" class="gt_row gt_right">0.00</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model I">Model I</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model I  term" class="gt_row gt_left">B</td>
<td headers="Model I  npar" class="gt_row gt_right">13</td>
<td headers="Model I  deviance" class="gt_row gt_right">4,805.52</td>
<td headers="Model I  statistic" class="gt_row gt_right"><br></td>
<td headers="Model I  df" class="gt_row gt_right"><br></td>
<td headers="Model I  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model I  term" class="gt_row gt_left">I</td>
<td headers="Model I  npar" class="gt_row gt_right">18</td>
<td headers="Model I  deviance" class="gt_row gt_right">4,793.51</td>
<td headers="Model I  statistic" class="gt_row gt_right">12.01</td>
<td headers="Model I  df" class="gt_row gt_right">5</td>
<td headers="Model I  p.value" class="gt_row gt_right">0.03</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Model J">Model J</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Model J  term" class="gt_row gt_left">J</td>
<td headers="Model J  npar" class="gt_row gt_right">14</td>
<td headers="Model J  deviance" class="gt_row gt_right">4,804.60</td>
<td headers="Model J  statistic" class="gt_row gt_right"><br></td>
<td headers="Model J  df" class="gt_row gt_right"><br></td>
<td headers="Model J  p.value" class="gt_row gt_right"><br></td>
</tr>
<tr>
<td headers="Model J  term" class="gt_row gt_left">I</td>
<td headers="Model J  npar" class="gt_row gt_right">18</td>
<td headers="Model J  deviance" class="gt_row gt_right">4,793.51</td>
<td headers="Model J  statistic" class="gt_row gt_right">11.09</td>
<td headers="Model J  df" class="gt_row gt_right">4</td>
<td headers="Model J  p.value" class="gt_row gt_right">0.03</td>
</tr>
</tbody>
</table>
</div>
<p>Following Singer and Willett (2003), here we choose Model F as our
“final” model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 6.3, page 205:</span></span>
<span><span class="va">dropout_wages_fit_F</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="st">"Estimate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"I(highest_grade - 9)"</span>,</span>
<span>      <span class="st">"I(unemployment_rate - 7)"</span>,</span>
<span>      <span class="st">"experience"</span>,</span>
<span>      <span class="st">"experience:black"</span>,</span>
<span>      <span class="st">"ged"</span>,</span>
<span>      <span class="st">"postsecondary_education"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__experience"</span>,</span>
<span>      <span class="st">"var__ged"</span>,</span>
<span>      <span class="st">"var__postsecondary_education"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">20</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">14</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="ulbfdpbcyv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ulbfdpbcyv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ulbfdpbcyv thead, #ulbfdpbcyv tbody, #ulbfdpbcyv tfoot, #ulbfdpbcyv tr, #ulbfdpbcyv td, #ulbfdpbcyv th {
  border-style: none;
}

#ulbfdpbcyv p {
  margin: 0;
  padding: 0;
}

#ulbfdpbcyv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ulbfdpbcyv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ulbfdpbcyv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ulbfdpbcyv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ulbfdpbcyv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ulbfdpbcyv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ulbfdpbcyv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ulbfdpbcyv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ulbfdpbcyv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ulbfdpbcyv .gt_spanner_row {
  border-bottom-style: hidden;
}

#ulbfdpbcyv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ulbfdpbcyv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ulbfdpbcyv .gt_from_md > :first-child {
  margin-top: 0;
}

#ulbfdpbcyv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ulbfdpbcyv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ulbfdpbcyv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ulbfdpbcyv .gt_row_group_first td {
  border-top-width: 2px;
}

#ulbfdpbcyv .gt_row_group_first th {
  border-top-width: 2px;
}

#ulbfdpbcyv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ulbfdpbcyv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ulbfdpbcyv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ulbfdpbcyv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ulbfdpbcyv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulbfdpbcyv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulbfdpbcyv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulbfdpbcyv .gt_left {
  text-align: left;
}

#ulbfdpbcyv .gt_center {
  text-align: center;
}

#ulbfdpbcyv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ulbfdpbcyv .gt_font_normal {
  font-weight: normal;
}

#ulbfdpbcyv .gt_font_bold {
  font-weight: bold;
}

#ulbfdpbcyv .gt_font_italic {
  font-style: italic;
}

#ulbfdpbcyv .gt_super {
  font-size: 65%;
}

#ulbfdpbcyv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ulbfdpbcyv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ulbfdpbcyv .gt_indent_1 {
  text-indent: 5px;
}

#ulbfdpbcyv .gt_indent_2 {
  text-indent: 10px;
}

#ulbfdpbcyv .gt_indent_3 {
  text-indent: 15px;
}

#ulbfdpbcyv .gt_indent_4 {
  text-indent: 20px;
}

#ulbfdpbcyv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="2" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">1.739</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.012)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(highest_grade - 9)</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">0.039</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.006)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(unemployment_rate - 7)</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">-0.012</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.002)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">0.041</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.003)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">experience:black</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">-0.020</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.004)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">ged</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">0.041</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.022)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">postsecondary_education</td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">0.009</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Estimate" class="gt_row gt_center">(0.006)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="2" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Estimate" class="gt_row gt_center">0.094</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Estimate" class="gt_row gt_center">0.041</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__experience</td>
<td headers="Variance Components  Estimate" class="gt_row gt_center">0.001</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__ged</td>
<td headers="Variance Components  Estimate" class="gt_row gt_center">0.016</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">var__postsecondary_education</td>
<td headers="Variance Components  Estimate" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.003</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="2" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Estimate" class="gt_row gt_center">4789.4</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Estimate" class="gt_row gt_center">4825.4</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Estimate" class="gt_row gt_center">4947.1</td>
</tr>
</tbody>
</table>
</div>
<p>Finally, we can plot prototypical change trajectories for the model.
Note the additional information captured by these discontinuous
trajectories compared to the continuous trajectories for the
<code>dropout_wages</code> data presented in Chapter 5 (Figure 5.2).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_dropout_wages_F</span> <span class="op">&lt;-</span> <span class="va">dropout_wages_fit_F</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      experience <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>      highest_grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>      black <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>      ged <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>      unemployment_rate <span class="op">=</span> <span class="fl">7</span>,</span>
<span>      postsecondary_education <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>log_wages <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    highest_grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">highest_grade</span><span class="op">)</span>,</span>
<span>    black <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">black</span><span class="op">)</span>,</span>
<span>    cid <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/consecutive_id.html" class="external-link">consecutive_id</a></span><span class="op">(</span><span class="va">ged</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 6.3:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_dropout_wages_F</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">experience</span>, y <span class="op">=</span> <span class="va">log_wages</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">cid</span>, colour <span class="op">=</span> <span class="va">black</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">experience</span>, <span class="va">black</span><span class="op">)</span>, colour <span class="op">=</span> <span class="va">black</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.6</span>, <span class="fl">2.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">highest_grade</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="using-transformations-to-model-nonlinear-individual-change">6.2 Using Transformations to Model Nonlinear Individual Change<a class="anchor" aria-label="anchor" href="#using-transformations-to-model-nonlinear-individual-change"></a>
</h2>
<p>In Section 6.2, Singer and Willett (2003) discuss strategies for
transforming outcome and time-indicator variables to model
<strong>nonlinear individual change trajectories</strong> using a subset
of data from Curran, Stice, and Chassin (1997), who measured the
relation between changes in alcohol use and changes in peer alcohol use
over a 3-year period in a community-based sample of Hispanic and
Caucasian adolescents.</p>
<p>For this example we return to the <code>alcohol_use_1</code> data set
introduced in Chapter 4, a person-period data frame with 246 rows and 6
columns:</p>
<ul>
<li>
<code>id</code>: Adolescent ID.</li>
<li>
<code>age</code>: Age in years at time of measurement.</li>
<li>
<code>child_of_alcoholic</code>: Binary indicator for whether the
adolescent is a child of an alcoholic parent.</li>
<li>
<code>male</code>: Binary indicator for whether the adolescent is a
male.</li>
<li>
<code>alcohol_use</code>: Square root of the summed scores of four
eight-point items measuring frequency of alcohol use.</li>
<li>
<code>peer_alcohol_use</code>: Square root of the summed scores of
two six-point items measuring frequency of peer alcohol use.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 246 × 6</span></span></span>
<span><span class="co">#&gt;    id      age child_of_alcoholic  male alcohol_use peer_alcohol_use</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        14                  1     0        1.73            1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1        15                  1     0        2               1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1        16                  1     0        2               1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2        14                  1     1        0               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2        15                  1     1        0               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2        16                  1     1        1               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3        14                  1     1        1               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3        15                  1     1        2               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3        16                  1     1        3.32            0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4        14                  1     1        0               1.79 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 236 more rows</span></span></span></code></pre></div>
<p>Note that the outcome variable, <code>alcohol_use</code>, uses a
square root metric—meaning that a <strong>square root
transformation</strong> was previously applied to the raw scores. To
return the <code>alcohol_use</code> scores to their original metric, we
can <strong>back-transform</strong> them by applying the inverse of the
transformation. In this case, by squaring the square root transformed
values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>alcohol_use_raw <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">^</span><span class="fl">2</span>, .before <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>alcohol_use_sqrt <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 246 × 7</span></span></span>
<span><span class="co">#&gt;    id      age child_of_alcoholic  male alcohol_use_raw alcohol_use_sqrt</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        14                  1     0            3.00             1.73</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1        15                  1     0            4                2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1        16                  1     0            4                2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2        14                  1     1            0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2        15                  1     1            0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2        16                  1     1            1                1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3        14                  1     1            1                1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3        15                  1     1            4                2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3        16                  1     1           11.0              3.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4        14                  1     1            0                0   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 236 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: peer_alcohol_use &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The difference between the original and transformed metrics is best
seen by examining empirical growth plots for a random subset of
individuals.</p>
<p>Notice that in the original metric—despite only having three
measurement occasions—the individual change trajectories for
participants 13, 20, 22, and 45 appear obviously nonlinear.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_empgrowth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>original <span class="op">=</span> <span class="st">"alcohol_use_raw"</span>, sqrt <span class="op">=</span> <span class="st">"alcohol_use_sqrt"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span>
<span>    <span class="va">alcohol_use_1</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">id</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">.y</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_empgrowth</span><span class="op">$</span><span class="va">original</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>However, in the square root metric these same trajectories become
more obviously linear.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_empgrowth</span><span class="op">$</span><span class="va">sqrt</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>As Singer and Willett (2003) discuss, the ability to transform the
outcome variable (or time-indicator variables) so that individual change
becomes linear suggests a simple strategy for modelling nonlinear
change:</p>
<ol style="list-style-type: decimal">
<li>Transform the outcome variable (or time-indicator variables) so that
individual change becomes linear.</li>
<li>Fit the multilevel model for change in the transformed metric.</li>
<li>Back-transform estimates and predictions to present findings in the
original metric.</li>
</ol>
<p>We return to Model E from Chapter 4 to demonstrate this strategy. As
we did in Chapter 4, we begin by fitting the multilevel model for change
in the transformed metric.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">alcohol_use_sqrt</span> <span class="op">~</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span> <span class="op">*</span> <span class="va">peer_alcohol_use</span> <span class="op">+</span> <span class="va">child_of_alcoholic</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">alcohol_use_1</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">alcohol_use_1_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: </span></span>
<span><span class="co">#&gt; alcohol_use_sqrt ~ I(age - 14) * peer_alcohol_use + child_of_alcoholic +  </span></span>
<span><span class="co">#&gt;     (1 + I(age - 14) | id)</span></span>
<span><span class="co">#&gt;    Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    606.7    638.3   -294.4    588.7      237 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.59554 -0.40414 -0.08352  0.45550  2.29975 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.2409   0.4908        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1392   0.3730   -0.03</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                              Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                  -0.31382    0.14611  -2.148</span></span>
<span><span class="co">#&gt; I(age - 14)                   0.42469    0.10559   4.022</span></span>
<span><span class="co">#&gt; peer_alcohol_use              0.69518    0.11126   6.249</span></span>
<span><span class="co">#&gt; child_of_alcoholic            0.57120    0.14623   3.906</span></span>
<span><span class="co">#&gt; I(age - 14):peer_alcohol_use -0.15138    0.08451  -1.791</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) I(g-14) pr_lc_ chld__</span></span>
<span><span class="co">#&gt; I(age - 14) -0.410                      </span></span>
<span><span class="co">#&gt; peer_lchl_s -0.709  0.351               </span></span>
<span><span class="co">#&gt; chld_f_lchl -0.338  0.000  -0.146       </span></span>
<span><span class="co">#&gt; I(-14):pr__  0.334 -0.814  -0.431  0.000</span></span></code></pre></div>
<p>However, instead of plotting prototypical change trajectories in the
transformed metric, we now back-transform to present them in their
original metric. Note the similarities and differences between by these
nonlinear trajectories compared to the linear trajectories for the
<code>alcohol_use_1</code> data presented in Chapter 4 (Figure 4.3).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_alcohol_use</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>        age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">16</span>, by <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span>,</span>
<span>        child_of_alcoholic <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,</span>
<span>        peer_alcohol_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.655</span>, <span class="fl">1.381</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>alcohol_use <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    alcohol_use <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>    child_of_alcoholic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">child_of_alcoholic</span><span class="op">)</span>,</span>
<span>    peer_alcohol_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">peer_alcohol_use</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 6.4, page 209:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_alcohol_use</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">child_of_alcoholic</span>, colour <span class="op">=</span> <span class="va">peer_alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"G"</span>, begin <span class="op">=</span> <span class="fl">.4</span>, end <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">17</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="section level3">
<h3 id="selecting-a-suitable-transformation">Selecting a suitable transformation<a class="anchor" aria-label="anchor" href="#selecting-a-suitable-transformation"></a>
</h3>
<p>Singer and Willett (2003) suggest examining empirical growth plots
for each participant (or a random subset) with several different
transformations before selecting one for analysis, keeping in mind
that:</p>
<ul>
<li>In order to analyze the data, the same transformation must be used
for the entire sample.</li>
<li>Different transformations may be more or less successful for
different participants.</li>
<li>The transformation selected for analysis should work well for most
of the sample, but some compromise is expected.</li>
</ul>
<p>We illustrate this process using the <code>berkeley</code> data set,
which contains a subset of data from the Berkeley Growth Study measuring
changes in IQ of a single girl followed from childhood into older
adulthood (Bayley, 1935).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">berkeley</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">#&gt;      age    iq</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     5    37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     7    65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     9    85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    10    88</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    11    95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    12   101</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    13   103</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    14   107</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    15   113</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    18   121</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    21   148</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    24   161</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>    27   165</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>    36   187</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>    42   205</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>    48   218</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>    54   218</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>    60   228</span></span></code></pre></div>
<p>Following Singer and Willett (2003), here we try transforming both
the outcome and time-indicator variable to see which is most successful
in removing nonlinearity. Note that although the two transformations in
this example are simply inversions of each other (raising
<code>iq</code> to the <em>power</em> of 2.3, and taking the 2.3th
<em>root</em> of <code>age</code>), they do not produce identical
reductions in nonlinearity.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">berkeley_transforms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"iq^(2.3)"</span>, <span class="st">"age^(1/2.3)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  \<span class="op">(</span><span class="va">.transform</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        <span class="va">berkeley</span>,</span>
<span>        transform <span class="op">=</span> <span class="va">.transform</span>,</span>
<span>        age <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">transform</span> <span class="op">==</span> <span class="st">"age^(1/2.3)"</span>, <span class="va">age</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2.3</span><span class="op">)</span>, <span class="va">age</span><span class="op">)</span>,</span>
<span>        iq <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">transform</span> <span class="op">==</span> <span class="st">"iq^(2.3)"</span>, <span class="va">iq</span><span class="op">^</span><span class="op">(</span><span class="fl">2.3</span><span class="op">)</span>, <span class="va">iq</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"metric"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">metric</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">metric</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 6.6, page 212:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">berkeley_transforms</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">iq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">metric</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="representing-individual-change-using-a-polynomial-function-of-time">6.3 Representing individual change using a polynomial function of
<code>time</code><a class="anchor" aria-label="anchor" href="#representing-individual-change-using-a-polynomial-function-of-time"></a>
</h2>
<p>In Section 6.3, Singer and Willett (2003) discuss strategies for
fitting <strong>polynomial individual change trajectories</strong> using
a subset of data from Keiley, Bates, Dodge, and Pettit (2000), who
measured changes in externalizing behaviour in a sample of 45 children
tracked from first through sixth grade.</p>
<p>For this example we use the <code>externalizing_behaviour</code> data
set, a person-period data frame with 270 rows and 5 columns:</p>
<ul>
<li>
<code>id</code>: Child ID.</li>
<li>
<code>time</code>: Time of measurement.</li>
<li>
<code>externalizing_behaviour</code>: Sum of scores on Achenbach’s
(1991) Child Behavior Checklist. Scores range from 0 to 68</li>
<li>
<code>female</code>: Binary indicator for whether the adolescent is
a female.</li>
<li>
<code>grade</code>: Grade year.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">externalizing_behaviour</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 270 × 5</span></span></span>
<span><span class="co">#&gt;    id    externalizing_behaviour female  time grade</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1                          50      0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1                          57      0     1     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1                          51      0     2     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1                          48      0     3     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1                          43      0     4     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1                          19      0     5     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2                           4      0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2                           6      0     1     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2                           3      0     2     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2                           3      0     3     4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 260 more rows</span></span></span></code></pre></div>
<p>Singer and Willett (2003) recommend using two approaches for
selecting among competing polynomial forms for the level-1 individual
growth model:</p>
<ul>
<li>Examining empirical growth plots to identify the highest order
polynomial change trajectory suggested by the data.</li>
<li>Comparing goodness-of-fit statistics across a series of polynomial
level-1 models.</li>
</ul>
<div class="section level3">
<h3 id="using-a-polynomial-trajectory-to-summarize-each-persons-empirical-growth-record">Using a polynomial trajectory to summarize each person’s empirical
growth record<a class="anchor" aria-label="anchor" href="#using-a-polynomial-trajectory-to-summarize-each-persons-empirical-growth-record"></a>
</h3>
<p>We begin by examining empirical growth plots for a subset of children
whose trajectories span the wide array of individual change patterns in
the <code>externalizing_behaviour</code> data.</p>
<p>Unlike previous examples, here we (1) match the order of IDs in the
input vector to the order of <code>id</code>s in the resultant data
frame using the <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> function from the
<strong>purrr</strong> package to filter the data in a specific order;
then (2) assign each participant in the subset a consecutive
alphabetical identifier using the <code><a href="https://dplyr.tidyverse.org/reference/consecutive_id.html" class="external-link">consecutive_id()</a></code> function
from the <strong>dplyr</strong> package.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that participant 26 is last in the input vector and resultant data frame.</span></span>
<span><span class="va">externalizing_behaviour_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">11</span>, <span class="fl">25</span>, <span class="fl">34</span>, <span class="fl">36</span>, <span class="fl">40</span>, <span class="fl">26</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.id</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">externalizing_behaviour</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">.id</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>child <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/consecutive_id.html" class="external-link">consecutive_id</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">externalizing_behaviour_subset</span>, n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 6</span></span></span>
<span><span class="co">#&gt;    id    externalizing_behaviour female  time grade child</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 40                         40      1     0     1 G    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 40                         23      1     1     2 G    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 40                          7      1     2     3 G    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 40                         28      1     3     4 G    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 40                         35      1     4     5 G    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 40                         56      1     5     6 G    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 26                         19      0     0     1 H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 26                         32      0     1     2 H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 26                         25      0     2     3 H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 26                         40      0     3     4 H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 26                         20      0     4     5 H    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 26                         23      0     5     6 H</span></span></code></pre></div>
<p>Now we can examine empirical growth plots for the
<code>externalizing_behaviour_subset</code> data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">externalizing_behaviour_empgrowth</span> <span class="op">&lt;-</span> <span class="va">externalizing_behaviour_subset</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span>, y <span class="op">=</span> <span class="va">externalizing_behaviour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">child</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span></span>
<span><span class="va">externalizing_behaviour_empgrowth</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>When faced with this many different individual change patterns,
Singer and Willett (2003) suggest beginning with the following
exploratory approach:</p>
<ol style="list-style-type: decimal">
<li>First, identify the highest order polynomial needed to summarize
change for <em>each</em> participant by fitting separate
<strong>person-specific polynomial trajectories</strong>.</li>
<li>Second, identify the highest order polynomial needed to summarize
change for <em>any</em> participant by fitting a <strong>common
polynomial trajectory</strong> across all participants.</li>
</ol>
<p>Similar to previous examples, the <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth()</a></code> function
with the <code>"lm"</code> method can be used to add each person’s
fitted polynomial trajectory to the empirical growth record plot—all we
need to do is specify the functional form of the trajectories with the
<code>formula</code> argument. There are two ways to specify polynomial
trajectories using R’s formula syntax:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code>: The <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code> function can be used to
construct a series of polynomial predictors by hand.</li>
<li>
<code><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly()</a></code>: The <code><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly()</a></code> function can be used to
construct a series of (by default, orthogonal) polynomial predictors
from degree 1 up to a specified <code>degree</code>.</li>
</ul>
<p>We begin with the person-specific polynomial trajectories. Note that
because there are no aesthetic mappings for <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth()</a></code>
formulas that can be used to specify the degree of each child’s
polynomial trajectory, we instead need to add a separate smooth geom to
the empirical growth plots for each child’s data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">externalizing_behaviour_empgrowth</span> <span class="op">&lt;-</span> <span class="va">externalizing_behaviour_empgrowth</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">externalizing_behaviour_subset</span>, <span class="va">child</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    \<span class="op">(</span><span class="va">.child</span>, <span class="va">.degree</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">polynomial</span>, colour <span class="op">=</span> <span class="va">degree</span><span class="op">)</span>,</span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>          <span class="va">.child</span>,</span>
<span>          polynomial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"person-specific"</span><span class="op">)</span>,</span>
<span>          degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">.degree</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>        formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">x</span>, degree <span class="op">=</span> <span class="va">.degree</span><span class="op">)</span>,</span>
<span>        se <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">externalizing_behaviour_empgrowth</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Next the common polynomial trajectories. Following Singer and Willett
(2003), here we select a quartic (degree 4) trajectory because no child
appears to need a higher order polynomial.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 6.7, page 218:</span></span>
<span><span class="va">externalizing_behaviour_empgrowth</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"common (quartic)"</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">x</span>, degree <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="testing-higher-order-terms-in-a-polynomial-level-1-model">Testing Higher Order Terms in a Polynomial Level-1 Model<a class="anchor" aria-label="anchor" href="#testing-higher-order-terms-in-a-polynomial-level-1-model"></a>
</h3>
<p>To select a “final” polynomial trajectory, Singer and Willett (2003)
suggest fitting a series of level-1 individual growth models of
increasing polynomial complexity, stopping when goodness-of-fit
statistics suggest there is no need to add further polynomial predictors
to the model.</p>
<p>Here we will fit four models to the
<code>externalizing_behaviour</code> data: an unconditional means model
(Model A), an unconditional growth model (Model B), and two models of
increasing polynomial order (Models C and D). Note that we set the
<code>raw</code> argument of the <code><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly()</a></code> function to
<code>TRUE</code> in order to use raw, not orthogonal, polynomials.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">externalizing_behaviour_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">externalizing_behaviour</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">externalizing_behaviour</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">externalizing_behaviour_poly_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.degree</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>      <span class="va">externalizing_behaviour</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">.degree</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">.degree</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">externalizing_behaviour</span>,</span>
<span>      REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">externalizing_behaviour_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Model A"</span> <span class="op">=</span> <span class="va">externalizing_behaviour_fit_A</span>,</span>
<span>  <span class="st">"Model B"</span> <span class="op">=</span> <span class="va">externalizing_behaviour_poly_fits</span><span class="op">[[</span><span class="st">"1"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  <span class="st">"Model C"</span> <span class="op">=</span> <span class="va">externalizing_behaviour_poly_fits</span><span class="op">[[</span><span class="st">"2"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  <span class="st">"Model D"</span> <span class="op">=</span> <span class="va">externalizing_behaviour_poly_fits</span><span class="op">[[</span><span class="st">"3"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Table 6.5, page 221:</span></span>
<span><span class="va">externalizing_behaviour_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    statistic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"poly(time, .degree, raw = TRUE)"</span> <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>      <span class="st">"poly(time, .degree, raw = TRUE)1"</span> <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>      <span class="st">"poly(time, .degree, raw = TRUE)2"</span> <span class="op">=</span> <span class="st">"time^2"</span>,</span>
<span>      <span class="st">"poly(time, .degree, raw = TRUE)3"</span> <span class="op">=</span> <span class="st">"time^3"</span>,</span>
<span>      <span class="st">"var__Observation"</span> <span class="op">=</span> <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span> <span class="op">=</span> <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__poly(time, .degree, raw = TRUE)"</span> <span class="op">=</span> <span class="st">"var__time"</span>,</span>
<span>      <span class="st">"var__poly(time, .degree, raw = TRUE)1"</span> <span class="op">=</span> <span class="st">"var__time"</span>,</span>
<span>      <span class="st">"cov__(Intercept).poly(time, .degree, raw = TRUE)"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__(Intercept).time"</span>,</span>
<span>      <span class="st">"cov__(Intercept).poly(time, .degree, raw = TRUE)1"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__(Intercept).time"</span>,</span>
<span>      <span class="st">"var__poly(time, .degree, raw = TRUE)2"</span> <span class="op">=</span> <span class="st">"var__time^2"</span>,</span>
<span>      <span class="st">"cov__(Intercept).poly(time, .degree, raw = TRUE)2"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__(Intercept).time^2"</span>,</span>
<span>      <span class="st">"cov__poly(time, .degree, raw = TRUE)1.poly(time, .degree, raw = TRUE)2"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__time.time^2"</span>,</span>
<span>      <span class="st">"var__poly(time, .degree, raw = TRUE)3"</span> <span class="op">=</span> <span class="st">"var__time^3"</span>,</span>
<span>      <span class="st">"cov__(Intercept).poly(time, .degree, raw = TRUE)3"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__(Intercept).time^3"</span>,</span>
<span>      <span class="st">"cov__poly(time, .degree, raw = TRUE)1.poly(time, .degree, raw = TRUE)3"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__time.time^3"</span>,</span>
<span>      <span class="st">"cov__poly(time, .degree, raw = TRUE)2.poly(time, .degree, raw = TRUE)3"</span> <span class="op">=</span></span>
<span>        <span class="st">"cov__time^2.time^3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">16</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="clwghawkzf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#clwghawkzf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#clwghawkzf thead, #clwghawkzf tbody, #clwghawkzf tfoot, #clwghawkzf tr, #clwghawkzf td, #clwghawkzf th {
  border-style: none;
}

#clwghawkzf p {
  margin: 0;
  padding: 0;
}

#clwghawkzf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#clwghawkzf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#clwghawkzf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#clwghawkzf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#clwghawkzf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#clwghawkzf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clwghawkzf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#clwghawkzf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#clwghawkzf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#clwghawkzf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#clwghawkzf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#clwghawkzf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#clwghawkzf .gt_spanner_row {
  border-bottom-style: hidden;
}

#clwghawkzf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#clwghawkzf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#clwghawkzf .gt_from_md > :first-child {
  margin-top: 0;
}

#clwghawkzf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#clwghawkzf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#clwghawkzf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#clwghawkzf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#clwghawkzf .gt_row_group_first td {
  border-top-width: 2px;
}

#clwghawkzf .gt_row_group_first th {
  border-top-width: 2px;
}

#clwghawkzf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#clwghawkzf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#clwghawkzf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#clwghawkzf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clwghawkzf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#clwghawkzf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#clwghawkzf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#clwghawkzf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#clwghawkzf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clwghawkzf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#clwghawkzf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#clwghawkzf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#clwghawkzf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#clwghawkzf .gt_left {
  text-align: left;
}

#clwghawkzf .gt_center {
  text-align: center;
}

#clwghawkzf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#clwghawkzf .gt_font_normal {
  font-weight: normal;
}

#clwghawkzf .gt_font_bold {
  font-weight: bold;
}

#clwghawkzf .gt_font_italic {
  font-style: italic;
}

#clwghawkzf .gt_super {
  font-size: 65%;
}

#clwghawkzf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#clwghawkzf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#clwghawkzf .gt_indent_1 {
  text-indent: 5px;
}

#clwghawkzf .gt_indent_2 {
  text-indent: 10px;
}

#clwghawkzf .gt_indent_3 {
  text-indent: 15px;
}

#clwghawkzf .gt_indent_4 {
  text-indent: 20px;
}

#clwghawkzf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model D">Model D</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">12.963</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">13.290</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">13.970</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">13.795</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">time</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">-0.131</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-1.151</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.350</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">time^2</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.204</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.234</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">time^3</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.058</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">70.203</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">53.718</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">41.985</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">37.855</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">87.418</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">123.526</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">107.077</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">128.914</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__time</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center">4.693</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">24.606</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">105.209</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">cov__(Intercept).time</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center">-12.538</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">-3.688</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">-55.661</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__time^2</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center">1.215</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">16.361</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">cov__(Intercept).time^2</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center">-1.362</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">24.350</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">cov__time.time^2</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center">-4.963</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">-40.437</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__time^3</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.174</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">cov__(Intercept).time^3</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center">-3.230</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">cov__time.time^3</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center">4.006</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">cov__time^2.time^3</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model D" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-1.653</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">2010.3</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">1991.7</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">1975.8</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">1967.4</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">2016.3</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">2003.7</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">1995.8</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">1997.4</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">2027.0</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">2025.3</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">2031.8</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">2051.3</td>
</tr>
</tbody>
</table>
</div>
<p>As usual, we can inspect analysis of deviance tables to compare the
nested models.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">externalizing_behaviour_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">anova</span>, <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">externalizing_behaviour_fits</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 9</span></span></span>
<span><span class="co">#&gt;   term     npar   AIC   BIC logLik deviance statistic    df   p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Model A     3 <span style="text-decoration: underline;">2</span>016. <span style="text-decoration: underline;">2</span>027. -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">005.</span>    <span style="text-decoration: underline;">2</span>010.     <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Model B     6 <span style="text-decoration: underline;">2</span>004. <span style="text-decoration: underline;">2</span>025.  -<span style="color: #BB0000;">996.</span>    <span style="text-decoration: underline;">1</span>992.     18.5      3  0.000<span style="text-decoration: underline;">345</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Model C    10 <span style="text-decoration: underline;">1</span>996. <span style="text-decoration: underline;">2</span>032.  -<span style="color: #BB0000;">988.</span>    <span style="text-decoration: underline;">1</span>976.     15.9      4  0.003<span style="text-decoration: underline;">15</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Model D    15 <span style="text-decoration: underline;">1</span>997. <span style="text-decoration: underline;">2</span>051.  -<span style="color: #BB0000;">984.</span>    <span style="text-decoration: underline;">1</span>967.      8.48     5  0.132</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="truly-nonlinear-trajectories">6.4 Truly Nonlinear Trajectories<a class="anchor" aria-label="anchor" href="#truly-nonlinear-trajectories"></a>
</h2>
<p>In Section 6.4, Singer and Willett (2003) discuss strategies for
fitting <strong>truly nonlinear change trajectories</strong> using data
from Tivnan (1980), who measured changes in cognitive growth over a
three-week period in a sample of 17 first and second-graders. Childrens’
cognitive growth was based on improvement in the number of moves
completed in a two-person checkerboard game, Fox n’ Geese, before making
a catastrophic error.</p>
<p>For this example we use the <code>cognitive_growth</code> data set, a
person-period data frame with 445 rows and 4 columns:</p>
<ul>
<li>
<code>id</code>: Child ID.</li>
<li>
<code>game</code>: Game number. Each child played up to a maximum of
27 games.</li>
<li>
<code>nmoves</code>: The number of moves completed before making a
catastrophic error.</li>
<li>
<code>reading_score</code>: Score on an unnamed standardized reading
test.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cognitive_growth</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 445 × 4</span></span></span>
<span><span class="co">#&gt;    id     game nmoves reading_score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1      4           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         2      7           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         3      8           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1         4      3           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1         5      3           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1         6      3           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1         7      7           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1         8      6           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1         9      3           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1        10      7           1.4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 435 more rows</span></span></span></code></pre></div>
<p>To inform specification of the nonlinear multilevel model for change
we will fit in this example, we begin by examining empirical growth
plots for a subset of children in the <code>cognitive_growth</code>
data.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 6.8, page 227:</span></span>
<span><span class="va">cognitive_growth_empgrowth</span> <span class="op">&lt;-</span> <span class="va">cognitive_growth</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">game</span>, y <span class="op">=</span> <span class="va">nmoves</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cognitive_growth_empgrowth</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>As Singer and Willett (2003) discuss, knowledge of the Fox n’ Geese
game and inspection of these plots suggests a (generalized)
<strong>logistic trajectory</strong> for the level-1 individual growth
model consisting of three features:</p>
<ul>
<li>
<strong>A fixed lower asymptote</strong>: Each child’s trajectory
rises from a fixed lower asymptote of 1 because all players must make at
least one move.</li>
<li>
<strong>A fixed upper asymptote</strong>: Each child’s trajectory
approaches an upper asymptote because they can only make a finite number
of moves before making a catastrophic error. Based on examining
empirical growth plots, a fixed upper asymptote of 20 appears
reasonable.</li>
<li>
<strong>A smooth curve joining the lower and upper
asymptotes</strong>: Learning theory suggests that each child’s true
trajectory will smoothly traverse the region between the lower and upper
asymptotes—accelerating away from the lower asymptote as the child
initially deduces the winning strategy, and decelerating toward the
upper asymptote as the child finds it increasingly difficult to refine
the winning strategy further.</li>
</ul>
<p>We write this level-1 logistic trajectory as:</p>
<p><span class="math display">\[
\text{nmoves}_{ij} = a_{1}
  + \frac{(a_{2} - a_{1})}{1 + \pi_{0i} e^{-(\pi_{1i}
\text{game}_{ij})}}
  + \epsilon_{ij},
\]</span></p>
<p>which asserts that <span class="math inline">\(\text{nmoves}_{ij}\)</span>—the true value of
<code>nmoves</code> for the <span class="math inline">\(i\)</span>th
child at the <span class="math inline">\(j\)</span>th game—is a
nonlinear function of the logistic growth parameters <span class="math inline">\(\pi_{0i}\)</span> and <span class="math inline">\(\pi_{1i}\)</span>. Here the parameters <span class="math inline">\(a_{1}\)</span> and <span class="math inline">\(a_{2}\)</span> represent the lower and upper
asymptotes, which we will fix to values of 1 and 20, respectively.</p>
<p>To develop an intuition for how this level-1 logistic trajectory
models the relationship between <code>nmoves</code> and
<code>game</code>, we can plot <strong>true trajectories</strong> for
different children using specific combinations of values for the
nonlinear parameters, <span class="math inline">\(\pi_{0i}\)</span> and
<span class="math inline">\(\pi_{1i}\)</span>. We can do this by first
writing a function with <code><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">deriv()</a></code> representing the level-1
logistic trajectory (note that we will also use this function when
fitting the nonlinear multilevel model for change).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logistic_function</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">deriv</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">19.0</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1.0</span> <span class="op">+</span> <span class="va">pi0</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi1</span> <span class="op">*</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  namevec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pi0"</span>, <span class="st">"pi1"</span><span class="op">)</span>,</span>
<span>  function.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"pi0"</span>, <span class="st">"pi1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function()</a></code> geom to plot true
trajectories for different combinations of the nonlinear parameters.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 6.9:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange_all.html" class="external-link">arrange_all</a></span><span class="op">(</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span>.pi0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">15</span>, <span class="fl">1.5</span><span class="op">)</span>, .pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.3</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>, <span class="va">desc</span><span class="op">)</span>,</span>
<span>    \<span class="op">(</span><span class="va">.pi0</span>, <span class="va">.pi1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">pi1</span><span class="op">)</span>,</span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>pi0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">.pi0</span><span class="op">)</span>, pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">.pi1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        fun <span class="op">=</span> \<span class="op">(</span><span class="va">.game</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="fu">logistic_function</span><span class="op">(</span><span class="va">.game</span>, pi0 <span class="op">=</span> <span class="va">.pi0</span>, pi1 <span class="op">=</span> <span class="va">.pi1</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        n <span class="op">=</span> <span class="fl">30</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">pi0</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"game"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"nmoves"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>Here we will fit two models to the <code>cognitive_growth</code> data
using our postulated level-1 logistic trajectory: An unconditional
logistic growth model (Model A); and a logistic growth model that
includes a time-invariant predictor for children’s reading skill,
<code>reading_score</code>, centred on its sample mean of 1.95625 (Model
B).</p>
<p>Following Singer and Willett (2003), we specify the level-2 submodels
for the nonlinear parameters of Models A and B as:</p>
<p><span class="math display">\[
\begin{align}
\text{Model A:} \qquad
  \pi_{0i} &amp;= \gamma_{00} + \zeta_{0i} \\
  \pi_{1i} &amp;= \gamma_{10} + \zeta_{1i} \\
\\
\text{Model B:} \qquad
  \pi_{0i} &amp;= \gamma_{00}
    + \gamma_{01}(\text{reading_score}_i
    - \overline{\text{reading_score}})
    + \zeta_{0i} \\
  \pi_{1i} &amp;= \gamma_{10}
    + \gamma_{11}(\text{reading_score}_i
    - \overline{\text{reading_score}})
    + \zeta_{1i}
\end{align}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\begin{bmatrix}
\zeta_{0i} \\ \zeta_{1i}
\end{bmatrix}
\sim
\begin{pmatrix}
N
\begin{bmatrix}
0 \\ 0
\end{bmatrix},
\begin{bmatrix}
\sigma^2_0 &amp; \ \sigma_{10} \\ \ \sigma_{10} &amp; \sigma^2_1
\end{bmatrix}
\end{pmatrix}.
\]</span></p>
<p>We can fit these logistic growth models using the <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme()</a></code>
function from the <strong>nlme</strong> package. The model formula for
the <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme()</a></code> function takes the form
<code>response ~ nonlinear_formula</code>, where the nonlinear formula
can either be represented <em>using a function</em> or <em>written
directly</em>. For this example we will use the
<code>logistic_function()</code> created above. There are several
important differences between linear and nonlinear models to keep in
mind when fitting these models:</p>
<ul>
<li>The nonlinear parameters must be declared explicitly in the
nonlinear formula. For the <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme()</a></code> function, linear models
for these parameters are specified in the <code>fixed</code> and
<code>random</code> arguments; if multiple parameters share the same
model they can be written as a single formula instead of a list of
single parameter formulas.</li>
<li>Starting estimates for the parameters must be provided, unless a
self-starting function is used to calculate the initial parameter
estimates; the final estimates can also be quite sensitive to the
starting values. For this example, we chose starting estimates close to
the parameter estimates reported in the text (Table 6.6). Strategies for
choosing reasonable starting estimates are covered in Bates and Watts
(1988), and Pinheiro and Bates (2000).</li>
<li>An intercept is not assumed by default, and must be included in the
nonlinear model formula if desired.</li>
</ul>
<p>Note that although the models fit below match those described in the
textbook equations, these models are not exactly the same as the those
Singer and Willett (2003) secretly fit for Table 6.6 and Figure 6.10
(for discussion, see <a href="https://github.com/mccarthy-m-g/alda/issues/3" class="external-link uri">https://github.com/mccarthy-m-g/alda/issues/3</a>).</p>
<!--
Note also that because Singer and Willett (2003) fit these models using SAS, it does not seem seem possible to get results that match the textbook exactly---even when the models are specified in the same way, nlme gives different estimates (although they're similar enough).


``` sas
title1 "Table 6.6, page 231:";
proc import datafile="/home/u63840851/nlme/cognitive_growth.csv"
  out=cognitive_growth
  dbms=csv
  replace;
  getnames=yes;
run;
 
proc nlmixed data=cognitive_growth maxiter=1000;
  title2 "Model A";
  parms G00=12 G10=.1 s2e=20 s2u0=.3 cu10=0 s2u1=.01;
  pi0 = G00 + u0;
  pi1 = G10 + u1;
  num = 19;
  den = 1 + pi0*(exp(-(pi1*game)));
  model nmoves ~ normal(1+num/den,s2e);
  random u0 u1 ~ normal([0,0],[s2u0,cu10,s2u1]) subject=id;
  
  p = 1 + num/(1  + G00*exp(-(G10*game)));
  predict p out=model_a;
run;

proc nlmixed data=cognitive_growth maxiter=1000;
  title2 "Model B";
  parms G00=12 G01=-.4 G10=.12 G11=.04 s2e=14 s2u0=.5 s2u1=.01 cu10=0;
  
  pi0 = G00 + G01*(reading_score-1.95625) + u0;
  pi1 = G10 + G11*(reading_score-1.95625) + u1;
  num = 19;
  den = 1 + pi0*(exp(-(pi1*game)));
  model nmoves ~ normal(1+num/den,s2e);
  random u0 u1 ~ normal([0,0],[s2u0,cu10,s2u1]) subject=id;
  
  plow = 1 + num/(1 + (G00 + G01*1)*exp(-(G10*GAME + G11*GAME*1)));
  phigh = 1 + num/(1 + (G00 + G01*4)*exp(-(G10*GAME + G11*GAME*4)));
  predict plow  out=model_b_low;
  predict phigh  out=model_b_high;
run;

/* plots */
proc sort data = model_a;
  by game;
run;

title "Model A";
proc sgplot data = model_a;
  xaxis min=0 max=30;
  yaxis min=0 max=25;
  series x=game y=pred;
run;

data model_b;
  merge model_b_low (keep=id game pred rename = (pred=plow))
        model_b_high (keep=id game pred rename = (pred=phigh));
  by id;
run;

proc sort data = model_b;
  by game;
run;

title "Model B";
proc sgplot data = model_b noautolegend;
  xaxis min=0 max=30;
  yaxis min=0 max=25;
  series x=game y=plow;
  series x=game y=phigh;
run;
```
-->
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit models ------------------------------------------------------------------</span></span>
<span><span class="va">cognitive_growth_fit_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></span><span class="op">(</span></span>
<span>  <span class="va">nmoves</span> <span class="op">~</span> <span class="fu">logistic_function</span><span class="op">(</span><span class="va">game</span>, <span class="va">pi0</span>, <span class="va">pi1</span><span class="op">)</span>,</span>
<span>  fixed <span class="op">=</span> <span class="va">pi0</span> <span class="op">+</span> <span class="va">pi1</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  random <span class="op">=</span> <span class="va">pi0</span> <span class="op">+</span> <span class="va">pi1</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  groups <span class="op">=</span> <span class="op">~</span> <span class="va">id</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>pi0 <span class="op">=</span> <span class="fl">13</span>, pi0 <span class="op">=</span> <span class="fl">.12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cognitive_growth</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cognitive_growth_fit_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">cognitive_growth_fit_A</span>,</span>
<span>  fixed <span class="op">=</span> <span class="va">pi0</span> <span class="op">+</span> <span class="va">pi1</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">reading_score</span> <span class="op">-</span> <span class="fl">1.95625</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="op">-</span><span class="fl">.4</span>, <span class="fl">.12</span>, <span class="fl">.04</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cognitive_growth_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Model A"</span> <span class="op">=</span> <span class="va">cognitive_growth_fit_A</span>,</span>
<span>  <span class="st">"Model B"</span> <span class="op">=</span> <span class="va">cognitive_growth_fit_B</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make table ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># broom.mixed and easystats don't have methods to extract random effects from</span></span>
<span><span class="co"># objects of class nlme, so we have to construct this part of the table manually.</span></span>
<span><span class="va">cognitive_growth_fits_ranef</span> <span class="op">&lt;-</span> <span class="va">cognitive_growth_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.fit</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>order <span class="op">=</span> <span class="st">"cov.last"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">var1</span>, <span class="va">var2</span><span class="op">)</span>,</span>
<span>            \<span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_ends</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"[:digit:]"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">".(Intercept)"</span><span class="op">)</span>, <span class="va">.x</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>          effect <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>          var1 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">grp</span> <span class="op">==</span> <span class="st">"Residual"</span> <span class="op">~</span>  <span class="st">"sd__Observation"</span>,</span>
<span>            <span class="va">grp</span> <span class="op">==</span> <span class="st">"id"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">var2</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sd__"</span>, <span class="va">var1</span><span class="op">)</span>,</span>
<span>            <span class="va">grp</span> <span class="op">==</span> <span class="st">"id"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">var2</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cor__pi0"</span>, <span class="va">var1</span>, <span class="st">"."</span>, <span class="va">var2</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">grp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>term <span class="op">=</span> <span class="va">var1</span>, estimate <span class="op">=</span> <span class="va">sdcor</span><span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">model</span>, values_from <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 6.6, page 231:</span></span>
<span><span class="va">cognitive_growth_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    statistic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"pi0"</span> <span class="op">=</span> <span class="st">"pi0.(Intercept)"</span>,</span>
<span>      <span class="st">"pi0.(Intercept)"</span> <span class="op">=</span> <span class="st">"pi0.(Intercept)"</span>,</span>
<span>      <span class="st">"pi0.I(reading_score - 1.95625)"</span> <span class="op">=</span> <span class="st">"pi0.I(reading_score - 1.95625)"</span>,</span>
<span>      <span class="st">"pi1"</span> <span class="op">=</span> <span class="st">"pi1.(Intercept)"</span>,</span>
<span>      <span class="st">"pi1.(Intercept)"</span> <span class="op">=</span> <span class="st">"pi1.(Intercept)"</span>,</span>
<span>      <span class="st">"pi1.I(reading_score - 1.95625)"</span> <span class="op">=</span> <span class="st">"pi1.I(reading_score - 1.95625)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    add_rows <span class="op">=</span> <span class="va">cognitive_growth_fits_ranef</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div id="ndfyvcfpfc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ndfyvcfpfc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ndfyvcfpfc thead, #ndfyvcfpfc tbody, #ndfyvcfpfc tfoot, #ndfyvcfpfc tr, #ndfyvcfpfc td, #ndfyvcfpfc th {
  border-style: none;
}

#ndfyvcfpfc p {
  margin: 0;
  padding: 0;
}

#ndfyvcfpfc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ndfyvcfpfc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ndfyvcfpfc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ndfyvcfpfc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ndfyvcfpfc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ndfyvcfpfc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ndfyvcfpfc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ndfyvcfpfc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ndfyvcfpfc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ndfyvcfpfc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ndfyvcfpfc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ndfyvcfpfc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ndfyvcfpfc .gt_spanner_row {
  border-bottom-style: hidden;
}

#ndfyvcfpfc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ndfyvcfpfc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ndfyvcfpfc .gt_from_md > :first-child {
  margin-top: 0;
}

#ndfyvcfpfc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ndfyvcfpfc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ndfyvcfpfc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ndfyvcfpfc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ndfyvcfpfc .gt_row_group_first td {
  border-top-width: 2px;
}

#ndfyvcfpfc .gt_row_group_first th {
  border-top-width: 2px;
}

#ndfyvcfpfc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndfyvcfpfc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ndfyvcfpfc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ndfyvcfpfc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ndfyvcfpfc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndfyvcfpfc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ndfyvcfpfc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ndfyvcfpfc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ndfyvcfpfc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ndfyvcfpfc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ndfyvcfpfc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndfyvcfpfc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ndfyvcfpfc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndfyvcfpfc .gt_left {
  text-align: left;
}

#ndfyvcfpfc .gt_center {
  text-align: center;
}

#ndfyvcfpfc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ndfyvcfpfc .gt_font_normal {
  font-weight: normal;
}

#ndfyvcfpfc .gt_font_bold {
  font-weight: bold;
}

#ndfyvcfpfc .gt_font_italic {
  font-style: italic;
}

#ndfyvcfpfc .gt_super {
  font-size: 65%;
}

#ndfyvcfpfc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ndfyvcfpfc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ndfyvcfpfc .gt_indent_1 {
  text-indent: 5px;
}

#ndfyvcfpfc .gt_indent_2 {
  text-indent: 10px;
}

#ndfyvcfpfc .gt_indent_3 {
  text-indent: 15px;
}

#ndfyvcfpfc .gt_indent_4 {
  text-indent: 20px;
}

#ndfyvcfpfc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">pi0.(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">10.776</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">15.456</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">pi0.I(reading_score - 1.95625)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">8.741</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">pi1.(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.109</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.125</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">pi1.I(reading_score - 1.95625)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.051</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">sd__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">3.699</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">3.717</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">sd__pi0.(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">5.167</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">4.043</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">sd__pi1.(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.071</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.069</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">cor__pi0(Intercept).pi1.(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.822</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">1.000</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">2485.6</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">2478.5</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">2497.6</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">2494.5</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">2522.2</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">2527.3</td>
</tr>
</tbody>
</table>
</div>
<p>We can plot both individual and prototypical change trajectories as
usual. First the prototypical trajectories.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_cognitive_growth</span> <span class="op">&lt;-</span> <span class="va">cognitive_growth_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>game <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span>game <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, reading_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    \<span class="op">(</span><span class="va">.fit</span>, <span class="va">.df</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.df</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nmoves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">.fit</span>, newdata <span class="op">=</span> <span class="va">.df</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>reading_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">reading_score</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Similar to Figure 6.10, page 232:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prototypical_cognitive_growth</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">game</span>, y <span class="op">=</span> <span class="va">nmoves</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">reading_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span></span>
<span>    option <span class="op">=</span> <span class="st">"G"</span>, begin <span class="op">=</span> <span class="fl">.4</span>, end <span class="op">=</span> <span class="fl">.7</span>, na.value <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>Finally, the individual trajectories. We can plot all the
trajectories together to get a sense of interindividual variation.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cognitive_growth_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">.fit</span>, data <span class="op">=</span> <span class="va">cognitive_growth</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">nmoves</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>nmoves <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>reading_score <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Model A"</span>, <span class="cn">NA</span>, <span class="va">reading_score</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">game</span>, y <span class="op">=</span> <span class="va">nmoves</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">id</span>, colour <span class="op">=</span> <span class="va">reading_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_b</a></span><span class="op">(</span></span>
<span>      option <span class="op">=</span> <span class="st">"G"</span>, begin <span class="op">=</span> <span class="fl">.4</span>, end <span class="op">=</span> <span class="fl">.8</span>, na.value <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>Or we can add each child’s fitted trajectory to their empirical
growth plot to get a sense of how well the model fits the data.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cognitive_growth_empgrowth</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.fitted</span>, group <span class="op">=</span> <span class="va">id</span>, colour <span class="op">=</span> <span class="va">reading_score</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">cognitive_growth_fit_B</span>, data <span class="op">=</span> <span class="va">cognitive_growth</span><span class="op">)</span>,</span>
<span>      <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_b</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, option <span class="op">=</span> <span class="st">"G"</span>, begin <span class="op">=</span> <span class="fl">.4</span>, end <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-6_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael McCarthy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
