<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4: Doing data analysis with the multilevel model for change • alda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 4: Doing data analysis with the multilevel model for change">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">alda</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tips-tricks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tips &amp; Tricks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tips-tricks">
<li><a class="dropdown-item" href="../articles/longitudinal-data-organization.html">Longitudinal data organization</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-textbook-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Textbook examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-textbook-examples">
<li><h6 class="dropdown-header" data-toc-skip>Longitudinal mixed effects modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-2.html">Chapter 2</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-3.html">Chapter 3</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-4.html">Chapter 4</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-5.html">Chapter 5</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-6.html">Chapter 6</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-7.html">Chapter 7</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Longitudinal structural equation modelling</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-8.html">Chapter 8</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Survival analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/chapter-9.html">Chapter 9</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-10.html">Chapter 10</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-11.html">Chapter 11</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-12.html">Chapter 12</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-13.html">Chapter 13</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-14.html">Chapter 14</a></li>
    <li><a class="dropdown-item" href="../articles/chapter-15.html">Chapter 15</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mccarthy-m-g/alda/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 4: Doing data analysis with the multilevel model for change</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mccarthy-m-g/alda/blob/main/vignettes/articles/chapter-4.Rmd" class="external-link"><code>vignettes/articles/chapter-4.Rmd</code></a></small>
      <div class="d-none name"><code>chapter-4.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mccarthy-m-g.github.io/alda/">alda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed" class="external-link">broom.mixed</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/" class="external-link">modelbased</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modelsummary.com" class="external-link">modelsummary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-changes-in-adolescent-alcohol-use">4.1 Example: Changes in adolescent alcohol use<a class="anchor" aria-label="anchor" href="#example-changes-in-adolescent-alcohol-use"></a>
</h2>
<p>In Chapter 4 Singer and Willett (2003) delve deeper into the
specification, estimation, and interpretation of the multilevel model
for change using a subset of data from Curran, Stice, and Chassin
(1997), who measured the relation between changes in alcohol use and
changes in peer alcohol use over a 3-year period in a community-based
sample of Hispanic and Caucasian adolescents.</p>
<p>For this example we use the <code>alcohol_use_1</code> data set, a
person-period data frame with 246 rows and 6 columns:</p>
<ul>
<li>
<code>id</code>: Adolescent ID.</li>
<li>
<code>age</code>: Age in years at time of measurement.</li>
<li>
<code>child_of_alcoholic</code>: Binary indicator for whether the
adolescent is a child of an alcoholic parent.</li>
<li>
<code>male</code>: Binary indicator for whether the adolescent is a
male.</li>
<li>
<code>alcohol_use</code>: Square root of the summed scores of four
eight-point items measuring frequency of alcohol use.</li>
<li>
<code>peer_alcohol_use</code>: Square root of the summed scores of
two six-point items measuring frequency of peer alcohol use.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 246 × 6</span></span></span>
<span><span class="co">#&gt;    id      age child_of_alcoholic  male alcohol_use peer_alcohol_use</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        14                  1     0        1.73            1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1        15                  1     0        2               1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1        16                  1     0        2               1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2        14                  1     1        0               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2        15                  1     1        0               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2        16                  1     1        1               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3        14                  1     1        1               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3        15                  1     1        2               0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3        16                  1     1        3.32            0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4        14                  1     1        0               1.79 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 236 more rows</span></span></span></code></pre></div>
<p>To inform specification of the multilevel model for change we will
fit in subsequent sections, we begin with some basic exploration and
description of the <code>alcohol_use_1</code> data.</p>
<p>Starting with the <code>age</code> variable, we can see that each
adolescent was measured on the same three occasions at ages 14, 15, and
16 years.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">measurement_occasions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">alcohol_use_1</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="va">measurement_occasions</span></span>
<span><span class="co">#&gt; [1] 14 15 16</span></span>
<span></span>
<span><span class="va">alcohol_use_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>all_occasions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">measurement_occasions</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">all_occasions</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Next we’ll look at the time-invariant <code>male</code> and
<code>child_of_alcoholic</code> variables. Because we’re summarizing
time-invariant predictors, we’ll transform the data to person-level
format with the <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider()</a></code> function from the
<strong>tidyr</strong> package before summarizing.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>  <span class="va">alcohol_use_1</span>,</span>
<span>  names_from <span class="op">=</span> <span class="va">age</span>,</span>
<span>  names_prefix <span class="op">=</span> <span class="st">"alcohol_use_"</span>,</span>
<span>  values_from <span class="op">=</span> <span class="va">alcohol_use</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_pl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 82 × 7</span></span></span>
<span><span class="co">#&gt;    id    child_of_alcoholic  male peer_alcohol_use alcohol_use_14 alcohol_use_15</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1                      1     0            1.26            1.73           2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2                      1     1            0.894           0              0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3                      1     1            0.894           1              2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4                      1     1            1.79            0              2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5                      1     0            0.894           0              0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6                      1     1            1.55            3              3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7                      1     0            1.55            1.73           2.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8                      1     1            0               0              0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9                      1     1            0               0              1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10                     1     0            2               1              1   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 72 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: alcohol_use_16 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>A total of 42 adolescents (51.2%) were male and 40 female (48.8%),
and a total of 37 adolescents (45.1%) were children of an alcoholic
parent and 45 were not (54.9%).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>male <span class="op">=</span> <span class="st">"male"</span>, child_of_alcoholic <span class="op">=</span> <span class="st">"child_of_alcoholic"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">alcohol_use_1_pl</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>proportion <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $male</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;    male count proportion</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0    40      0.488</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1    42      0.512</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $child_of_alcoholic</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   child_of_alcoholic count proportion</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  0    45      0.549</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  1    37      0.451</span></span></code></pre></div>
<p>To inform specification of the level-1 submodel, we can look at
empirical growth plots for a random sample of adolescents as usual.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 4.1, page 77:</span></span>
<span><span class="va">alcohol_use_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span>, <span class="fl">23</span>, <span class="fl">32</span>, <span class="fl">41</span>, <span class="fl">56</span>, <span class="fl">65</span>, <span class="fl">82</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Finally, to inform specification of the level-2 submodel, we can look
at <strong>coincident growth trajectories</strong>—which are simply the
usual individual growth trajectories summarized by the number of
individuals with the same trajectory—displayed separately for groups
distinguished by important values of the time-invariant predictors.</p>
<p>Here we look at two time-invariant predictors,
<code>child_of_alcoholic</code> and <code>peer_alcohol_use</code>.
Because <code>peer_alcohol_use</code> is a continuous variable, we split
it at the sample mean for the purpose of display.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_pl</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_pl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    peer_alcohol_use_split <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      <span class="va">peer_alcohol_use</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">peer_alcohol_use</span><span class="op">)</span>,</span>
<span>      true <span class="op">=</span> <span class="st">"low"</span>,</span>
<span>      false <span class="op">=</span> <span class="st">"high"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    peer_alcohol_use_split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">peer_alcohol_use_split</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_pl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 82 × 8</span></span></span>
<span><span class="co">#&gt;    id    child_of_alcoholic  male peer_alcohol_use alcohol_use_14 alcohol_use_15</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1                      1     0            1.26            1.73           2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2                      1     1            0.894           0              0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3                      1     1            0.894           1              2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4                      1     1            1.79            0              2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5                      1     0            0.894           0              0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6                      1     1            1.55            3              3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7                      1     0            1.55            1.73           2.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8                      1     1            0               0              0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9                      1     1            0               0              1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10                     1     0            2               1              1   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 72 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: alcohol_use_16 &lt;dbl&gt;, peer_alcohol_use_split &lt;fct&gt;</span></span></span></code></pre></div>
<p>To plot the coincident growth trajectories, we first need to
summarize, <em>for each predictor</em>, the number of individuals with
the same trajectory. The easiest way to do this is to count the number
of groups with the same trajectory pattern for each level of the
time-invariant predictors using the person-level data, then tidying the
coincident trajectory summary back to a person-period format.</p>
<p>Afterwards we can plot as usual, with the addition of a
<code>linewidth</code> aesthetic for the coincident trajectory counts.
Note that this plot differs slightly from the text, as unlike Singer and
Willett (2003) we use the entire sample instead of a random sample.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_cotraj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"child_of_alcoholic"</span>, <span class="st">"peer_alcohol_use_split"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Wrangle</span></span>
<span>    <span class="va">.coincident_trajectories</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_pl</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"alcohol_use"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>coincident_trajectories <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>trajectory_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .before <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>        cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"alcohol_use"</span><span class="op">)</span>,</span>
<span>        names_to <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>        names_prefix <span class="op">=</span> <span class="st">"alcohol_use_"</span>,</span>
<span>        names_transform <span class="op">=</span> <span class="va">as.integer</span>,</span>
<span>        values_to <span class="op">=</span> <span class="st">"alcohol_use"</span></span>
<span>      <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Plot</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.coincident_trajectories</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">trajectory_id</span>, linewidth <span class="op">=</span> <span class="va">coincident_trajectories</span><span class="op">)</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>        se <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linewidth.html" class="external-link">scale_linewidth_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">22</span><span class="op">)</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 4.2, page 79:</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">alcohol_use_1_cotraj</span>, ncol <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Based on the exploratory analyses, Singer and Willett (2003) posited
the following multilevel model for change for the
<code>alcohol_use_1</code> data:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Level 1:</mtext><mspace width="2.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><msub><mtext mathvariant="normal">alcohol_use</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>π</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">age</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>14</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Level 2:</mtext><mspace width="2.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>00</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>01</mn></msub><msub><mtext mathvariant="normal">child_of_alcoholic</mtext><mi>i</mi></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>π</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>10</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>11</mn></msub><msub><mtext mathvariant="normal">child_of_alcoholic</mtext><mi>i</mi></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{alignat}{3}
&amp; \text{Level 1:} \qquad &amp;
  \text{alcohol_use}_{ij} &amp;=
  \pi_{0i} + \pi_{1i} (\text{age}_{ij} - 14) + \epsilon_{ij} \\
&amp; \text{Level 2:} \qquad &amp;
  \pi_{0i} &amp;=
  \gamma_{00} + \gamma_{01} \text{child_of_alcoholic}_i + \zeta_{0i} \\
&amp;                        &amp;
  \pi_{1i} &amp;=
  \gamma_{10} + \gamma_{11} \text{child_of_alcoholic}_i + \zeta_{1i},
\end{alignat}
</annotation></semantics></math></p>
<p>where the model parameters follow the same definitions and
interpretations as discussed in Chapter 3.</p>
</div>
<div class="section level2">
<h2 id="the-composite-specification-of-the-multilevel-model-for-change">4.2 The composite specification of the multilevel model for
change<a class="anchor" aria-label="anchor" href="#the-composite-specification-of-the-multilevel-model-for-change"></a>
</h2>
<p>In Section 4.2 Singer and Willett (2003) introduce what they call the
<strong>composite multilevel model for change</strong>, which we
prematurely introduced in the Chapter 3 examples as the mixed model
specification. After substituting the level-2 equations into level-1,
our composite multilevel model for change for the
<code>alcohol_use_1</code> data looks like:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">alcohol_use</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munder><munder><mrow><msub><mi>γ</mi><mn>00</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>01</mn></msub><msub><mtext mathvariant="normal">coa</mtext><mi>i</mi></msub><mo>+</mo><msub><mi>γ</mi><mn>10</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">age</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>14</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>γ</mi><mn>11</mn></msub><msub><mtext mathvariant="normal">coa</mtext><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">age</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>14</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Fixed Effects</mtext></munder><mo>+</mo><munder><munder><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">age</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>14</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Random Effects</mtext></munder></mrow><annotation encoding="application/x-tex">
\text{alcohol_use}_{ij} = \underbrace{
  \gamma_{00} + \gamma_{01} \text{coa}_i
  + \gamma_{10}(\text{age}_{ij} - 14)
  + \gamma_{11} \text{coa}_i(\text{age}_{ij} - 14)
}_{\text{Fixed Effects}}
+ \underbrace{
  \epsilon_{ij} + \zeta_{0i} + \zeta_{1i}(\text{age}_{ij} - 14).
}_{\text{Random Effects}}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="methods-of-estimation-revisited">4.3 Methods of estimation, revisited<a class="anchor" aria-label="anchor" href="#methods-of-estimation-revisited"></a>
</h2>
<p>In Section 4.3 Singer and Willett (2003) discuss two methods of
estimation available to frequentist multilevel models, which must be
selected <em>before</em> fitting the model:</p>
<ul>
<li>
<strong>Generalized least squares</strong> (GLS), which is an
extension of ordinary least-squares estimation that allows the residuals
to be autocorrelated and heteroscedastic. GLS estimates are obtained by
<em>minimizing</em> a weighted function of the residuals. The
<code>gls()</code> function from the <strong>nlme</strong> package can
be used to fit the multilevel model for change using GLS.</li>
<li>
<strong>Maximum likelihood</strong> (ML), which is a more general
approach that is not limited to linear regression models. ML estimates
are obtained by <em>maximizing</em> a likelihood function so that, under
the assumed statistical model, the observed data is most probable. As we
have previously demonstrated, the <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer()</a></code> function from the
<strong>lme4</strong> package can be used to fit the multilevel model
for change using ML.</li>
</ul>
<p>Because generalized least squares and maximum likelihood estimation
use different procedures to fit the multilevel model for change, their
estimates <em>may</em> differ when fitting the same model using the same
data; however, if the normal distribution assumptions required for
maximum likelihood estimation hold, their estimates will be
equivalent.</p>
<p>Additionally, maximum likelihood estimation can be further
distinguished into two types: <strong>full</strong> and
<strong>restricted</strong>. As Singer and Willett (2003) explain, under
<strong>full maximum likelihood</strong> (FML) the likelihood of the
<em>sample data</em> is maximized, and goodness-of-fit statistics refer
to the fit of the entire model (fixed and random effects); under
<strong>restricted maximum likelihood</strong> (REML) the likelihood of
the <em>sample residuals</em> is maximized, and goodness-of-fit
statistics refer to the fit of only the random effects. Consequently,
statistical tests comparing the goodness-of-fit statistics from FML
models can be used to test hypotheses about either fixed or random
effect parameters, whereas those from REML models can be used only to
test hypotheses about random effect parameters.</p>
</div>
<div class="section level2">
<h2 id="first-steps-fitting-two-unconditional-multilevel-models-for-change">4.4 First steps: Fitting two unconditional multilevel models for
change<a class="anchor" aria-label="anchor" href="#first-steps-fitting-two-unconditional-multilevel-models-for-change"></a>
</h2>
<p>In Section 4.4 Singer and Willett (2003) introduce a new
<strong>model building</strong> workflow for the multilevel model for
change that begins by fitting two unconditional multilevel models for
change before including any substantive predictors:</p>
<ul>
<li>The <strong>unconditional means model</strong>, which partitions and
quantifies the total variation in the outcome variable across
individuals without regard to time. We fit this model first to determine
whether the variance components
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\zeta_{0i}</annotation></semantics></math>
have sufficient variation within individuals (level 1) and between
individuals (level 2), respectively, to warrant linking outcome
variation <em>at that level</em> to predictors.</li>
<li>The <strong>unconditional growth model</strong>, which partitions
and quantifies variation in the outcome variable across both individuals
and time. We fit this model second to determine whether interindividual
differences in change are due to outcome variation in true initial
status,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\zeta_{0i}</annotation></semantics></math>,
or true rate of change,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\zeta_{1i}</annotation></semantics></math>.</li>
</ul>
<p>Together, these two models (1) provide a valuable baseline against
which you can evaluate and compare subsequent models that include
substantive predictors, and (2) help establish whether and where any
systematic variation in the outcome variable worth exploring
resides.</p>
<div class="section level3">
<h3 id="the-unconditional-means-model">The unconditional means model<a class="anchor" aria-label="anchor" href="#the-unconditional-means-model"></a>
</h3>
<p>The unconditional means model is an intercept-only model that allows
the intercept to vary across individuals:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Level 1:</mtext><mspace width="2.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><msub><mtext mathvariant="normal">alcohol_use</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Level 2:</mtext><mspace width="2.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>00</mn></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{alignat}{3}
&amp; \text{Level 1:} \qquad &amp;
  \text{alcohol_use}_{ij} &amp;=
  \pi_{0i} + \epsilon_{ij} \\
&amp; \text{Level 2:} \qquad &amp;
  \pi_{0i} &amp;=
  \gamma_{00} + \zeta_{0i},
\end{alignat}
</annotation></semantics></math></p>
<p>which postulates that the observed value of <code>alcohol_use</code>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
adolescent at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
time is composed of their within-person deviations,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{ij}</annotation></semantics></math>,
from their person-specific true mean,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{0i}</annotation></semantics></math>,
which in turn is composed of their between-person deviation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\zeta_{0i}</annotation></semantics></math>,
from the population average true mean,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>00</mn></msub><annotation encoding="application/x-tex">\gamma_{00}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table 4.1, Model A, page 94-95:</span></span>
<span><span class="va">model_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">alcohol_use</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">alcohol_use_1</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_A</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ 1 + (1 | id)</span></span>
<span><span class="co">#&gt;    Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    676.2    686.7   -335.1    670.2      243 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.8865 -0.3076 -0.3067  0.6137  2.8567 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.5639   0.7509  </span></span>
<span><span class="co">#&gt;  Residual             0.5617   0.7495  </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)  0.92195    0.09571   9.633</span></span></code></pre></div>
<p>Note that because the unconditional means model lacks any temporal
predictors, it stipulates that the true change trajectory for each
individual is completely flat over time, sitting at their
person-specific mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{0i}</annotation></semantics></math>);
and that the true population change trajectory is also flat, sitting at
the grand mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>00</mn></msub><annotation encoding="application/x-tex">\gamma_{00}</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_A</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">alcohol_use_1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"individual"</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.35</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.fitted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">model_A</span><span class="op">)</span>, age <span class="op">=</span> <span class="va">measurement_occasions</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linewidth_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"alcohol_use"</span>, linewidth <span class="op">=</span> <span class="st">"trajectory"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="the-unconditional-growth-model">The unconditional growth model<a class="anchor" aria-label="anchor" href="#the-unconditional-growth-model"></a>
</h3>
<p>The unconditional growth model introduces the time-indicator
predictor into the model, and allows the rate of change to vary across
individuals:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Level 1:</mtext><mspace width="2.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><msub><mtext mathvariant="normal">alcohol_use</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>π</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">age</mtext><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>14</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">Level 2:</mtext><mspace width="2.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>00</mn></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>π</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>10</mn></msub><mo>+</mo><msub><mi>ζ</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{alignat}{3}
&amp; \text{Level 1:} \qquad &amp;
  \text{alcohol_use}_{ij} &amp;=
  \pi_{0i} + \pi_{1i}(\text{age}_{ij} - 14) + \epsilon_{ij} \\
&amp; \text{Level 2:} \qquad &amp;
  \pi_{0i} &amp;=
  \gamma_{00} + \zeta_{0i} \\
&amp;                        &amp;
  \pi_{1i} &amp;=
  \gamma_{10} + \zeta_{1i},
\end{alignat}
</annotation></semantics></math></p>
<p>which postulates that the observed value of <code>alcohol_use</code>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
adolescent at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
time is composed of their within-person deviations,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{ij}</annotation></semantics></math>,
from their true linear change trajectory—a linear function of their true
initial status,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{0i}</annotation></semantics></math>,
and true rate of change,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{1i}</annotation></semantics></math>—which
in turn are composed of their between-person deviations,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\zeta_{0i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\zeta_{1i}</annotation></semantics></math>,
from the population average true initial status,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>00</mn></msub><annotation encoding="application/x-tex">\gamma_{00}</annotation></semantics></math>,
and the population average true rate of change,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>10</mn></msub><annotation encoding="application/x-tex">\gamma_{10}</annotation></semantics></math>,
respectively.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">alcohol_use</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">alcohol_use_1</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_B</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ I(age - 14) + (I(age - 14) | id)</span></span>
<span><span class="co">#&gt;    Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    648.6    669.6   -318.3    636.6      240 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.47999 -0.38401 -0.07553  0.39001  2.50685 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.6244   0.7902        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1512   0.3888   -0.22</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)  0.65130    0.10508   6.198</span></span>
<span><span class="co">#&gt; I(age - 14)  0.27065    0.06245   4.334</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr)</span></span>
<span><span class="co">#&gt; I(age - 14) -0.441</span></span></code></pre></div>
<p>This is the same model as Chapter 3’s individual growth model—but
with a new name to emphasize that the model includes no substantive
predictors—so we can plot the trajectories as usual.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_B</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">alcohol_use</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>alcohol_use <span class="op">=</span> <span class="va">.fitted</span>, age <span class="op">=</span> <span class="va">`I(age - 14)`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"individual"</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"#3366FF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        age <span class="op">=</span> <span class="va">measurement_occasions</span>,</span>
<span>        alcohol_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>          <span class="va">model_B</span>,</span>
<span>          <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">measurement_occasions</span><span class="op">)</span>,</span>
<span>          re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      colour <span class="op">=</span> <span class="st">"#3366FF"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linewidth_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">17</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="st">"trajectory"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="practical-data-analytic-strategies-for-model-building">4.5 Practical data analytic strategies for model building<a class="anchor" aria-label="anchor" href="#practical-data-analytic-strategies-for-model-building"></a>
</h2>
<p>In Section 4.5 Singer and Willett (2003) present their data analytic
strategy for model building, which focuses on building a systematic
sequence of models that, as a set, address your research questions in a
meaningful way. They refer to this sequence as a <strong>taxonomy of
statistical models</strong>, where:</p>
<ul>
<li>Each model in the taxonomy extends a prior model in some sensible
way.</li>
<li>Decisions to enter, retain, and remove predictors are based on a
combination of logic, theory, and prior research, supplemented by
hypothesis testing and comparisons of model fit.</li>
<li>The taxonomy progresses toward a “final” model whose interpretation
addresses your research questions.</li>
</ul>
<p>They present this strategy through one potential analytic path for
the <code>alcohol_use_1</code> data, where the research question is
focused on the relationship between changes in adolescent alcohol use
and being the child of an alcoholic parent.</p>
<p>The first substantive model, Model C, updates the unconditional
growth model to include <code>child_of_alcoholic</code> as a predictor
of both initial status and rate of change. Singer and Willett (2003)
added these terms as a logical first step, given the research
question.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">model_B</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">child_of_alcoholic</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span><span class="op">:</span><span class="va">child_of_alcoholic</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_C</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic +  </span></span>
<span><span class="co">#&gt;     I(age - 14):child_of_alcoholic</span></span>
<span><span class="co">#&gt;    Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    637.2    665.2   -310.6    621.2      238 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.5480 -0.3880 -0.1058  0.3602  2.3961 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.4876   0.6983        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1506   0.3881   -0.22</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                                Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                     0.31595    0.13070   2.417</span></span>
<span><span class="co">#&gt; I(age - 14)                     0.29296    0.08423   3.478</span></span>
<span><span class="co">#&gt; child_of_alcoholic              0.74321    0.19457   3.820</span></span>
<span><span class="co">#&gt; I(age - 14):child_of_alcoholic -0.04943    0.12539  -0.394</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) I(g-14) chld__</span></span>
<span><span class="co">#&gt; I(age - 14) -0.460               </span></span>
<span><span class="co">#&gt; chld_f_lchl -0.672  0.309        </span></span>
<span><span class="co">#&gt; I(-14):ch__  0.309 -0.672  -0.460</span></span></code></pre></div>
<p>Model D builds upon Model C, controlling for the effects of
<code>peer_alcohol_use</code> on initial status and rate of change.
Singer and Willett (2003) added these terms to see if they might explain
some of the <strong>conditional residual variation</strong> in initial
status and rate of change from Model C.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">model_C</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">peer_alcohol_use</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span><span class="op">:</span><span class="va">peer_alcohol_use</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_D</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic +  </span></span>
<span><span class="co">#&gt;     peer_alcohol_use + I(age - 14):child_of_alcoholic + I(age -  </span></span>
<span><span class="co">#&gt;     14):peer_alcohol_use</span></span>
<span><span class="co">#&gt;    Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    608.7    643.7   -294.3    588.7      236 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.59554 -0.40005 -0.07769  0.46003  2.29373 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.2409   0.4908        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1391   0.3730   -0.03</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                                Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                    -0.31651    0.14806  -2.138</span></span>
<span><span class="co">#&gt; I(age - 14)                     0.42943    0.11369   3.777</span></span>
<span><span class="co">#&gt; child_of_alcoholic              0.57917    0.16249   3.564</span></span>
<span><span class="co">#&gt; peer_alcohol_use                0.69430    0.11153   6.225</span></span>
<span><span class="co">#&gt; I(age - 14):child_of_alcoholic -0.01403    0.12477  -0.112</span></span>
<span><span class="co">#&gt; I(age - 14):peer_alcohol_use   -0.14982    0.08564  -1.749</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) I(g-14) chld__ pr_lc_ I(-14):c__</span></span>
<span><span class="co">#&gt; I(age - 14) -0.436                                 </span></span>
<span><span class="co">#&gt; chld_f_lchl -0.371  0.162                          </span></span>
<span><span class="co">#&gt; peer_lchl_s -0.686  0.299  -0.162                  </span></span>
<span><span class="co">#&gt; I(-14):ch__  0.162 -0.371  -0.436  0.071           </span></span>
<span><span class="co">#&gt; I(-14):pr__  0.299 -0.686   0.071 -0.436 -0.162</span></span></code></pre></div>
<p>Model E reduces Model D, removing <code>child_of_alcoholic</code> as
a predictor of rate of change. Singer and Willett (2003) removed this
term based on the results of Models C and D, which both estimated that
the difference in the rate of change in <code>alcohol_use</code> between
children of alchoholic and nonalcoholic parents was practically
zero.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">model_D</span>,</span>
<span>  <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span><span class="op">:</span><span class="va">child_of_alcoholic</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_E</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic +  </span></span>
<span><span class="co">#&gt;     peer_alcohol_use + I(age - 14):peer_alcohol_use</span></span>
<span><span class="co">#&gt;    Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    606.7    638.3   -294.4    588.7      237 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.59554 -0.40414 -0.08352  0.45550  2.29975 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.2409   0.4908        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1392   0.3730   -0.03</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                              Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                  -0.31382    0.14611  -2.148</span></span>
<span><span class="co">#&gt; I(age - 14)                   0.42469    0.10559   4.022</span></span>
<span><span class="co">#&gt; child_of_alcoholic            0.57120    0.14623   3.906</span></span>
<span><span class="co">#&gt; peer_alcohol_use              0.69518    0.11126   6.249</span></span>
<span><span class="co">#&gt; I(age - 14):peer_alcohol_use -0.15138    0.08451  -1.791</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) I(g-14) chld__ pr_lc_</span></span>
<span><span class="co">#&gt; I(age - 14) -0.410                      </span></span>
<span><span class="co">#&gt; chld_f_lchl -0.338  0.000               </span></span>
<span><span class="co">#&gt; peer_lchl_s -0.709  0.351  -0.146       </span></span>
<span><span class="co">#&gt; I(-14):pr__  0.334 -0.814   0.000 -0.431</span></span></code></pre></div>
<p>Model F serves as an alternative to Model E, with
<code>peer_alcohol_use</code> centred on its sample mean of 1.018 (from
the <em>person-level</em> data set). Singer and Willett (2003) centred
<code>peer_alcohol_use</code> so that the level-2 intercepts,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>00</mn></msub><annotation encoding="application/x-tex">\gamma_{00}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>10</mn></msub><annotation encoding="application/x-tex">\gamma_{10}</annotation></semantics></math>,
would represent a child of non-alchoholic parents with an average value
of <code>peer_alcohol_use</code> (<code>peer_alcohol_use</code> = 1.018
and <code>child_of_alcoholic</code> = 0), rather than a child of
non-alchoholic parents whose peers at age 14 were totally abstinent
(<code>peer_alcohol_use</code> = 0 and <code>child_of_alcoholic</code> =
0).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">model_E</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">alcohol_use_1</span>, peer_alcohol_use <span class="op">=</span> <span class="va">peer_alcohol_use</span> <span class="op">-</span> <span class="fl">1.018</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_F</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic +  </span></span>
<span><span class="co">#&gt;     peer_alcohol_use + I(age - 14):peer_alcohol_use</span></span>
<span><span class="co">#&gt;    Data: mutate(alcohol_use_1, peer_alcohol_use = peer_alcohol_use - 1.018)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    606.7    638.3   -294.4    588.7      237 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.59554 -0.40414 -0.08352  0.45550  2.29975 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.2409   0.4908        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1392   0.3730   -0.03</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                              Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                   0.39387    0.10354   3.804</span></span>
<span><span class="co">#&gt; I(age - 14)                   0.27058    0.06127   4.416</span></span>
<span><span class="co">#&gt; child_of_alcoholic            0.57120    0.14623   3.906</span></span>
<span><span class="co">#&gt; peer_alcohol_use              0.69518    0.11126   6.249</span></span>
<span><span class="co">#&gt; I(age - 14):peer_alcohol_use -0.15138    0.08451  -1.791</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) I(g-14) chld__ pr_lc_</span></span>
<span><span class="co">#&gt; I(age - 14) -0.336                      </span></span>
<span><span class="co">#&gt; chld_f_lchl -0.637  0.000               </span></span>
<span><span class="co">#&gt; peer_lchl_s  0.094  0.000  -0.146       </span></span>
<span><span class="co">#&gt; I(-14):pr__  0.000  0.001   0.000 -0.431</span></span></code></pre></div>
<p>Finally, Model G serves as an alternative to Model F, with
<code>child_of_alcoholic</code> also centred on its sample mean of 0.451
(from the <em>person-level</em> data set). Singer and Willett (2003)
also centred <code>child_of_alcoholic</code> so that the level-2
intercepts,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>00</mn></msub><annotation encoding="application/x-tex">\gamma_{00}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>10</mn></msub><annotation encoding="application/x-tex">\gamma_{10}</annotation></semantics></math>,
would represent an adolescent with average values of
<code>peer_alcohol_use</code> and <code>child_of_alcoholic</code>
(<code>peer_alcohol_use</code> = 1.018 and
<code>child_of_alcoholic</code> = 0.451), and be numerically identical
to the corresponding level-2 intercepts in the unconditional growth
model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span></span>
<span>  <span class="va">model_F</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="va">alcohol_use_1</span>,</span>
<span>    peer_alcohol_use <span class="op">=</span> <span class="va">peer_alcohol_use</span> <span class="op">-</span> <span class="fl">1.018</span>,</span>
<span>    child_of_alcoholic <span class="op">=</span> <span class="va">child_of_alcoholic</span> <span class="op">-</span> <span class="fl">0.451</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_G</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by maximum likelihood  ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic +  </span></span>
<span><span class="co">#&gt;     peer_alcohol_use + I(age - 14):peer_alcohol_use</span></span>
<span><span class="co">#&gt;    Data: mutate(alcohol_use_1, peer_alcohol_use = peer_alcohol_use - 1.018,  </span></span>
<span><span class="co">#&gt;     child_of_alcoholic = child_of_alcoholic - 0.451)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    606.7    638.3   -294.4    588.7      237 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.59554 -0.40414 -0.08352  0.45550  2.29975 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr </span></span>
<span><span class="co">#&gt;  id       (Intercept) 0.2409   0.4908        </span></span>
<span><span class="co">#&gt;           I(age - 14) 0.1392   0.3730   -0.03</span></span>
<span><span class="co">#&gt;  Residual             0.3373   0.5808        </span></span>
<span><span class="co">#&gt; Number of obs: 246, groups:  id, 82</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                              Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                   0.65148    0.07979   8.165</span></span>
<span><span class="co">#&gt; I(age - 14)                   0.27058    0.06127   4.416</span></span>
<span><span class="co">#&gt; child_of_alcoholic            0.57120    0.14623   3.906</span></span>
<span><span class="co">#&gt; peer_alcohol_use              0.69518    0.11126   6.249</span></span>
<span><span class="co">#&gt; I(age - 14):peer_alcohol_use -0.15138    0.08451  -1.791</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;             (Intr) I(g-14) chld__ pr_lc_</span></span>
<span><span class="co">#&gt; I(age - 14) -0.436                      </span></span>
<span><span class="co">#&gt; chld_f_lchl  0.000  0.000               </span></span>
<span><span class="co">#&gt; peer_lchl_s  0.001  0.000  -0.146       </span></span>
<span><span class="co">#&gt; I(-14):pr__  0.000  0.001   0.000 -0.431</span></span></code></pre></div>
<p>To make our taxonomy of statistical models easier to work with in
subsequent sections, we will store the models in a list.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Model A` <span class="op">=</span> <span class="va">model_A</span>,</span>
<span>  `Model B` <span class="op">=</span> <span class="va">model_B</span>,</span>
<span>  `Model C` <span class="op">=</span> <span class="va">model_C</span>,</span>
<span>  `Model D` <span class="op">=</span> <span class="va">model_D</span>,</span>
<span>  `Model E` <span class="op">=</span> <span class="va">model_E</span>,</span>
<span>  `Model F` <span class="op">=</span> <span class="va">model_F</span>,</span>
<span>  `Model G` <span class="op">=</span> <span class="va">model_G</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="inspecting-model-summary-and-goodness-of-fit-statistics">Inspecting model summary and goodness-of-fit statistics<a class="anchor" aria-label="anchor" href="#inspecting-model-summary-and-goodness-of-fit-statistics"></a>
</h3>
<p>In addition to the output from <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> we can return a
one row tibble of model summary and goodness-of-fit statistics using the
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> function from the broom.mixed package. Individual
statistics can also be returned using the generic functions of the
corresponding name (e.g., <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC()</a></code>,
<code><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance()</a></code>, etc.).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">model_A</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;    nobs sigma logLik   AIC   BIC deviance df.residual</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   246 0.749  -<span style="color: #BB0000;">335.</span>  676.  687.     670.         243</span></span></code></pre></div>
<p>Singer and Willett (2003) also introduce three
pseudo-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
statistics for the multilevel model for change, which can be used to
<em>cautiously</em> quantify how much outcome variation is “explained”
by a model’s predictors.</p>
<p>The first statistic,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>y</mi><mover><mi>y</mi><mo accent="true">̂</mo></mover></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{y \hat y}</annotation></semantics></math>,
assesses the proportion of total outcome variation “explained” by a
model’s specific combination of predictors, based on the squared sample
correlation between observed and predicted values.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2_yy</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fits</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.fit</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>          r2_yy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">alcohol_use</span>, <span class="va">.fixed</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></code></pre></div>
<p>The second statistic,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>ϵ</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{\epsilon}</annotation></semantics></math>,
assesses the proportion of within-person variation “explained” by time,
based on the proportional decrease in within-person residual variance
between the unconditional means model and subsequent models. Note that
because the only way of reducing this variance component is to add
time-varying predictors to the level-1 submodel, this statistic is the
same for all of the models we fit to the <code>alcohol_use_1</code>
data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2_e</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fits</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.fit</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>          r2_e <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">model_A</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">.fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">model_A</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></code></pre></div>
<p>The final statistic,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>ζ</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{\zeta}</annotation></semantics></math>,
assesses the proportion of between-person variation “explained” by one
or more level-2 predictors, based on the proportional decrease in
level-2 residual variance between the unconditional growth model and
subsequent models for each level-2 residual variance component.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2_z</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fits</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    \<span class="op">(</span><span class="va">.fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">zeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">model_B</span>, y <span class="op">=</span> <span class="va">.fit</span><span class="op">)</span>,</span>
<span>        \<span class="op">(</span><span class="va">.fit2</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">.fit2</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span>effects <span class="op">=</span> <span class="st">"ran_pars"</span>, scales <span class="op">=</span> <span class="st">"vcov"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">!=</span> <span class="st">"Residual"</span> <span class="op">&amp;</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"^var"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">zeta</span><span class="op">$</span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">zeta</span><span class="op">$</span><span class="va">y</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effect"</span>, <span class="st">"group"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>          r2 <span class="op">=</span> <span class="op">(</span><span class="va">estimate.x</span> <span class="op">-</span> <span class="va">estimate.y</span><span class="op">)</span> <span class="op">/</span> <span class="va">estimate.x</span>,</span>
<span>          name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r2_z1"</span>, <span class="st">"r2_z2"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">r2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">name</span>, values_from <span class="op">=</span> <span class="va">r2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></code></pre></div>
<p>Because we will be adding these statistics to a table in the next
section, we will join them together here.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_fits_r2</span> <span class="op">&lt;-</span> <span class="va">r2_yy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">r2_e</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">r2_z</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_fits_r2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 5</span></span></span>
<span><span class="co">#&gt;   model     r2_yy   r2_e  r2_z1    r2_z2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Model A <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Model B  0.043<span style="text-decoration: underline;">4</span>  0.400 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Model C  0.150   0.400  0.219  0.004<span style="text-decoration: underline;">01</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Model D  0.291   0.400  0.614  0.079<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Model E  0.291   0.400  0.614  0.079<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Model F  0.291   0.400  0.614  0.079<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Model G  0.291   0.400  0.614  0.079<span style="text-decoration: underline;">7</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-fitted-models">Interpreting fitted models<a class="anchor" aria-label="anchor" href="#interpreting-fitted-models"></a>
</h3>
<p>To systematically compare fitted models—describing what happens as
predictors are added and removed—Singer and Willett (2003) suggest
placing them side-by-side in a table, which allows you to more easily
inspect and compare estimated fixed effects, variance components, and
goodness-of-fit statistics from one model to the next. We can construct
such a table using the <code><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary()</a></code> function from the
<strong>modelsummary</strong> package. To better match the table in the
text, we will set the table <code>output</code> to <code>"gt"</code> so
we can post-process it using the <strong>gt</strong> package.</p>
<!-- TODO: Revise code for modelsummary after next CRAN release: https://github.com/vincentarelbundock/modelsummary/issues/757-->
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This option needs to be set in order to make all the desired goodness-of-fit</span></span>
<span><span class="co"># statistics available to modelsummary.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>modelsummary_get <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table 4.1, page 94-95:</span></span>
<span><span class="va">alcohol_use_1_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">term</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span>,</span>
<span>    scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vcov"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="co"># argument from broom.mixed::tidy()</span></span>
<span>    coef_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"(Intercept)"</span>,</span>
<span>      <span class="st">"child_of_alcoholic"</span>,</span>
<span>      <span class="st">"peer_alcohol_use"</span>,</span>
<span>      <span class="st">"I(age - 14)"</span>,</span>
<span>      <span class="st">"I(age - 14):child_of_alcoholic"</span>,</span>
<span>      <span class="st">"I(age - 14):peer_alcohol_use"</span>,</span>
<span>      <span class="st">"var__Observation"</span>,</span>
<span>      <span class="st">"var__(Intercept)"</span>,</span>
<span>      <span class="st">"var__I(age - 14)"</span>,</span>
<span>      <span class="st">"cov__(Intercept).I(age - 14)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    gof_map <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      clean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deviance"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,</span>
<span>      fmt <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># The R2s need to be transposed to be added to the table columns. Their</span></span>
<span>    <span class="co"># position in the table is set by the `position` attribute.</span></span>
<span>    add_rows <span class="op">=</span> <span class="va">alcohol_use_1_fits_r2</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">model</span>, names_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="st">""</span>, .after <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fl">17</span><span class="op">:</span><span class="fl">21</span><span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"gt"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Goodness-of-Fit"</span>, rows <span class="op">=</span> <span class="fl">17</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Variance Components"</span>, rows <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_row_group.html" class="external-link">tab_row_group</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fixed Effects"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_hide.html" class="external-link">cols_hide</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=" "> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model A">Model A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model B">Model B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model C">Model C</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model D">Model D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model E">Model E</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model F">Model F</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Model G">Model G</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="8" class="gt_group_heading" scope="colgroup" id="Fixed Effects">Fixed Effects</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Fixed Effects   " class="gt_row gt_left">(Intercept)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">0.922</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.651</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.316</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.317</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">-0.314</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.394</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.651</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center">(0.096)</td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.105)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.131)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.148)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.146)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.104)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.080)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">child_of_alcoholic</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.743</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.579</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">0.571</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.571</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.571</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.195)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.162)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.146)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.146)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.146)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">peer_alcohol_use</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.694</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">0.695</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.695</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.695</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.112)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.111)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.111)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.111)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(age - 14)</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">0.271</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">0.293</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">0.429</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">0.425</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">0.271</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">0.271</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center">(0.062)</td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.084)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.114)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.106)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.061)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.061)</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(age - 14):child_of_alcoholic</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">-0.049</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.014</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center">(0.125)</td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.125)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left">I(age - 14):peer_alcohol_use</td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">-0.150</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">-0.151</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">-0.151</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">-0.151</td>
</tr>
<tr>
<td headers="Fixed Effects   " class="gt_row gt_left"></td>
<td headers="Fixed Effects  Model A" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model B" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model C" class="gt_row gt_center"></td>
<td headers="Fixed Effects  Model D" class="gt_row gt_center">(0.086)</td>
<td headers="Fixed Effects  Model E" class="gt_row gt_center">(0.085)</td>
<td headers="Fixed Effects  Model F" class="gt_row gt_center">(0.085)</td>
<td headers="Fixed Effects  Model G" class="gt_row gt_center">(0.085)</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="8" class="gt_group_heading" scope="colgroup" id="Variance Components">Variance Components</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Variance Components   " class="gt_row gt_left">var__Observation</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.562</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.337</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.337</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.337</td>
<td headers="Variance Components  Model E" class="gt_row gt_center">0.337</td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.337</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.337</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__(Intercept)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center">0.564</td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.624</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.488</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.241</td>
<td headers="Variance Components  Model E" class="gt_row gt_center">0.241</td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.241</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.241</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left">var__I(age - 14)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center">0.151</td>
<td headers="Variance Components  Model C" class="gt_row gt_center">0.151</td>
<td headers="Variance Components  Model D" class="gt_row gt_center">0.139</td>
<td headers="Variance Components  Model E" class="gt_row gt_center">0.139</td>
<td headers="Variance Components  Model F" class="gt_row gt_center">0.139</td>
<td headers="Variance Components  Model G" class="gt_row gt_center">0.139</td>
</tr>
<tr>
<td headers="Variance Components   " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">cov__(Intercept).I(age - 14)</td>
<td headers="Variance Components  Model A" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Variance Components  Model B" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-0.068</td>
<td headers="Variance Components  Model C" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-0.059</td>
<td headers="Variance Components  Model D" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-0.006</td>
<td headers="Variance Components  Model E" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-0.006</td>
<td headers="Variance Components  Model F" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-0.006</td>
<td headers="Variance Components  Model G" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">-0.006</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="8" class="gt_group_heading" scope="colgroup" id="Goodness-of-Fit">Goodness-of-Fit</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Goodness-of-Fit   " class="gt_row gt_left">r2_yy</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center"></td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">0.043</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">0.150</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">0.291</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">0.291</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">0.291</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">0.291</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">r2_e</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center"></td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">0.400</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">0.400</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">0.400</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">0.400</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">0.400</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">0.400</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">r2_z1</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center"></td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center"></td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">0.219</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">0.614</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">0.614</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">0.614</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">0.614</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">r2_z2</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center"></td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center"></td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">0.004</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">0.080</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">0.080</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">0.080</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">0.080</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">Deviance</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">670.16</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">636.61</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">621.20</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">588.69</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">588.70</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">588.70</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">588.70</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">AIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">676.16</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">648.61</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">637.20</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">608.69</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">606.70</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">606.70</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">606.70</td>
</tr>
<tr>
<td headers="Goodness-of-Fit   " class="gt_row gt_left">BIC</td>
<td headers="Goodness-of-Fit  Model A" class="gt_row gt_center">686.67</td>
<td headers="Goodness-of-Fit  Model B" class="gt_row gt_center">669.64</td>
<td headers="Goodness-of-Fit  Model C" class="gt_row gt_center">665.25</td>
<td headers="Goodness-of-Fit  Model D" class="gt_row gt_center">643.74</td>
<td headers="Goodness-of-Fit  Model E" class="gt_row gt_center">638.25</td>
<td headers="Goodness-of-Fit  Model F" class="gt_row gt_center">638.25</td>
<td headers="Goodness-of-Fit  Model G" class="gt_row gt_center">638.25</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="displaying-prototypical-change-trajectories">Displaying prototypical change trajectories<a class="anchor" aria-label="anchor" href="#displaying-prototypical-change-trajectories"></a>
</h3>
<p>In addition to numerical summaries, Singer and Willett (2003) suggest
plotting fitted trajectories for <strong>prototypical
individuals</strong> to describe the results of model fitting, with
prototypical values of predictors selected using one or more of the
following strategies:</p>
<ul>
<li>Choosing substantively interesting values, for categorical or
continuous predictors with well-known values.</li>
<li>Using a range of percentiles, for continuous predictors without
well-known values.</li>
<li>Using standard deviations from the sample mean, for continuous
predictors without well-known values.</li>
<li>Using the sample mean, for categorical or continuous predictors you
want to control for.</li>
</ul>
<p>After selecting prototypical values of the predictors,
<strong>prototypical change trajectories</strong> can be derived from
combinations of these values using the usual model predictions.</p>
<p>For convenience, we can use the <code><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction()</a></code>
function from the <strong>modelbased</strong> package to make these
predictions, and the <code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2()</a></code> function from the
<strong>purrr</strong> package to iterate over the desired model and
prototypical value combinations. Here we will look at prototypical
change trajectories for Models B, C, and E.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prototypical_alcohol_use</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep_at.html" class="external-link">keep_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Model "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"E"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">14</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">14</span><span class="op">:</span><span class="fl">16</span>, child_of_alcoholic <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>        age <span class="op">=</span> <span class="fl">14</span><span class="op">:</span><span class="fl">16</span>, child_of_alcoholic <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, peer_alcohol_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.655</span>, <span class="fl">1.381</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    \<span class="op">(</span><span class="va">.fit</span>, <span class="va">.data</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.fit</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>alcohol_use <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    child_of_alcoholic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">child_of_alcoholic</span><span class="op">)</span>,</span>
<span>    peer_alcohol_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">peer_alcohol_use</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">prototypical_alcohol_use</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 8</span></span></span>
<span><span class="co">#&gt;    model     age alcohol_use    SE  CI_low CI_high child_of_alcoholic</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Model B    14       0.651 0.590 -<span style="color: #BB0000;">0.511</span>     1.81 <span style="color: #BB0000;">NA</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Model B    15       0.922 0.589 -<span style="color: #BB0000;">0.238</span>     2.08 <span style="color: #BB0000;">NA</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Model B    16       1.19  0.594  0.023<span style="text-decoration: underline;">3</span>    2.36 <span style="color: #BB0000;">NA</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Model C    14       0.316 0.595 -<span style="color: #BB0000;">0.857</span>     1.49 0                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Model C    14       1.06  0.598 -<span style="color: #BB0000;">0.120</span>     2.24 1                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Model C    15       0.609 0.593 -<span style="color: #BB0000;">0.559</span>     1.78 0                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Model C    15       1.30  0.595  0.130     2.48 1                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Model C    16       0.902 0.602 -<span style="color: #BB0000;">0.284</span>     2.09 0                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Model C    16       1.55  0.607  0.351     2.74 1                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Model E    14       0.142 0.591 -<span style="color: #BB0000;">1.02</span>      1.31 0                 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: peer_alcohol_use &lt;fct&gt;</span></span></span></code></pre></div>
<p>To systematically compare the prototypical change trajectories, it
can be helpful to plot them side-by-side. However, because certain
predictors are present in some models but not others, we need to supply
an <code>na.value</code> to each of the <code>scale_()</code> functions
to ensure a trajectory appears in panels where those predictors are not
present.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 4.3, page 99:</span></span>
<span><span class="va">prototypical_alcohol_use</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">child_of_alcoholic</span>, colour <span class="op">=</span> <span class="va">peer_alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span></span>
<span>      option <span class="op">=</span> <span class="st">"G"</span>, begin <span class="op">=</span> <span class="fl">.4</span>, end <span class="op">=</span> <span class="fl">.7</span>, na.value <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">17</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Note that depending on the number of predictors across different
models, it may be preferable to instead create separate plots (which
could be later added together using the <strong>patchwork</strong>
package).</p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-models-using-deviance-statistics">4.6 Comparing models using deviance statistics<a class="anchor" aria-label="anchor" href="#comparing-models-using-deviance-statistics"></a>
</h2>
<p>In Section 4.6 Singer and Willett (2003) introduce the
<strong>deviance</strong> statistic, which quantifies how much worse the
current model fit is in comparison to a saturated model that fits the
observed data perfectly by comparing log-likelihood statistics for the
two models:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Deviance</mtext><mo>=</mo><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><msub><mi>L</mi><mtext mathvariant="normal">current model</mtext></msub><mo>−</mo><mi>L</mi><msub><mi>L</mi><mtext mathvariant="normal">saturated model</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Deviance} = -2 (LL_\text{current model} - LL_\text{saturated model}).
</annotation></semantics></math></p>
<p>Note that for the multilevel model for change this equation reduces
to:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Deviance</mtext><mo>=</mo><mo>−</mo><mn>2</mn><mi>L</mi><msub><mi>L</mi><mtext mathvariant="normal">current model</mtext></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
\text{Deviance} = -2LL_\text{current model},
</annotation></semantics></math></p>
<p>because the the log-likelihood statistic for the saturated model is
always zero.</p>
<p>Deviance statistics from <strong>nested models</strong> estimated
using identical data can be compared using the <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code>
function, which computes analysis of deviance tables for one or more
fitted models. Unfortunately <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> doesn’t accept a list
as input, so we have to do some meta-programming to use our list of
models if we don’t want to type out each model by hand.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>  <span class="va">alcohol_use_1_fits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">anova</span>, <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">alcohol_use_1_fits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Data: alcohol_use_1</span></span>
<span><span class="co">#&gt; Models:</span></span>
<span><span class="co">#&gt; Model A: alcohol_use ~ 1 + (1 | id)</span></span>
<span><span class="co">#&gt; Model B: alcohol_use ~ I(age - 14) + (I(age - 14) | id)</span></span>
<span><span class="co">#&gt; Model C: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic + I(age - 14):child_of_alcoholic</span></span>
<span><span class="co">#&gt; Model E: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic + peer_alcohol_use + I(age - 14):peer_alcohol_use</span></span>
<span><span class="co">#&gt; Model D: alcohol_use ~ I(age - 14) + (I(age - 14) | id) + child_of_alcoholic + peer_alcohol_use + I(age - 14):child_of_alcoholic + I(age - 14):peer_alcohol_use</span></span>
<span><span class="co">#&gt;         npar    AIC    BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; Model A    3 676.16 686.67 -335.08   670.16                          </span></span>
<span><span class="co">#&gt; Model B    6 648.61 669.64 -318.31   636.61 33.5449  3  2.472e-07 ***</span></span>
<span><span class="co">#&gt; Model C    8 637.20 665.25 -310.60   621.20 15.4085  2  0.0004509 ***</span></span>
<span><span class="co">#&gt; Model E    9 606.70 638.25 -294.35   588.70 32.4993  1  1.192e-08 ***</span></span>
<span><span class="co">#&gt; Model D   10 608.69 643.74 -294.35   588.69  0.0126  1  0.9104569    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Note that by default the <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> function will refit
objects of class <code>merMod</code> with FML before comparing models if
they have been estimated with REML to prevent the common mistake of
inappropriately comparing REML-fitted models with different fixed
effects, whose likelihoods are not directly comparable. For REML-fitted
models with identical fixed effects and different random effects, the
<code>refit</code> argument can be set to <code>FALSE</code> to directly
compare the REML-fitted models.</p>
</div>
<div class="section level2">
<h2 id="using-wald-statistics-to-test-composite-hypotheses-about-fixed-effects">4.7 Using Wald statistics to test composite hypotheses about fixed
effects<a class="anchor" aria-label="anchor" href="#using-wald-statistics-to-test-composite-hypotheses-about-fixed-effects"></a>
</h2>
<p>This section is intentionally left blank.</p>
</div>
<div class="section level2">
<h2 id="evaluating-the-tenability-of-a-models-assumptions">4.8 Evaluating the tenability of a model’s assumptions<a class="anchor" aria-label="anchor" href="#evaluating-the-tenability-of-a-models-assumptions"></a>
</h2>
<p>In Section 4.8 Singer and Willett (2003) offer strategies for
checking the following assumptions of the multilevel model for
change:</p>
<ol style="list-style-type: decimal">
<li>The linear (or nonlinear) <strong>functional form</strong> of the
hypothesized individual change trajectory seems reasonable for the
observed data—there do not appear to be systematic deviations from
linearity (or nonlinearity) across participants.</li>
<li>The level-1 and level-2 residuals are all <strong>normally
distributed</strong>.</li>
<li>The level-1 and level-2 residuals have <strong>equal
variances</strong> at each level of every predictor.</li>
</ol>
<div class="section level3">
<h3 id="checking-functional-form">Checking functional Form<a class="anchor" aria-label="anchor" href="#checking-functional-form"></a>
</h3>
<p>The functional form assumption of the multilevel model for change can
be assessed by inspecting “outcome versus predictors” plots at each
level.</p>
<p>At level-1, empirical growth plots with superimposed individual
change trajectories should support the suitability of specified
functional form. Empirical growth plots should be examined for
<em>each</em> individual (or several subsamples of individuals), looking
for systematic deviations that disconfirm the suitability of the
hypothesized individual change trajectory.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span>
<span><span class="va">alcohol_use_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>At level-2, OLS-estimated individual growth parameters should be
plotted against each substantive predictor to confirm the suitability of
the specified level-2 relationships. For linear models, only continuous
predictors need to be assessed because categorical predictors are always
linear.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_fit_np</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmList.html" class="external-link">lmList</a></span><span class="op">(</span></span>
<span>  <span class="va">alcohol_use</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">14</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span>,</span>
<span>  pool <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data <span class="op">=</span> <span class="va">alcohol_use_1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_est_np</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fit_np</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">tidy</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span><span class="op">:</span><span class="va">estimate</span>, alcohol_use <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">alcohol_use_1_pl</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>child_of_alcoholic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">child_of_alcoholic</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_ovp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"child_of_alcoholic"</span>, <span class="st">"peer_alcohol_use"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">alcohol_use_1_est_np</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 4.4:</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">alcohol_use_1_ovp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="checking-normality">Checking normality<a class="anchor" aria-label="anchor" href="#checking-normality"></a>
</h3>
<p>The normality assumption of the multilevel model for change can be
assessed by inspecting Q-Q plots of the level-1 and level-2 residuals,
and also (optionally) with statistical tests of normality. The
<code><a href="https://easystats.github.io/performance/reference/check_normality.html" class="external-link">check_normality()</a></code> function from the
<strong>performance</strong> package can perform both of these
tasks.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_F_normality</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"random"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html" class="external-link">check_normality</a></span><span class="op">(</span><span class="va">model_F</span>, effects <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_F_normality</span></span>
<span><span class="co">#&gt; $fixed</span></span>
<span><span class="co">#&gt; Warning: Non-normality of residuals detected (p = 0.011).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $random</span></span>
<span><span class="co">#&gt; OK: Random effects 'id: (Intercept)' appear as normally distributed (p = 0.270).</span></span>
<span><span class="co">#&gt; Warning: Non-normality for random effects 'id: I(age - 14)' detected (p &lt; .001).</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for <code><a href="https://easystats.github.io/performance/reference/check_normality.html" class="external-link">check_normality()</a></code> can
be used to return Q-Q plots of the level-1 and level-2 residuals.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 4.5 (left panels), page 131:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_F_normality</span><span class="op">$</span><span class="va">fixed</span>, detrend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_F_normality</span><span class="op">$</span><span class="va">random</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<!-- TODO: Decide whether to do right panels

``` r
# Fixed effects
model_F |>
  augment(re.form = NA) |>
  ggplot(aes(x = id, y = scale(.resid))) +
  geom_point() +
  coord_cartesian(ylim = c(-3, 3))
```

<img src="chapter-4_files/figure-html/unnamed-chunk-32-1.png" width="700" />
-->
</div>
<div class="section level3">
<h3 id="checking-homoscedasticity">Checking homoscedasticity<a class="anchor" aria-label="anchor" href="#checking-homoscedasticity"></a>
</h3>
<p>The homoscedasticity assumption of the multilevel model for change
can be assessed by inspecting “residual versus predictors” plots at each
level to see if residual variability is approximately equal at
<em>every</em> predictor value.</p>
<p>The level-1 residuals should be plotted against the level-1
predictor.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 4.6 (top panel), page 133:</span></span>
<span><span class="va">model_F</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span>re.form <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">`I(age - 14)`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>The level-2 residuals should be plotted against the level-2
predictor(s).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_ranef</span> <span class="op">&lt;-</span> <span class="va">model_F</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html" class="external-link">ranef</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>term <span class="op">=</span> <span class="va">variable</span>, id <span class="op">=</span> <span class="va">level</span>, .resid <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">alcohol_use_1_pl</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>child_of_alcoholic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">child_of_alcoholic</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_rvp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"child_of_alcoholic"</span>, <span class="st">"peer_alcohol_use"</span><span class="op">)</span>,</span>
<span>  \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">alcohol_use_1_ranef</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Figure 4.6 (bottom panels), page 133:</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">alcohol_use_1_rvp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-based-estimates-of-the-individual-growth-parameters">4.9 Model-based estimates of the individual growth parameters<a class="anchor" aria-label="anchor" href="#model-based-estimates-of-the-individual-growth-parameters"></a>
</h2>
<p>In Section 4.9 Singer and Willett (2003) discuss how to use
<strong>model-based estimates</strong> to display individual growth
trajectories, which are simply the partial pooling trajectories we
previously discussed in Chapter 3.</p>
<p>We begin by predicting three types of growth trajectories for each
individual: (1) A no pooling trajectory estimated from separate linear
models; (2) a population average trajectory estimated from the
multilevel model for change, which <em>does not</em> condition on the
random effects; and (3) a model-based trajectory estimated from the
multilevel model for change, which <em>does</em> condition on the random
effects.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alcohol_use_1_np_pred</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_fit_np</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">augment</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>trajectory <span class="op">=</span> <span class="st">"no_pooling"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_pp_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>population_average <span class="op">=</span> <span class="cn">NA</span>, model_based <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">model_F</span>, re.form <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"trajectory"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For display purposes we will tidy up the prediction data frames and only use</span></span>
<span><span class="co"># a subset of participants.</span></span>
<span><span class="va">alcohol_use_1_preds</span> <span class="op">&lt;-</span> <span class="va">alcohol_use_1_np_pred</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">alcohol_use_1_pp_pred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">14</span>, <span class="fl">23</span>, <span class="fl">32</span>, <span class="fl">41</span>, <span class="fl">56</span>, <span class="fl">65</span>, <span class="fl">82</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">`I(age - 14)`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    trajectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">trajectory</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"population_average"</span>, <span class="st">"no_pooling"</span>, <span class="st">"model_based"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">trajectory</span>, <span class="va">id</span>, <span class="va">age</span>, <span class="va">alcohol_use</span>, <span class="va">.fitted</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alcohol_use_1_preds</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 72 × 5</span></span></span>
<span><span class="co">#&gt;    trajectory id      age alcohol_use .fitted</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> no_pooling 4        14        0      0.378</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> no_pooling 4        15        2      1.24 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> no_pooling 4        16        1.73   2.11 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> no_pooling 14       14        2.83   3.09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> no_pooling 14       15        3.61   3.09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> no_pooling 14       16        2.83   3.09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> no_pooling 23       14        1      0.878</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> no_pooling 23       15        1      1.24 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> no_pooling 23       16        1.73   1.61 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> no_pooling 32       14        1.73   1.75 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 62 more rows</span></span></span></code></pre></div>
<p>Now we can plot the three trajectories.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure 4.7:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">alcohol_use_1_preds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">alcohol_use</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.fitted</span>, colour <span class="op">=</span> <span class="va">trajectory</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">17</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="chapter-4_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<p>Similar to our partial pooling example in in Chapter 3, notice
that:</p>
<ul>
<li>The population average trajectories are the most stable, varying the
least across individuals.</li>
<li>The no pooling trajectories are the least stable, varying the most
across individuals.</li>
<li>The model-based trajectories fall somewhere between the population
average and no pooling trajectories, due to the effects of partial
pooling.</li>
</ul>
<p>Although we will typically prefer model-based trajectories from the
multilevel model for change, Singer and Willett (2003) conclude by
cautioning that the model-based trajectories of a flawed model will be
flawed as well—as their quality depends heavily on the quality of the
model fit and the soundness of the model’s assumptions (given the
data).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael McCarthy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
